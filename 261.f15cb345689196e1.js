var Qv=Object.defineProperty,Xv=Object.defineProperties,Gv=Object.getOwnPropertyDescriptors,ns=Object.getOwnPropertySymbols,Hu=Object.prototype.hasOwnProperty,Ju=Object.prototype.propertyIsEnumerable,Uu=(At,St,pt)=>St in At?Qv(At,St,{enumerable:!0,configurable:!0,writable:!0,value:pt}):At[St]=pt,Z=(At,St)=>{for(var pt in St||(St={}))Hu.call(St,pt)&&Uu(At,pt,St[pt]);if(ns)for(var pt of ns(St))Ju.call(St,pt)&&Uu(At,pt,St[pt]);return At},Xt=(At,St)=>Xv(At,Gv(St)),ju=(At,St)=>{var pt={};for(var jt in At)Hu.call(At,jt)&&St.indexOf(jt)<0&&(pt[jt]=At[jt]);if(null!=At&&ns)for(var jt of ns(At))St.indexOf(jt)<0&&Ju.call(At,jt)&&(pt[jt]=At[jt]);return pt};(self.webpackChunkautoplusv2=self.webpackChunkautoplusv2||[]).push([[261],{8261:(At,St,pt)=>{"use strict";pt.r(St),pt.d(St,{PostingModule:()=>Hv});var jt=pt(5236),le=pt(5425),a=pt(1223),Vi=pt(7579),rs=pt(1135),Hi=pt(520);let Ve=(()=>{class e{constructor(n){this.http=n,this.emitPostingSource=new Vi.x,this.emitDetailsSource=new Vi.x,this.stepEmitted=this.emitPostingSource.asObservable(),this.formEmitted=this.emitPostingSource.asObservable(),this.detailsFormsEmitted=this.emitDetailsSource.asObservable(),this.formSubject=new rs.X(JSON.parse(localStorage.getItem("form")||"{}")),this.form=this.formSubject.asObservable()}get formValue(){return this.formSubject.value}emitSteps(n){this.emitPostingSource.next(n)}emitDetails(n){this.emitDetailsSource.next(n)}emitForm(n){this.emitPostingSource.next(n)}saveForm(n){let r=Object.assign(this.formValue,n);localStorage.setItem("form",JSON.stringify(r))}}return e.\u0275fac=function(n){return new(n||e)(a.LFG(Hi.eN))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var Gt=pt(9808);function is(e,t){1&e&&a._UZ(0,"i",14)}function Kr(e,t){1&e&&a._UZ(0,"i",14)}function ss(e,t){1&e&&a._UZ(0,"i",14)}function mr(e,t){1&e&&a._UZ(0,"i",14)}const $t=function(e){return{"--current":e}};let Qr=(()=>{class e{constructor(n,r){this.router=n,this.postingService=r,this.showView=!1,this.step=0,this.formStep=0,this.step_percent=[0,0,0,0],this.maxInput=20,this.backStep=!1,this.postingService.form.subscribe(i=>this.form=i),this.setFormStep(),this.router.events.subscribe(i=>{i instanceof le.m2&&"/posting"==i.url&&this.router.navigate(["/posting/car"])}),this.postingService.formEmitted.subscribe(i=>{i.form&&this.postingService.saveForm(i)}),this.postingService.stepEmitted.subscribe(i=>{if("++"==i)this.step=0,this.step_percent[this.formStep]=100,this.step_percent[this.formStep+1]=5,this.formStep=this.formStep+1;else if("--"==i)this.backStep=!0,"/posting/equipements"==this.router.url?this.router.navigate(["/posting/car"]):"/posting/details"==this.router.url?this.router.navigate(["/posting/equipements"]):"/posting/contact"==this.router.url&&this.router.navigate(["/posting/details"]);else{"+"==i?this.step=this.step+1:this.step>1&&(this.step=this.step-1);let o=0;switch(this.formStep){case 0:o=8;break;case 1:case 2:o=3;break;case 3:o=4}this.step_percent[this.formStep]=100*this.step/o}})}ngOnInit(){}setFormStep(){return this.form?this.backStep?this.router.navigate(["/posting/equipements"]):Object.values(this.form).indexOf("car")>-1?(this.formStep=1,this.step=0,this.step_percent[0]=100,this.step_percent[1]=5,this.router.navigate(["/posting/equipements"])):Object.values(this.form).indexOf("equipements")>-1?(this.formStep=2,this.step=0,this.step_percent[0]=100,this.step_percent[1]=100,this.step_percent[2]=5,this.router.navigate(["/posting/details"])):Object.values(this.form).indexOf("details")>-1?(this.formStep=3,this.step=0,this.step_percent[0]=100,this.step_percent[1]=100,this.step_percent[2]=100,this.step_percent[3]=5,this.router.navigate(["/posting/contact"])):this.router.navigate(["/posting/car"]):this.router.navigate(["/posting/car"])}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(le.F0),a.Y36(Ve))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-posting"]],decls:44,vars:24,consts:[[1,"posting"],[1,"_content","--main"],[1,"header"],[1,"form"],[1,"steps"],[1,"_displayFlex","steps-main"],[1,"icon"],["src","./assets/images/steps/step1.png"],["class","fa-solid fa-circle-check",4,"ngIf"],["src","./assets/images/steps/step2.png"],["src","./assets/images/steps/step3.png"],["src","./assets/images/steps/step4.png"],[1,"_displayFlex","step-progress"],[1,"progress-line",3,"ngClass"],[1,"fa-solid","fa-circle-check"]],template:function(n,r){1&n&&(a.TgZ(0,"section",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"h1"),a._uU(4," Votre publicit\xe9 en seulement 4 clicks "),a.TgZ(5,"span"),a._uU(6,"Temps estim\xe9 pour d\xe9poser votre annonce 45sec - 1min"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(7,"div",3),a.TgZ(8,"div",4),a.TgZ(9,"ul",5),a.TgZ(10,"li"),a.TgZ(11,"div",6),a._UZ(12,"img",7),a.qZA(),a.TgZ(13,"b"),a._uU(14,"1. Donn\xe9es de v\xe9hicule "),a.YNc(15,is,1,0,"i",8),a.qZA(),a.qZA(),a.TgZ(16,"li"),a.TgZ(17,"div",6),a._UZ(18,"img",9),a.qZA(),a.TgZ(19,"b"),a._uU(20,"2. Equipements "),a.YNc(21,Kr,1,0,"i",8),a.qZA(),a.qZA(),a.TgZ(22,"li"),a.TgZ(23,"div",6),a._UZ(24,"img",10),a.qZA(),a.TgZ(25,"b"),a._uU(26,"3. D\xe9tails "),a.YNc(27,ss,1,0,"i",8),a.qZA(),a.qZA(),a.TgZ(28,"li"),a.TgZ(29,"div",6),a._UZ(30,"img",11),a.qZA(),a.TgZ(31,"b"),a._uU(32,"4. Contact "),a.YNc(33,mr,1,0,"i",8),a.qZA(),a.qZA(),a.qZA(),a.TgZ(34,"ul",12),a.TgZ(35,"li"),a._UZ(36,"div",13),a.qZA(),a.TgZ(37,"li"),a._UZ(38,"div",13),a.qZA(),a.TgZ(39,"li"),a._UZ(40,"div",13),a.qZA(),a.TgZ(41,"li"),a._UZ(42,"div",13),a.qZA(),a.qZA(),a.qZA(),a._UZ(43,"router-outlet"),a.qZA(),a.qZA(),a.qZA()),2&n&&(a.xp6(15),a.Q6J("ngIf",r.formStep>=1),a.xp6(6),a.Q6J("ngIf",r.formStep>=2),a.xp6(6),a.Q6J("ngIf",r.formStep>=3),a.xp6(6),a.Q6J("ngIf",r.formStep>=4),a.xp6(3),a.Udp("width",r.step_percent[0],"%"),a.Q6J("ngClass",a.VKq(16,$t,0===r.formStep)),a.xp6(2),a.Udp("width",r.step_percent[1],"%"),a.Q6J("ngClass",a.VKq(18,$t,1===r.formStep)),a.xp6(2),a.Udp("width",r.step_percent[2],"%"),a.Q6J("ngClass",a.VKq(20,$t,2===r.formStep)),a.xp6(2),a.Udp("width",r.step_percent[3],"%"),a.Q6J("ngClass",a.VKq(22,$t,3===r.formStep)))},directives:[Gt.O5,Gt.mk,le.lC],styles:["@media screen and (max-width: 910px){section.posting ._content{width:100%!important}section.posting .form .steps-container .global-container{display:block!important}section.posting .form .steps-container .global-container .form-container.previewList{width:95%;padding-left:0;margin:0 auto}section.posting .form .steps-container .global-container .form-container.previewList .preview-list ul{display:block!important;position:relative}section.posting .form .steps-container .global-container .form-container.previewList .preview-list ul li:first-child{margin-bottom:50px}section.posting .form .steps-container .global-container .form-container.previewList .preview-list ul li:not(:first-child){display:inline-block;width:50%}section.posting .form .steps-container .global-container .form-container.previewList .preview-list ul li.text{position:absolute!important;top:120px!important;left:5%}section.posting .form .steps-container .global-container .form-container.previewList .preview-list .uploadFile{margin-left:0!important;margin-bottom:30px}section.posting .form .steps-container .global-container .form-container.description{width:90%;padding-left:0;margin:0 auto}section.posting .form .steps-container .global-container .form-container.description .description-main{display:block!important}section.posting .form .steps-container .global-container .form-container.description .description-main .desc-left{width:100%!important}section.posting .form .steps-container .global-container .form-container.description .description-main .desc-right{width:100%!important;margin-top:25px}section.posting .form .steps-container .global-container .form-container.description .description-main .desc-right ul li{padding:7px;border:1px solid #d1d1d3}section.posting .form .steps-container .global-container .form-container.description .description-main .desc-right ul li label.checkbox-label{display:inline-block!important}section.posting .form .steps-container .global-container .form-container.contact{width:90%;padding-left:0;margin:0 auto}section.posting .form .steps-container .global-container .form-container.contact .contact-main{display:block!important}section.posting .form .steps-container .global-container .form-container.contact .contact-main .form-group{width:100%!important}section.posting .form .steps-container .global-container .form-container .form-group{display:block!important}section.posting .form .steps-container .global-container .form-container ul.form-checkbox{margin-top:30px}section.posting .form .steps-container .global-container .form-container ul.form-checkbox li{display:block!important}section.posting .form .steps-container .global-container .sub-step{width:100%!important}section.posting .form .steps-container .global-container.equipements .form-container{padding-left:0!important}section.posting .form .steps-container .global-container .tips{width:90%!important;margin-left:auto!important;margin-right:auto!important;margin-bottom:50px;padding:20px!important}section.posting .form .steps-container .bottom{position:fixed;bottom:0;left:0;z-index:10;width:100%;background:#fff}}html{scroll-snap-points-y:none;scroll-snap-type:none}.modal-back{position:fixed;top:0;left:0;z-index:98;width:100%;height:100%;background:rgba(0,0,0,.7);backdrop-filter:blur(5px)}.crop-modal{position:fixed;top:50%;left:50%;z-index:99;width:700px;margin-top:-300px;margin-left:-350px;box-shadow:0 0 0 1px #0000001a,0 4px 40px #0000004d}.crop-modal img{width:100%}.crop-modal .cropper-bg{background-image:none}.crop-modal .editing{padding:30px;text-align:center;background:#fff}.crop-modal .editing button{display:inline-block;width:auto}.crop-modal .editing button:not(:last-child){margin-right:15px}section.posting{background:#fff;padding-bottom:82px}section.posting .header{padding:90px 0 40px}section.posting .header h1{font-size:30px;font-weight:700}section.posting .header h1 span{display:block;margin-top:10px;font-weight:500;font-size:14px}section.posting .form{border:1px solid #d1d1d3}section.posting .form .steps{position:sticky;top:0;z-index:3;background:#f6f6f6;border-bottom:1px solid #d1d1d3}section.posting .form .steps ul{padding-left:0;margin-bottom:0}section.posting .form .steps ul.steps-main{padding:15px 30px 10px}section.posting .form .steps ul.steps-main li{text-align:center;width:100%}section.posting .form .steps ul.steps-main li:not(:last-child){margin-right:66px}section.posting .form .steps ul.steps-main li b{position:relative;display:inline;font-weight:500;font-size:15px;color:#b5b5b5}section.posting .form .steps ul.steps-main li b i{position:absolute;top:0;right:-29px;color:#4caf50;font-size:20px}section.posting .form .steps ul.steps-main li .icon{text-align:center}section.posting .form .steps ul.steps-main li .icon img{height:34px}section.posting .form .steps ul.step-progress li{width:100%;height:5px}section.posting .form .steps ul.step-progress li .progress-line{height:100%;background:#4caf50;transition:width .4s ease-in-out}section.posting .form .steps ul.step-progress li .progress-line.--current{border-radius:0 3px 3px 0}section.posting .form .steps-container .global-container{align-items:flex-start}section.posting .form .steps-container .global-container .form-container{padding-left:30px;margin-right:15px;width:88.5%}section.posting .form .steps-container .global-container .form-container .form-group{align-items:flex-end;margin-bottom:0}section.posting .form .steps-container .global-container .form-container .form-group .multiple-item{position:relative;width:100%}section.posting .form .steps-container .global-container .form-container .form-group .multiple-item:not(:last-child){margin-right:30px}section.posting .form .steps-container .global-container .form-container .form-group .multiple-item select{width:100%;height:35px;font-weight:500;font-size:15px;color:#495057cc}section.posting .form .steps-container .global-container .form-container .form-group .multiple-item input[type=text]{margin-bottom:17px;padding:5px 45px 5px 10px}section.posting .form .steps-container .global-container .form-container .form-group .multiple-item input[type=text]::placeholder{font-weight:400;font-size:15px;color:#495057b3}section.posting .form .steps-container .global-container .form-container .form-group .multiple-item .km{position:absolute;top:28px;right:11px;font-weight:600;color:#6e778a}section.posting .form .steps-container .global-container .form-container .preview-list ul{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));grid-column-gap:10px;column-gap:10px;grid-row-gap:10px;row-gap:10px;padding-left:0;margin-bottom:0}section.posting .form .steps-container .global-container .form-container .preview-list ul li{height:auto;text-align:center;border-top:1px solid rgba(0,0,0,.125);border-bottom:1px solid rgba(0,0,0,.125);border-left:1px solid rgba(0,0,0,.125);border-right:1px solid rgba(0,0,0,.125);border-radius:4px}section.posting .form .steps-container .global-container .form-container .preview-list ul li .bottom-action{padding:4px;color:#b5b5c6;border-top:1px solid rgba(0,0,0,.125)}section.posting .form .steps-container .global-container .form-container .preview-list ul li .bottom-action .action i{cursor:pointer;font-size:14px;margin-left:7px}section.posting .form .steps-container .global-container .form-container .preview-list ul li.text{position:relative;top:-3px;width:90%;border:none;color:#b5b5b5;font-size:12px;padding:0}section.posting .form .steps-container .global-container .form-container .preview-list ul li img{cursor:pointer;padding:7px;width:90%;height:100px;object-fit:contain}section.posting .form .steps-container .global-container .form-container .preview-list .uploadFile{display:inline-block;width:25%;background:#162033;font-weight:400;font-size:14px;padding:10px 2%;margin-left:25.5%;margin-top:15px;text-align:center;cursor:pointer}section.posting .form .steps-container .global-container .form-container .preview-list .uploadFile input[type=file]{display:none}section.posting .form .steps-container .global-container .form-container .description{padding:30px 0}section.posting .form .steps-container .global-container .form-container .description .description-main{margin-top:30px;align-items:flex-start}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-left{width:77%;margin-right:30px;padding:10px;border:1px solid #d3d3d5;font-size:13px}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-left select{height:18px;color:#162033;border:1px solid #162033;border-radius:0}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-left ul li{list-style:inside;margin-bottom:10px}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-right{width:25%}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-right ul li{margin-bottom:15px}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-right ul li label.checkbox-label{display:flex;align-items:flex-end}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-right ul li label.checkbox-label .checkbox-custom{margin-right:15px;width:21px;height:21px}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-right ul li label.checkbox-label .checkbox-custom:after{top:1px;left:6px}section.posting .form .steps-container .global-container .form-container .description .description-main .desc-right ul li label.checkbox-label .text-custom{font-size:12.7px;font-weight:500;letter-spacing:-.35px}section.posting .form .steps-container .global-container .form-container .description .editor .ProseMirror{width:100%;height:200px;padding:10px;border:1px solid #d3d3d5}section.posting .form .steps-container .global-container .form-container .description .editor .toolbar{margin-bottom:10px}section.posting .form .steps-container .global-container .form-container .description .editor .toolbar ul{justify-content:flex-start}section.posting .form .steps-container .global-container .form-container .description .editor .toolbar ul li{padding:5px 10px;cursor:pointer;margin-right:25px}section.posting .form .steps-container .global-container .form-container .description .editor .toolbar ul li i{font-size:25px}section.posting .form .steps-container .global-container .form-container .description .editor .toolbar ul li.is-active{background:#eaeaea;border-radius:4px}section.posting .form .steps-container .global-container .form-container .description .choose-assisted{font-weight:600;font-size:13px}section.posting .form .steps-container .global-container .form-container .description .choose-assisted .buttons{display:inline-block;margin-left:15px}section.posting .form .steps-container .global-container .form-container .description .choose-assisted .buttons button{font-weight:400;font-size:14.5px;padding:10px 20px;border:1px solid #162033;background:#fff}section.posting .form .steps-container .global-container .form-container .description .choose-assisted .buttons button.active{background:#162033;color:#fff}section.posting .form .steps-container .global-container .form-container .description .choose-assisted .buttons button:first-child{border-radius:2px 0 0 2px}section.posting .form .steps-container .global-container .form-container .description .choose-assisted .buttons button:last-child{border-radius:0 2px 2px 0}section.posting .form .steps-container .global-container .form-container .price .form-group{position:relative;width:30%}section.posting .form .steps-container .global-container .form-container .price .form-group input[type=text]{padding:8px 40px 8px 10px}section.posting .form .steps-container .global-container .form-container .price .form-group span.dt{position:absolute;right:15px;top:29px;font-size:17px;font-weight:500;color:#6e778a}section.posting .form .steps-container .global-container .form-container .price h5{font-size:15.5px;font-weight:500;padding-bottom:15px;margin-bottom:15px;margin-top:20px;border-bottom:1px solid rgba(0,0,0,.1)}section.posting .form .steps-container .global-container .form-container .price .price-compare p{color:#b5b5b5;font-size:12px;line-height:1.5}section.posting .form .steps-container .global-container .form-container ul.form-checkbox{padding-left:0;margin-bottom:0}section.posting .form .steps-container .global-container .form-container ul.form-checkbox li{display:inline-block;width:50%;margin-bottom:15px}section.posting .form .steps-container .global-container .form-container ul.form-checkbox li span.text-custom{width:70%;font-size:13.7px;font-weight:400;margin-left:10px}section.posting .form .steps-container .global-container .form-container ul.form-checkbox li .checkbox-label{display:flex;align-items:baseline}section.posting .form .steps-container .global-container .form-container ul.form-checkbox li .checkbox-label .checkbox-custom{width:21px;height:21px}section.posting .form .steps-container .global-container .form-container ul.form-checkbox li .checkbox-label .checkbox-custom:after{top:2px;left:7px}section.posting .form .steps-container .global-container .form-container ul.form-checkbox button.selectAll{position:relative;top:-12px;display:inline-block;width:auto;padding:7px 10px;font-weight:500;font-size:14px;background:#162033}section.posting .form .steps-container .global-container .tips{position:relative;top:20px;margin-left:10px;margin-right:30px;background:#f4f4f4;padding:30px 28px;width:55%;letter-spacing:-.3px}section.posting .form .steps-container .global-container .tips b{display:block;position:relative;margin-bottom:20px;color:#9c9c9c;font-size:12px;font-weight:500}section.posting .form .steps-container .global-container .tips p,section.posting .form .steps-container .global-container .tips .text{margin-top:5px;color:#b5b5b5;font-weight:500;font-size:10.2px;line-height:1.5}section.posting .form .steps-container .global-container .tips img{position:relative;top:13px;left:-6px;margin-right:7px;width:35px}section.posting .form .steps-container .global-container .tips.details{position:relative;top:-50px;width:30%;background:transparent;padding:0}section.posting .form .steps-container .global-container .tips.details b{font-size:13.5px;font-weight:400}section.posting .form .steps-container .global-container .tips.details img{top:15px;width:30px;margin-right:0}section.posting .form .steps-container .global-container .tips.details .text{font-size:12px}section.posting .form .steps-container .global-container .tips.details ul li{margin-bottom:10px}section.posting .form .steps-container .global-container.equipements{padding:60px 30px}section.posting .form .steps-container .global-container.equipements .form-container{padding-left:100px}section.posting .form .steps-container .global-container.equipements .sub-step{width:30%}section.posting .form .steps-container .global-container.equipements .sub-step ul{padding-left:0;margin-bottom:0}section.posting .form .steps-container .global-container.equipements .sub-step ul li{padding:27px 0;font-weight:500;font-size:15px;color:#787474;border-bottom:1px solid rgba(0,0,0,.1)}section.posting .form .steps-container .global-container.equipements .sub-step ul li i{position:relative;top:2px;color:#adadad;font-size:20px;margin-right:5px}section.posting .form .steps-container .global-container.equipements .sub-step ul li.active{color:orange}section.posting .form .steps-container .global-container.equipements .sub-step ul li.active i.checked{color:#4caf50}section.posting .form .steps-container .global-container.equipements .sub-step ul li:first-child{padding:0 0 27px}section.posting .form .steps-container .global-container.contact{margin-top:40px}section.posting .form .steps-container .global-container.contact .contact-main{flex-wrap:wrap;align-items:flex-start}section.posting .form .steps-container .global-container.contact .contact-main .form-group{width:48%}section.posting .form .steps-container .global-container.contact .contact-main .form-group select{width:100%;height:35px}section.posting .form .steps-container .global-container.contact .contact-main .form-group input[type=text]{width:100%;padding:7px 5px 7px 10px}section.posting .form .steps-container .global-container.contact .contact-main .form-group .checkbox-label{margin-right:15px}section.posting .form .steps-container .global-container.contact .contact-main .form-group .checkbox-label .checkbox-custom{margin-right:15px}section.posting .form .steps-container .global-container.contact .contact-main .form-group .checkbox-label .text-custom{font-weight:500}section.posting .form .steps-container .global-container.contact .contact-main .form-group.radio label.radio-container{display:inline-block;margin-right:15px}section.posting .form .steps-container .global-container.contact .contact-main .form-group.radio label.radio-container input[type=radio]{margin-right:15px;transform:scale(1.3)}section.posting .form .steps-container .global-container.contact .contact-main p{padding:20px 0;width:80%;font-size:10.5px;color:#9c9c9c;letter-spacing:-.3px;font-weight:500;line-height:1.5}section.posting .form .steps-container .global-container.contact .tips{padding:40px 20px 0}section.posting .form .steps-container .global-container.contact .tips b{display:flex;line-height:1.5}section.posting .form .steps-container .global-container.contact .tips b img{top:-16px}section.posting .form .steps-container .title{padding:5px 30px}section.posting .form .steps-container .bottom{border-top:1px solid #d1d1d3;padding:10px 8px}section.posting .form .steps-container .bottom a{font-weight:700;font-size:15px;letter-spacing:-.45px;color:#b5b5b5}section.posting .form .steps-container .bottom a:hover{color:#b5b5b5}section.posting .form .steps-container .bottom .group-buttons button{display:inline-block;width:auto;padding:12px 50px;font-size:13px}section.posting .form .steps-container .bottom .group-buttons button:first-child{margin-right:15px}section.posting .form .steps-container h2,section.posting .form .steps-container h3{font-weight:700;margin-bottom:25px}section.posting .form .steps-container h2{font-size:18px}section.posting .form .steps-container h3{font-size:13px}\n"],encapsulation:2}),e})();var H=pt(2382),wt=pt(7934);function Xr(e,t){if(1&e&&(a.TgZ(0,"option"),a._uU(1),a.qZA()),2&e){const n=t.$implicit;a.xp6(1),a.Oqu(n)}}function Ji(e,t){if(1&e&&(a.TgZ(0,"option"),a._uU(1),a.qZA()),2&e){const n=t.$implicit;a.xp6(1),a.Oqu(n)}}function Ui(e,t){if(1&e&&(a.TgZ(0,"option",31),a._uU(1),a.qZA()),2&e){const n=t.$implicit;a.Q6J("value",n),a.xp6(1),a.Oqu(49==n?"Plus que 48":n)}}const De=function(e,t){return{"--form":!0,"is-invalid":e,"is-valid":t}},an=function(){return{standalone:!0}};let cn=(()=>{class e{constructor(n,r,i){this.router=n,this.formBuilder=r,this.postingService=i,this.form_sent=!1,this.months=["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"],this.years=[],this.currentYear=(new Date).getFullYear(),this.mileage="",this.steps=1;for(let o=this.currentYear;o>=this.currentYear-20;o--)this.years.push(o)}ngOnInit(){this.mileage=this.postingService.formValue.mileage?this.postingService.formValue.mileage:"",this.form=this.formBuilder.group({brand:[this.postingService.formValue.brand?this.postingService.formValue.brand:"",[H.kI.required]],model:[this.postingService.formValue.model?this.postingService.formValue.model:"",[H.kI.required]],circulation_month:[this.postingService.formValue.circulation_month?this.postingService.formValue.circulation_month:"",[H.kI.required]],circulation_year:[this.postingService.formValue.circulation_year?this.postingService.formValue.circulation_year:"",[H.kI.required]],fuel:[this.postingService.formValue.fuel?this.postingService.formValue.fuel:"",[H.kI.required]],mileage:[this.postingService.formValue.mileage?this.postingService.formValue.mileage:"",[H.kI.required,H.kI.pattern("^[0-9]*$"),H.kI.minLength(4),H.kI.maxLength(6)]],fiscal:[this.postingService.formValue.fiscal?this.postingService.formValue.fiscal:"",H.kI.required],gear_box:[this.postingService.formValue.gear_box?this.postingService.formValue.gear_box:"",H.kI.required]}),this.mileageFormat({target:{value:this.postingService.formValue.mileage?this.postingService.formValue.mileage:""}})}get getForm(){return this.form.controls}moveStep(n){return this.postingService.emitSteps(this.getForm[n].errors?"-":"+")}mileageFormat(n){let r=n.target.value;return r=r.replace(" ",""),this.getForm.mileage.setValue(r),r=r.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),this.mileage=r}submit(){if(this.form_sent=!0,!this.form.invalid)return this.postingService.emitForm(Object.assign({form:"car"},this.form.value)),this.postingService.emitSteps("++"),this.router.navigate(["/posting/equipements"])}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(le.F0),a.Y36(H.qu),a.Y36(Ve))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-news-car"]],decls:91,vars:41,consts:[[1,"steps-container"],[1,"title"],[1,"global-container","_displayFlex"],[1,"form-container",3,"formGroup","submit"],[1,"form-group","_displayFlex"],[1,"multiple-item"],["formControlName","brand",3,"ngClass","change"],["value","","disabled","","selected",""],["formControlName","model",3,"ngClass","change"],["formControlName","circulation_month",3,"ngClass","change"],[4,"ngFor","ngForOf"],["formControlName","circulation_year",3,"ngClass","change"],["formControlName","fuel",3,"ngClass","change"],["value","Essence"],["value","Diesel"],["value","Gaz"],["type","hidden","formControlName","mileage"],["type","text","placeholder","Veuillez saisir le kilom\xe9trage","name","mileageString",3,"ngModel","ngModelOptions","ngClass","ngModelChange","blur","keyup"],[1,"km"],["formControlName","fiscal",3,"ngClass","change"],[3,"value",4,"ngFor","ngForOf"],["formControlName","gear_box",3,"ngClass","change"],["value","Automatique"],["value","Manuellle"],["value","Pilot\xe9e"],[1,"tips"],["src","./assets/images/lightbulb.png"],[1,"bottom","_displayFlex"],["href",""],[1,"group-buttons"],[1,"button",3,"click"],[3,"value"]],template:function(n,r){1&n&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"h2"),a._uU(3,"Vendre votre voiture ? C'est tr\xe8s simple!"),a.qZA(),a.TgZ(4,"h3"),a._uU(5,"Selectionnez votre voiture"),a.qZA(),a.qZA(),a.TgZ(6,"div",2),a.TgZ(7,"form",3),a.NdJ("submit",function(){return r.submit()}),a.TgZ(8,"div",4),a.TgZ(9,"div",5),a.TgZ(10,"label"),a._uU(11,"Marque"),a.qZA(),a.TgZ(12,"select",6),a.NdJ("change",function(){return r.moveStep("brand")}),a.TgZ(13,"option",7),a._uU(14,"Veuillez s\xe9lectionner"),a.qZA(),a.TgZ(15,"option"),a._uU(16,"fefed"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(17,"div",5),a.TgZ(18,"label"),a._uU(19,"Mod\xe8le"),a.qZA(),a.TgZ(20,"select",8),a.NdJ("change",function(){return r.moveStep("model")}),a.TgZ(21,"option",7),a._uU(22,"Veuillez s\xe9lectionner"),a.qZA(),a.TgZ(23,"option"),a._uU(24,"fefed"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(25,"div",4),a.TgZ(26,"div",5),a.TgZ(27,"label"),a._uU(28,"Mise en circulation"),a.qZA(),a.TgZ(29,"select",9),a.NdJ("change",function(){return r.moveStep("circulation_month")}),a.TgZ(30,"option",7),a._uU(31,"Mois"),a.qZA(),a.YNc(32,Xr,2,1,"option",10),a.qZA(),a.qZA(),a.TgZ(33,"div",5),a.TgZ(34,"select",11),a.NdJ("change",function(){return r.moveStep("circulation_year")}),a.TgZ(35,"option",7),a._uU(36,"Ann\xe9e"),a.qZA(),a.YNc(37,Ji,2,1,"option",10),a.qZA(),a.qZA(),a.qZA(),a.TgZ(38,"div",4),a.TgZ(39,"div",5),a.TgZ(40,"label"),a._uU(41,"Carburant"),a.qZA(),a.TgZ(42,"select",12),a.NdJ("change",function(){return r.moveStep("fuel")}),a.TgZ(43,"option",7),a._uU(44,"Veuillez s\xe9lectionner"),a.qZA(),a.TgZ(45,"option",13),a._uU(46,"Essence"),a.qZA(),a.TgZ(47,"option",14),a._uU(48,"Diesel"),a.qZA(),a.TgZ(49,"option",15),a._uU(50,"Gaz"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(51,"div",5),a.TgZ(52,"label"),a._uU(53,"Kilom\xe9trage"),a.qZA(),a._UZ(54,"input",16),a.TgZ(55,"input",17),a.NdJ("ngModelChange",function(o){return r.mileage=o})("blur",function(){return r.moveStep("mileage")})("keyup",function(o){return r.mileageFormat(o)}),a.qZA(),a.TgZ(56,"span",18),a._uU(57,"KM"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(58,"div",4),a.TgZ(59,"div",5),a.TgZ(60,"label"),a._uU(61,"Puissance fiscale (en Ch)"),a.qZA(),a.TgZ(62,"select",19),a.NdJ("change",function(){return r.moveStep("fiscal")}),a.TgZ(63,"option",7),a._uU(64,"Veuillez s\xe9lectionner"),a.qZA(),a.YNc(65,Ui,2,2,"option",20),a.ALo(66,"demoNumber"),a.qZA(),a.qZA(),a.TgZ(67,"div",5),a.TgZ(68,"label"),a._uU(69,"Boite vitesse"),a.qZA(),a.TgZ(70,"select",21),a.NdJ("change",function(){return r.moveStep("gear_box")}),a.TgZ(71,"option",7),a._uU(72,"Veuillez s\xe9lectionner"),a.qZA(),a.TgZ(73,"option",22),a._uU(74,"Automatique"),a.qZA(),a.TgZ(75,"option",23),a._uU(76,"Manuellle"),a.qZA(),a.TgZ(77,"option",24),a._uU(78,"Pilot\xe9e"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(79,"div",25),a.TgZ(80,"b"),a._UZ(81,"img",26),a._uU(82,"S\xe9lection par marque et mod\xe8le"),a.qZA(),a.TgZ(83,"p"),a._uU(84,"s\xe9lectionner plusieurs carat\xe9ristiques de v\xe9hicule pour trouver plus facilement le mod\xe8le correspondant."),a.qZA(),a.qZA(),a.qZA(),a.TgZ(85,"div",27),a.TgZ(86,"a",28),a._uU(87,"Retour"),a.qZA(),a.TgZ(88,"div",29),a.TgZ(89,"button",30),a.NdJ("click",function(){return r.submit()}),a._uU(90,"Suivant"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&n&&(a.xp6(7),a.Q6J("formGroup",r.form),a.xp6(5),a.Q6J("ngClass",a.WLB(16,De,(r.form.value.brand.length>0||r.form_sent)&&r.getForm.brand.errors,(r.form.value.brand.length>0||r.form_sent)&&!r.getForm.brand.errors)),a.xp6(8),a.Q6J("ngClass",a.WLB(19,De,(r.form.value.model.length>0||r.form_sent)&&r.getForm.model.errors,(r.form.value.model.length>0||r.form_sent)&&!r.getForm.model.errors)),a.xp6(9),a.Q6J("ngClass",a.WLB(22,De,(r.form.value.circulation_month.length>0||r.form_sent)&&r.getForm.circulation_month.errors,(r.form.value.circulation_month.length>0||r.form_sent)&&!r.getForm.circulation_month.errors)),a.xp6(3),a.Q6J("ngForOf",r.months),a.xp6(2),a.Q6J("ngClass",a.WLB(25,De,(r.form.value.circulation_year.length>0||r.form_sent)&&r.getForm.circulation_year.errors,(r.form.value.circulation_year.length>0||r.form_sent)&&!r.getForm.circulation_year.errors)),a.xp6(3),a.Q6J("ngForOf",r.years),a.xp6(5),a.Q6J("ngClass",a.WLB(28,De,(r.form.value.fuel.length>0||r.form_sent)&&r.getForm.fuel.errors,(r.form.value.fuel.length>0||r.form_sent)&&!r.getForm.fuel.errors)),a.xp6(13),a.Q6J("ngModel",r.mileage)("ngModelOptions",a.DdM(31,an))("ngClass",a.WLB(32,De,(r.form.value.mileage.length>0||r.form_sent)&&r.getForm.mileage.errors,(r.form.value.mileage.length>0||r.form_sent)&&!r.getForm.mileage.errors)),a.xp6(7),a.Q6J("ngClass",a.WLB(35,De,(r.form.value.fiscal.length>0||r.form_sent)&&r.getForm.fiscal.errors,(r.form.value.fiscal.length>0||r.form_sent)&&!r.getForm.fiscal.errors)),a.xp6(3),a.Q6J("ngForOf",a.lcZ(66,14,49)),a.xp6(5),a.Q6J("ngClass",a.WLB(38,De,(r.form.value.gear_box.length>0||r.form_sent)&&r.getForm.gear_box.errors,(r.form.value.gear_box.length>0||r.form_sent)&&!r.getForm.gear_box.errors)))},directives:[H._Y,H.JL,H.sg,H.EJ,H.JJ,H.u,Gt.mk,H.YN,H.Kr,Gt.sg,H.Fj,H.On],pipes:[wt.c],encapsulation:2}),e})();var xn=pt(4763),He=pt.n(xn);const jn=["image"];let Wn=(()=>{class e{constructor(){this.imgOutput=new a.vpe,this.imageDestination=""}ngAfterViewInit(){this.cropper=new(He())(this.imageElement.nativeElement,{dragMode:"move",zoomable:!0,rotatable:!1,scalable:!1,movable:!0,cropBoxMovable:!1,cropBoxResizable:!1,autoCropArea:.8,aspectRatio:11/7,restore:!1,guides:!1,center:!1,highlight:!1,minContainerWidth:700,minContainerHeight:210,minCanvasHeight:200,crop:()=>{const n=this.cropper.getCroppedCanvas();this.imgOutput.emit(n.toDataURL("image/png"))}})}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-image-cropper"]],viewQuery:function(n,r){if(1&n&&a.Gf(jn,5),2&n){let i;a.iGM(i=a.CRH())&&(r.imageElement=i.first)}},inputs:{imageSource:["src","imageSource"]},outputs:{imgOutput:"imgOutput"},decls:3,vars:1,consts:[[1,"img-container"],["height","auto","crossorigin","",3,"src"],["image",""]],template:function(n,r){1&n&&(a.TgZ(0,"div",0),a._UZ(1,"img",1,2),a.qZA()),2&n&&(a.xp6(1),a.Q6J("src",r.imageSource,a.LSH))},encapsulation:2}),e})();const Yn=["inputImg"];function Kn(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"div",13),a._uU(1," 01 "),a.TgZ(2,"div",14),a.TgZ(3,"i",15),a.NdJ("click",function(){return a.CHM(n),a.oxw().editImg(1)}),a.qZA(),a.TgZ(4,"i",16),a.NdJ("click",function(){return a.CHM(n),a.oxw().imgPreview[1]=null}),a.qZA(),a.qZA(),a.qZA()}}function Gr(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"div",13),a._uU(1," 02 "),a.TgZ(2,"div",14),a.TgZ(3,"i",15),a.NdJ("click",function(){return a.CHM(n),a.oxw().editImg(2)}),a.qZA(),a.TgZ(4,"i",16),a.NdJ("click",function(){return a.CHM(n),a.oxw().imgPreview[2]=null}),a.qZA(),a.qZA(),a.qZA()}}function ji(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"div",13),a._uU(1," 03 "),a.TgZ(2,"div",14),a.TgZ(3,"i",15),a.NdJ("click",function(){return a.CHM(n),a.oxw().editImg(3)}),a.qZA(),a.TgZ(4,"i",16),a.NdJ("click",function(){return a.CHM(n),a.oxw().imgPreview[3]=null}),a.qZA(),a.qZA(),a.qZA()}}function Wt(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"div",13),a._uU(1," 04 "),a.TgZ(2,"div",14),a.TgZ(3,"i",15),a.NdJ("click",function(){return a.CHM(n),a.oxw().editImg(4)}),a.qZA(),a.TgZ(4,"i",16),a.NdJ("click",function(){return a.CHM(n),a.oxw().imgPreview[4]=null}),a.qZA(),a.qZA(),a.qZA()}}function Wi(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"div",13),a._uU(1," 05 "),a.TgZ(2,"div",14),a.TgZ(3,"i",15),a.NdJ("click",function(){return a.CHM(n),a.oxw().editImg(5)}),a.qZA(),a.TgZ(4,"i",16),a.NdJ("click",function(){return a.CHM(n),a.oxw().imgPreview[5]=null}),a.qZA(),a.qZA(),a.qZA()}}function as(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"div",13),a._uU(1," 06 "),a.TgZ(2,"div",14),a.TgZ(3,"i",15),a.NdJ("click",function(){return a.CHM(n),a.oxw().editImg(6)}),a.qZA(),a.TgZ(4,"i",16),a.NdJ("click",function(){return a.CHM(n),a.oxw().imgPreview[6]=null}),a.qZA(),a.qZA(),a.qZA()}}function gr(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"app-image-cropper",22),a.NdJ("imgOutput",function(i){return a.CHM(n),a.oxw(2).getCropped(i)}),a.qZA()}if(2&e){const n=a.oxw(2);a.Q6J("src",n.fileSent[n.imgIndex])}}function $r(e,t){if(1&e){const n=a.EpF();a.ynx(0),a._UZ(1,"div",17),a.TgZ(2,"div",18),a.YNc(3,gr,1,1,"app-image-cropper",19),a.TgZ(4,"div",20),a.TgZ(5,"button",21),a.NdJ("click",function(){return a.CHM(n),a.oxw().closeCropper(!1)}),a._uU(6,"Ok"),a.qZA(),a.TgZ(7,"button",21),a.NdJ("click",function(){return a.CHM(n),a.oxw().closeCropper(!0)}),a._uU(8,"Annuler"),a.qZA(),a.qZA(),a.qZA(),a.BQk()}if(2&e){const n=a.oxw();a.xp6(3),a.Q6J("ngIf",n.fileSent[n.imgIndex])}}let Qn=(()=>{class e{constructor(n,r){this.router=n,this.postingService=r,this.imageChangedEvent="",this.openCrop=!1,this.fileSent=[null,null,null,null,null,null,null],this.imgPreview=[null,null,null,null,null,null,null],this.imgIndex=-1}ngOnInit(){}fileChangeEvent(n,r){const i=n.target.files[0];this.inputImg.nativeElement.value=null;const o=new FileReader;o.readAsDataURL(i),o.onload=s=>{this.fileSent[r]=o.result,this.imgIndex=r,this.openCrop=!0}}closeCropper(n){n?this.openCrop=!1:(this.imgPreview[this.imgIndex]=this.cropping,this.openCrop=!1,this.postingService.emitDetails(Object.assign({step_details:1},this.imgPreview)))}moveStep(n){return this.postingService.emitSteps(n)}getCropped(n){this.cropping=n}editImg(n){this.imgIndex=n,this.inputImg.nativeElement.click()}submit(){}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(le.F0),a.Y36(Ve))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-previews"]],viewQuery:function(n,r){if(1&n&&a.Gf(Yn,5),2&n){let i;a.iGM(i=a.CRH())&&(r.inputImg=i.first)}},decls:50,vars:14,consts:[[1,"title"],[1,"global-container","_displayFlex"],[1,"form-container","previewList"],[1,"preview-list"],[3,"src","click"],["class","bottom-action _displayFlex",4,"ngIf"],[1,"text"],[1,"button","uploadFile"],["type","file",3,"change"],["inputImg",""],[1,"tips","details"],["src","./assets/images/lightbulb.png"],[4,"ngIf"],[1,"bottom-action","_displayFlex"],[1,"action"],[1,"fa-solid","fa-arrow-rotate-right",3,"click"],[1,"fa-solid","fa-trash-can",3,"click"],[1,"modal-back"],[1,"crop-modal"],[3,"src","imgOutput",4,"ngIf"],[1,"editing"],[1,"button",3,"click"],[3,"src","imgOutput"]],template:function(n,r){1&n&&(a.TgZ(0,"div",0),a.TgZ(1,"h2"),a._uU(2,"Vendre votre voiture ? C'est tr\xe8s simple!"),a.qZA(),a.TgZ(3,"h3"),a._uU(4,"Selectionnez votre voiture"),a.qZA(),a.qZA(),a.TgZ(5,"div",1),a.TgZ(6,"div",2),a.TgZ(7,"div",3),a.TgZ(8,"ul"),a.TgZ(9,"li"),a.TgZ(10,"img",4),a.NdJ("click",function(){return r.editImg(0)}),a.qZA(),a.qZA(),a.TgZ(11,"li"),a.TgZ(12,"img",4),a.NdJ("click",function(){return r.editImg(1)}),a.qZA(),a.YNc(13,Kn,5,0,"div",5),a.qZA(),a.TgZ(14,"li"),a.TgZ(15,"img",4),a.NdJ("click",function(){return r.editImg(2)}),a.qZA(),a.YNc(16,Gr,5,0,"div",5),a.qZA(),a.TgZ(17,"li"),a.TgZ(18,"img",4),a.NdJ("click",function(){return r.editImg(3)}),a.qZA(),a.YNc(19,ji,5,0,"div",5),a.qZA(),a.TgZ(20,"li",6),a._uU(21,"Premi\xe8re photo de l'annonce"),a.qZA(),a.TgZ(22,"li"),a.TgZ(23,"img",4),a.NdJ("click",function(){return r.editImg(4)}),a.qZA(),a.YNc(24,Wt,5,0,"div",5),a.qZA(),a.TgZ(25,"li"),a.TgZ(26,"img",4),a.NdJ("click",function(){return r.editImg(5)}),a.qZA(),a.YNc(27,Wi,5,0,"div",5),a.qZA(),a.TgZ(28,"li"),a.TgZ(29,"img",4),a.NdJ("click",function(){return r.editImg(6)}),a.qZA(),a.YNc(30,as,5,0,"div",5),a.qZA(),a.qZA(),a.TgZ(31,"label",7),a._uU(32,"T\xe9l\xe9charger les photos "),a.TgZ(33,"input",8,9),a.NdJ("change",function(o){return r.fileChangeEvent(o,r.imgIndex+1)}),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(35,"div",10),a.TgZ(36,"b"),a._UZ(37,"img",11),a._uU(38,"Photos"),a.qZA(),a.TgZ(39,"div",6),a.TgZ(40,"ul"),a.TgZ(41,"li"),a._uU(42,"Une image vaut mieux qu\u2019un long discours ; mais elle en dit davantage encore : elle souligne l\u2019\xe9tat de votre v\xe9hicule."),a.qZA(),a.TgZ(43,"li"),a._uU(44,"Conseils utiles : prenez des photos de l'int\xe9rieur et de l'ext\xe9rieur de votre v\xe9hicule ! Vous pouvez t\xe9l\xe9charger jusqu'\xe0 7 photos, profitez donc de cet avantage."),a.qZA(),a.TgZ(45,"li"),a._uU(46,"Les annonces avec photos sont consult\xe9es plus fr\xe9quemment, jusqu'\xe0 25 % de demande en plus par photo."),a.qZA(),a.TgZ(47,"li"),a._uU(48,"* Plus vous mettez des photos en ligne et plus vos chances de vendre sont \xe9lev\xe9es !"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.YNc(49,$r,9,1,"ng-container",12)),2&n&&(a.xp6(10),a.Q6J("src",r.imgPreview[0]?r.imgPreview[0]:"./assets/images/preview/carView1.png",a.LSH),a.xp6(2),a.Q6J("src",r.imgPreview[1]?r.imgPreview[1]:"./assets/images/preview/carView1.png",a.LSH),a.xp6(1),a.Q6J("ngIf",r.imgPreview[1]),a.xp6(2),a.Q6J("src",r.imgPreview[2]?r.imgPreview[2]:"./assets/images/preview/carView2.png",a.LSH),a.xp6(1),a.Q6J("ngIf",r.imgPreview[2]),a.xp6(2),a.Q6J("src",r.imgPreview[3]?r.imgPreview[3]:"./assets/images/preview/carView3.png",a.LSH),a.xp6(1),a.Q6J("ngIf",r.imgPreview[3]),a.xp6(4),a.Q6J("src",r.imgPreview[4]?r.imgPreview[4]:"./assets/images/preview/carView4.png",a.LSH),a.xp6(1),a.Q6J("ngIf",r.imgPreview[4]),a.xp6(2),a.Q6J("src",r.imgPreview[5]?r.imgPreview[5]:"./assets/images/preview/carView5.png",a.LSH),a.xp6(1),a.Q6J("ngIf",r.imgPreview[5]),a.xp6(2),a.Q6J("src",r.imgPreview[6]?r.imgPreview[6]:"./assets/images/preview/carView6.png",a.LSH),a.xp6(1),a.Q6J("ngIf",r.imgPreview[6]),a.xp6(19),a.Q6J("ngIf",r.openCrop))},directives:[Gt.O5,Wn],encapsulation:2}),e})(),vr=(()=>{class e{constructor(n,r){this.router=n,this.postingService=r}ngOnInit(){}submit(){this.postingService.emitDetails({step_details:2})}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(le.F0),a.Y36(Ve))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-price"]],decls:14,vars:0,consts:[[1,"global-container"],[1,"form-container",3,"submit"],[1,"price"],[1,"form-group"],["type","text","name","price"],[1,"dt"],[1,"price-compare"]],template:function(n,r){1&n&&(a.TgZ(0,"div",0),a.TgZ(1,"form",1),a.NdJ("submit",function(){return r.submit()}),a.TgZ(2,"div",2),a.TgZ(3,"div",3),a.TgZ(4,"label"),a._uU(5,"* Prix"),a.qZA(),a._UZ(6,"input",4),a.TgZ(7,"span",5),a._uU(8,"DT"),a.qZA(),a.qZA(),a.TgZ(9,"h5"),a._uU(10,"Evaluation du prix pour cette Isuzu DMAX 4P"),a.qZA(),a.TgZ(11,"div",6),a.TgZ(12,"p"),a._uU(13,"Comparer le prix de l'offre pour ce v\xe9hicule avec d'autres v\xe9hicules similaires. L'\xe9valuation du prix est r\xe9alis\xe9e sur la base des donn\xe9es de v\xe9hicule indiqu\xe9es par le vendeur. Des indications individuelles et particuli\xe8res concernant l'\xe9tat et l'\xe9quipement peuvent dans certains cas justifier un prix plus \xe9lev\xe9."),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA())},directives:[H._Y,H.JL,H.F],encapsulation:2}),e})();function Et(e){this.content=e}Et.prototype={constructor:Et,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,i=r.find(e),o=r.content.slice();return-1==i?o.push(n||e,t):(o[i+1]=t,n&&(o[i]=n)),new Et(o)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new Et(n)},addToStart:function(e,t){return new Et([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new Et(n)},addBefore:function(e,t,n){var r=this.remove(t),i=r.content.slice(),o=r.find(e);return i.splice(-1==o?i.length:o,0,t,n),new Et(i)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=Et.from(e)).size?new Et(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=Et.from(e)).size?new Et(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=Et.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},get size(){return this.content.length>>1}},Et.from=function(e){if(e instanceof Et)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new Et(t)};const ti=Et;function yr(e,t,n){for(var r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;var i=e.child(r),o=t.child(r);if(i!=o){if(!i.sameMarkup(o))return n;if(i.isText&&i.text!=o.text){for(var s=0;i.text[s]==o.text[s];s++)n++;return n}if(i.content.size||o.content.size){var c=yr(i.content,o.content,n+1);if(null!=c)return c}n+=i.nodeSize}else n+=i.nodeSize}}function br(e,t,n,r){for(var i=e.childCount,o=t.childCount;;){if(0==i||0==o)return i==o?null:{a:n,b:r};var s=e.child(--i),c=t.child(--o),l=s.nodeSize;if(s!=c){if(!s.sameMarkup(c))return{a:n,b:r};if(s.isText&&s.text!=c.text){for(var u=0,p=Math.min(s.text.length,c.text.length);u<p&&s.text[s.text.length-u-1]==c.text[c.text.length-u-1];)u++,n--,r--;return{a:n,b:r}}if(s.content.size||c.content.size){var f=br(s.content,c.content,n-1,r-1);if(f)return f}n-=l,r-=l}else n-=l,r-=l}}var R=function(t,n){if(this.content=t,this.size=n||0,null==n)for(var r=0;r<t.length;r++)this.size+=t[r].nodeSize},wn={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};R.prototype.nodesBetween=function(t,n,r,i,o){void 0===i&&(i=0);for(var s=0,c=0;c<n;s++){var l=this.content[s],u=c+l.nodeSize;if(u>t&&!1!==r(l,i+c,o,s)&&l.content.size){var p=c+1;l.nodesBetween(Math.max(0,t-p),Math.min(l.content.size,n-p),r,i+p)}c=u}},R.prototype.descendants=function(t){this.nodesBetween(0,this.size,t)},R.prototype.textBetween=function(t,n,r,i){var o="",s=!0;return this.nodesBetween(t,n,function(c,l){c.isText?(o+=c.text.slice(Math.max(t,l)-l,n-l),s=!r):c.isLeaf&&i?(o+="function"==typeof i?i(c):i,s=!r):!s&&c.isBlock&&(o+=r,s=!0)},0),o},R.prototype.append=function(t){if(!t.size)return this;if(!this.size)return t;var n=this.lastChild,r=t.firstChild,i=this.content.slice(),o=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),o=1);o<t.content.length;o++)i.push(t.content[o]);return new R(i,this.size+t.size)},R.prototype.cut=function(t,n){if(null==n&&(n=this.size),0==t&&n==this.size)return this;var r=[],i=0;if(n>t)for(var o=0,s=0;s<n;o++){var c=this.content[o],l=s+c.nodeSize;l>t&&((s<t||l>n)&&(c=c.isText?c.cut(Math.max(0,t-s),Math.min(c.text.length,n-s)):c.cut(Math.max(0,t-s-1),Math.min(c.content.size,n-s-1))),r.push(c),i+=c.nodeSize),s=l}return new R(r,i)},R.prototype.cutByIndex=function(t,n){return t==n?R.empty:0==t&&n==this.content.length?this:new R(this.content.slice(t,n))},R.prototype.replaceChild=function(t,n){var r=this.content[t];if(r==n)return this;var i=this.content.slice(),o=this.size+n.nodeSize-r.nodeSize;return i[t]=n,new R(i,o)},R.prototype.addToStart=function(t){return new R([t].concat(this.content),this.size+t.nodeSize)},R.prototype.addToEnd=function(t){return new R(this.content.concat(t),this.size+t.nodeSize)},R.prototype.eq=function(t){if(this.content.length!=t.content.length)return!1;for(var n=0;n<this.content.length;n++)if(!this.content[n].eq(t.content[n]))return!1;return!0},wn.firstChild.get=function(){return this.content.length?this.content[0]:null},wn.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},wn.childCount.get=function(){return this.content.length},R.prototype.child=function(t){var n=this.content[t];if(!n)throw new RangeError("Index "+t+" out of range for "+this);return n},R.prototype.maybeChild=function(t){return this.content[t]},R.prototype.forEach=function(t){for(var n=0,r=0;n<this.content.length;n++){var i=this.content[n];t(i,r,n),r+=i.nodeSize}},R.prototype.findDiffStart=function(t,n){return void 0===n&&(n=0),yr(this,t,n)},R.prototype.findDiffEnd=function(t,n,r){return void 0===n&&(n=this.size),void 0===r&&(r=t.size),br(this,t,n,r)},R.prototype.findIndex=function(t,n){if(void 0===n&&(n=-1),0==t)return xr(0,t);if(t==this.size)return xr(this.content.length,t);if(t>this.size||t<0)throw new RangeError("Position "+t+" outside of fragment ("+this+")");for(var r=0,i=0;;r++){var s=i+this.child(r).nodeSize;if(s>=t)return s==t||n>0?xr(r+1,s):xr(r,i);i=s}},R.prototype.toString=function(){return"<"+this.toStringInner()+">"},R.prototype.toStringInner=function(){return this.content.join(", ")},R.prototype.toJSON=function(){return this.content.length?this.content.map(function(t){return t.toJSON()}):null},R.fromJSON=function(t,n){if(!n)return R.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new R(n.map(t.nodeFromJSON))},R.fromArray=function(t){if(!t.length)return R.empty;for(var n,r=0,i=0;i<t.length;i++){var o=t[i];r+=o.nodeSize,i&&o.isText&&t[i-1].sameMarkup(o)?(n||(n=t.slice(0,i)),n[n.length-1]=o.withText(n[n.length-1].text+o.text)):n&&n.push(o)}return new R(n||t,r)},R.from=function(t){if(!t)return R.empty;if(t instanceof R)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new R([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(R.prototype,wn);var _r={index:0,offset:0};function xr(e,t){return _r.index=e,_r.offset=t,_r}function wr(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!wr(e[r],t[r]))return!1}else{for(var i in e)if(!(i in t)||!wr(e[i],t[i]))return!1;for(var o in t)if(!(o in e))return!1}return!0}R.empty=new R([],0);var st=function(t,n){this.type=t,this.attrs=n};function ge(e){var t=Error.call(this,e);return t.__proto__=ge.prototype,t}st.prototype.addToSet=function(t){for(var n,r=!1,i=0;i<t.length;i++){var o=t[i];if(this.eq(o))return t;if(this.type.excludes(o.type))n||(n=t.slice(0,i));else{if(o.type.excludes(this.type))return t;!r&&o.type.rank>this.type.rank&&(n||(n=t.slice(0,i)),n.push(this),r=!0),n&&n.push(o)}}return n||(n=t.slice()),r||n.push(this),n},st.prototype.removeFromSet=function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return t.slice(0,n).concat(t.slice(n+1));return t},st.prototype.isInSet=function(t){for(var n=0;n<t.length;n++)if(this.eq(t[n]))return!0;return!1},st.prototype.eq=function(t){return this==t||this.type==t.type&&wr(this.attrs,t.attrs)},st.prototype.toJSON=function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return t},st.fromJSON=function(t,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");var r=t.marks[n.type];if(!r)throw new RangeError("There is no mark type "+n.type+" in this schema");return r.create(n.attrs)},st.sameSet=function(t,n){if(t==n)return!0;if(t.length!=n.length)return!1;for(var r=0;r<t.length;r++)if(!t[r].eq(n[r]))return!1;return!0},st.setFrom=function(t){if(!t||0==t.length)return st.none;if(t instanceof st)return[t];var n=t.slice();return n.sort(function(r,i){return r.type.rank-i.type.rank}),n},st.none=[],(ge.prototype=Object.create(Error.prototype)).constructor=ge,ge.prototype.name="ReplaceError";var V=function(t,n,r){this.content=t,this.openStart=n,this.openEnd=r},ei={size:{configurable:!0}};function ni(e,t,n){var r=e.findIndex(t),i=r.index,o=r.offset,s=e.maybeChild(i),c=e.findIndex(n),l=c.index;if(o==t||s.isText){if(c.offset!=n&&!e.child(l).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(i!=l)throw new RangeError("Removing non-flat range");return e.replaceChild(i,s.copy(ni(s.content,t-o-1,n-o-1)))}function ri(e,t,n,r){var i=e.findIndex(t),o=i.index,s=i.offset,c=e.maybeChild(o);if(s==t||c.isText)return r&&!r.canReplace(o,o,n)?null:e.cut(0,t).append(n).append(e.cut(t));var l=ri(c.content,t-s-1,n);return l&&e.replaceChild(o,c.copy(l))}function Ki(e,t,n){if(n.openStart>e.depth)throw new ge("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new ge("Inconsistent open depths");return Cr(e,t,n,0)}function Cr(e,t,n,r){var i=e.index(r),o=e.node(r);if(i==t.index(r)&&r<e.depth-n.openStart){var s=Cr(e,t,n,r+1);return o.copy(o.content.replaceChild(i,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){var u=function Qi(e,t){for(var n=t.depth-e.openStart,i=t.node(n).copy(e.content),o=n-1;o>=0;o--)i=t.node(o).copy(R.from(i));return{start:i.resolveNoCache(e.openStart+n),end:i.resolveNoCache(i.content.size-e.openEnd-n)}}(n,e);return un(o,si(e,u.start,u.end,t,r))}var c=e.parent,l=c.content;return un(c,l.cut(0,e.parentOffset).append(n.content).append(l.cut(t.parentOffset)))}return un(o,Gn(e,t,r))}function ii(e,t){if(!t.type.compatibleContent(e.type))throw new ge("Cannot join "+t.type.name+" onto "+e.type.name)}function oi(e,t,n){var r=e.node(n);return ii(r,t.node(n)),r}function ln(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function Xn(e,t,n,r){var i=(t||e).node(n),o=0,s=t?t.index(n):i.childCount;e&&(o=e.index(n),e.depth>n?o++:e.textOffset&&(ln(e.nodeAfter,r),o++));for(var c=o;c<s;c++)ln(i.child(c),r);t&&t.depth==n&&t.textOffset&&ln(t.nodeBefore,r)}function un(e,t){if(!e.type.validContent(t))throw new ge("Invalid content for node "+e.type.name);return e.copy(t)}function si(e,t,n,r,i){var o=e.depth>i&&oi(e,t,i+1),s=r.depth>i&&oi(n,r,i+1),c=[];return Xn(null,e,i,c),o&&s&&t.index(i)==n.index(i)?(ii(o,s),ln(un(o,si(e,t,n,r,i+1)),c)):(o&&ln(un(o,Gn(e,t,i+1)),c),Xn(t,n,i,c),s&&ln(un(s,Gn(n,r,i+1)),c)),Xn(r,null,i,c),new R(c)}function Gn(e,t,n){var r=[];return Xn(null,e,n,r),e.depth>n&&ln(un(oi(e,t,n+1),Gn(e,t,n+1)),r),Xn(t,null,n,r),new R(r)}ei.size.get=function(){return this.content.size-this.openStart-this.openEnd},V.prototype.insertAt=function(t,n){var r=ri(this.content,t+this.openStart,n,null);return r&&new V(r,this.openStart,this.openEnd)},V.prototype.removeBetween=function(t,n){return new V(ni(this.content,t+this.openStart,n+this.openStart),this.openStart,this.openEnd)},V.prototype.eq=function(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd},V.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},V.prototype.toJSON=function(){if(!this.content.size)return null;var t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t},V.fromJSON=function(t,n){if(!n)return V.empty;var r=n.openStart||0,i=n.openEnd||0;if("number"!=typeof r||"number"!=typeof i)throw new RangeError("Invalid input for Slice.fromJSON");return new V(R.fromJSON(t,n.content),r,i)},V.maxOpen=function(t,n){void 0===n&&(n=!0);for(var r=0,i=0,o=t.firstChild;o&&!o.isLeaf&&(n||!o.type.spec.isolating);o=o.firstChild)r++;for(var s=t.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)i++;return new V(t,r,i)},Object.defineProperties(V.prototype,ei),V.empty=new V(R.empty,0,0);var Ct=function(t,n,r){this.pos=t,this.path=n,this.depth=n.length/3-1,this.parentOffset=r},Cn={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};Ct.prototype.resolveDepth=function(t){return null==t?this.depth:t<0?this.depth+t:t},Cn.parent.get=function(){return this.node(this.depth)},Cn.doc.get=function(){return this.node(0)},Ct.prototype.node=function(t){return this.path[3*this.resolveDepth(t)]},Ct.prototype.index=function(t){return this.path[3*this.resolveDepth(t)+1]},Ct.prototype.indexAfter=function(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)},Ct.prototype.start=function(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1},Ct.prototype.end=function(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size},Ct.prototype.before=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]},Ct.prototype.after=function(t){if(!(t=this.resolveDepth(t)))throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize},Cn.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Cn.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r},Cn.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)},Ct.prototype.posAtIndex=function(t,n){n=this.resolveDepth(n);for(var r=this.path[3*n],i=0==n?0:this.path[3*n-1]+1,o=0;o<t;o++)i+=r.child(o).nodeSize;return i},Ct.prototype.marks=function(){var t=this.parent,n=this.index();if(0==t.content.size)return st.none;if(this.textOffset)return t.child(n).marks;var r=t.maybeChild(n-1),i=t.maybeChild(n);if(!r){var o=r;r=i,i=o}for(var s=r.marks,c=0;c<s.length;c++)!1===s[c].type.spec.inclusive&&(!i||!s[c].isInSet(i.marks))&&(s=s[c--].removeFromSet(s));return s},Ct.prototype.marksAcross=function(t){var n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;for(var r=n.marks,i=t.parent.maybeChild(t.index()),o=0;o<r.length;o++)!1===r[o].type.spec.inclusive&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r},Ct.prototype.sharedDepth=function(t){for(var n=this.depth;n>0;n--)if(this.start(n)<=t&&this.end(n)>=t)return n;return 0},Ct.prototype.blockRange=function(t,n){if(void 0===t&&(t=this),t.pos<this.pos)return t.blockRange(this);for(var r=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);r>=0;r--)if(t.pos<=this.end(r)&&(!n||n(this.node(r))))return new ve(this,t,r)},Ct.prototype.sameParent=function(t){return this.pos-this.parentOffset==t.pos-t.parentOffset},Ct.prototype.max=function(t){return t.pos>this.pos?t:this},Ct.prototype.min=function(t){return t.pos<this.pos?t:this},Ct.prototype.toString=function(){for(var t="",n=1;n<=this.depth;n++)t+=(t?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return t+":"+this.parentOffset},Ct.resolve=function(t,n){if(!(n>=0&&n<=t.content.size))throw new RangeError("Position "+n+" out of range");for(var r=[],i=0,o=n,s=t;;){var c=s.content.findIndex(o),l=c.index,u=c.offset,p=o-u;if(r.push(s,l,i+u),!p||(s=s.child(l)).isText)break;o=p-1,i+=u+1}return new Ct(n,r,o)},Ct.resolveCached=function(t,n){for(var r=0;r<it.length;r++){var i=it[r];if(i.pos==n&&i.doc==t)return i}var o=it[Tr]=Ct.resolve(t,n);return Tr=(Tr+1)%ai,o},Object.defineProperties(Ct.prototype,Cn);var it=[],Tr=0,ai=12,ve=function(t,n,r){this.$from=t,this.$to=n,this.depth=r},Tn={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};Tn.start.get=function(){return this.$from.before(this.depth+1)},Tn.end.get=function(){return this.$to.after(this.depth+1)},Tn.parent.get=function(){return this.$from.node(this.depth)},Tn.startIndex.get=function(){return this.$from.index(this.depth)},Tn.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(ve.prototype,Tn);var kn=Object.create(null),Q=function(t,n,r,i){this.type=t,this.attrs=n,this.content=r||R.empty,this.marks=i||st.none},te={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};te.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},te.childCount.get=function(){return this.content.childCount},Q.prototype.child=function(t){return this.content.child(t)},Q.prototype.maybeChild=function(t){return this.content.maybeChild(t)},Q.prototype.forEach=function(t){this.content.forEach(t)},Q.prototype.nodesBetween=function(t,n,r,i){void 0===i&&(i=0),this.content.nodesBetween(t,n,r,i,this)},Q.prototype.descendants=function(t){this.nodesBetween(0,this.content.size,t)},te.textContent.get=function(){return this.textBetween(0,this.content.size,"")},Q.prototype.textBetween=function(t,n,r,i){return this.content.textBetween(t,n,r,i)},te.firstChild.get=function(){return this.content.firstChild},te.lastChild.get=function(){return this.content.lastChild},Q.prototype.eq=function(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)},Q.prototype.sameMarkup=function(t){return this.hasMarkup(t.type,t.attrs,t.marks)},Q.prototype.hasMarkup=function(t,n,r){return this.type==t&&wr(this.attrs,n||t.defaultAttrs||kn)&&st.sameSet(this.marks,r||st.none)},Q.prototype.copy=function(t){return void 0===t&&(t=null),t==this.content?this:new this.constructor(this.type,this.attrs,t,this.marks)},Q.prototype.mark=function(t){return t==this.marks?this:new this.constructor(this.type,this.attrs,this.content,t)},Q.prototype.cut=function(t,n){return 0==t&&n==this.content.size?this:this.copy(this.content.cut(t,n))},Q.prototype.slice=function(t,n,r){if(void 0===n&&(n=this.content.size),void 0===r&&(r=!1),t==n)return V.empty;var i=this.resolve(t),o=this.resolve(n),s=r?0:i.sharedDepth(n),c=i.start(s),u=i.node(s).content.cut(i.pos-c,o.pos-c);return new V(u,i.depth-s,o.depth-s)},Q.prototype.replace=function(t,n,r){return Ki(this.resolve(t),this.resolve(n),r)},Q.prototype.nodeAt=function(t){for(var n=this;;){var r=n.content.findIndex(t),o=r.offset;if(!(n=n.maybeChild(r.index)))return null;if(o==t||n.isText)return n;t-=o+1}},Q.prototype.childAfter=function(t){var n=this.content.findIndex(t),r=n.index,i=n.offset;return{node:this.content.maybeChild(r),index:r,offset:i}},Q.prototype.childBefore=function(t){if(0==t)return{node:null,index:0,offset:0};var n=this.content.findIndex(t),r=n.index,i=n.offset;if(i<t)return{node:this.content.child(r),index:r,offset:i};var o=this.content.child(r-1);return{node:o,index:r-1,offset:i-o.nodeSize}},Q.prototype.resolve=function(t){return Ct.resolveCached(this,t)},Q.prototype.resolveNoCache=function(t){return Ct.resolve(this,t)},Q.prototype.rangeHasMark=function(t,n,r){var i=!1;return n>t&&this.nodesBetween(t,n,function(o){return r.isInSet(o.marks)&&(i=!0),!i}),i},te.isBlock.get=function(){return this.type.isBlock},te.isTextblock.get=function(){return this.type.isTextblock},te.inlineContent.get=function(){return this.type.inlineContent},te.isInline.get=function(){return this.type.isInline},te.isText.get=function(){return this.type.isText},te.isLeaf.get=function(){return this.type.isLeaf},te.isAtom.get=function(){return this.type.isAtom},Q.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),Tt(this.marks,t)},Q.prototype.contentMatchAt=function(t){var n=this.type.contentMatch.matchFragment(this.content,0,t);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n},Q.prototype.canReplace=function(t,n,r,i,o){void 0===r&&(r=R.empty),void 0===i&&(i=0),void 0===o&&(o=r.childCount);var s=this.contentMatchAt(t).matchFragment(r,i,o),c=s&&s.matchFragment(this.content,n);if(!c||!c.validEnd)return!1;for(var l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0},Q.prototype.canReplaceWith=function(t,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;var o=this.contentMatchAt(t).matchType(r),s=o&&o.matchFragment(this.content,n);return!!s&&s.validEnd},Q.prototype.canAppend=function(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)},Q.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var t=st.none,n=0;n<this.marks.length;n++)t=this.marks[n].addToSet(t);if(!st.sameSet(t,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map(function(r){return r.type.name}));this.content.forEach(function(r){return r.check()})},Q.prototype.toJSON=function(){var t={type:this.type.name};for(var n in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(function(r){return r.toJSON()})),t},Q.fromJSON=function(t,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");var r=null;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(t.markFromJSON)}if("text"==n.type){if("string"!=typeof n.text)throw new RangeError("Invalid text node in JSON");return t.text(n.text,r)}var i=R.fromJSON(t,n.content);return t.nodeType(n.type).create(n.attrs,i,r)},Object.defineProperties(Q.prototype,te);var Xi=function(e){function t(r,i,o,s){if(e.call(this,r,i,null,s),!o)throw new RangeError("Empty text nodes are not allowed");this.text=o}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return t.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Tt(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},t.prototype.textBetween=function(i,o){return this.text.slice(i,o)},n.nodeSize.get=function(){return this.text.length},t.prototype.mark=function(i){return i==this.marks?this:new t(this.type,this.attrs,this.text,i)},t.prototype.withText=function(i){return i==this.text?this:new t(this.type,this.attrs,i,this.marks)},t.prototype.cut=function(i,o){return void 0===i&&(i=0),void 0===o&&(o=this.text.length),0==i&&o==this.text.length?this:this.withText(this.text.slice(i,o))},t.prototype.eq=function(i){return this.sameMarkup(i)&&this.text==i.text},t.prototype.toJSON=function(){var i=e.prototype.toJSON.call(this);return i.text=this.text,i},Object.defineProperties(t.prototype,n),t}(Q);function Tt(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}var rt=function(t){this.validEnd=t,this.next=[],this.wrapCache=[]},kr={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};rt.parse=function(t,n){var r=new Ie(t,n);if(null==r.next)return rt.empty;var i=Pe(r);r.next&&r.err("Unexpected trailing text");var o=function to(e){var t=Object.create(null);return function n(r){var i=[];r.forEach(function(l){e[l].forEach(function(u){var p=u.term,f=u.to;if(p){var d=i.indexOf(p),g=d>-1&&i[d+1];$i(e,f).forEach(function(y){g||i.push(p,g=[]),-1==g.indexOf(y)&&g.push(y)})}})});for(var o=t[r.join(",")]=new rt(r.indexOf(e.length-1)>-1),s=0;s<i.length;s+=2){var c=i[s+1].sort(Mn);o.next.push(i[s],t[c.join(",")]||n(c))}return o}($i(e,0))}(function li(e){var t=[[]];return i(function o(s,c){if("choice"==s.type)return s.exprs.reduce(function(k,M){return k.concat(o(M,c))},[]);if("seq"==s.type)for(var l=0;;l++){var u=o(s.exprs[l],c);if(l==s.exprs.length-1)return u;i(u,c=n())}else{if("star"==s.type){var p=n();return r(c,p),i(o(s.expr,p),p),[r(p)]}if("plus"==s.type){var f=n();return i(o(s.expr,c),f),i(o(s.expr,f),f),[r(f)]}if("opt"==s.type)return[r(c)].concat(o(s.expr,c));if("range"==s.type){for(var d=c,g=0;g<s.min;g++){var y=n();i(o(s.expr,d),y),d=y}if(-1==s.max)i(o(s.expr,d),d);else for(var _=s.min;_<s.max;_++){var C=n();r(d,C),i(o(s.expr,d),C),d=C}return[r(d)]}if("name"==s.type)return[r(c,null,s.value)]}}(e,0),n()),t;function n(){return t.push([])-1}function r(s,c,l){var u={term:l,to:c};return t[s].push(u),u}function i(s,c){s.forEach(function(l){return l.to=c})}}(i));return function eo(e,t){for(var n=0,r=[e];n<r.length;n++){for(var i=r[n],o=!i.validEnd,s=[],c=0;c<i.next.length;c+=2){var l=i.next[c],u=i.next[c+1];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),-1==r.indexOf(u)&&r.push(u)}o&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,r),o},rt.prototype.matchType=function(t){for(var n=0;n<this.next.length;n+=2)if(this.next[n]==t)return this.next[n+1];return null},rt.prototype.matchFragment=function(t,n,r){void 0===n&&(n=0),void 0===r&&(r=t.childCount);for(var i=this,o=n;i&&o<r;o++)i=i.matchType(t.child(o).type);return i},kr.inlineContent.get=function(){var e=this.next[0];return!!e&&e.isInline},kr.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}},rt.prototype.compatible=function(t){for(var n=0;n<this.next.length;n+=2)for(var r=0;r<t.next.length;r+=2)if(this.next[n]==t.next[r])return!0;return!1},rt.prototype.fillBefore=function(t,n,r){void 0===n&&(n=!1),void 0===r&&(r=0);var i=[this];return function o(s,c){var l=s.matchFragment(t,r);if(l&&(!n||l.validEnd))return R.from(c.map(function(g){return g.createAndFill()}));for(var u=0;u<s.next.length;u+=2){var p=s.next[u],f=s.next[u+1];if(!p.isText&&!p.hasRequiredAttrs()&&-1==i.indexOf(f)){i.push(f);var d=o(f,c.concat(p));if(d)return d}}}(this,[])},rt.prototype.findWrapping=function(t){for(var n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==t)return this.wrapCache[n+1];var r=this.computeWrapping(t);return this.wrapCache.push(t,r),r},rt.prototype.computeWrapping=function(t){for(var n=Object.create(null),r=[{match:this,type:null,via:null}];r.length;){var i=r.shift(),o=i.match;if(o.matchType(t)){for(var s=[],c=i;c.type;c=c.via)s.push(c.type);return s.reverse()}for(var l=0;l<o.next.length;l+=2){var u=o.next[l];!u.isLeaf&&!u.hasRequiredAttrs()&&!(u.name in n)&&(!i.type||o.next[l+1].validEnd)&&(r.push({match:u.contentMatch,type:u,via:i}),n[u.name]=!0)}}},kr.edgeCount.get=function(){return this.next.length>>1},rt.prototype.edge=function(t){var n=t<<1;if(n>=this.next.length)throw new RangeError("There's no "+t+"th edge in this content match");return{type:this.next[n],next:this.next[n+1]}},rt.prototype.toString=function(){var t=[];return function n(r){t.push(r);for(var i=1;i<r.next.length;i+=2)-1==t.indexOf(r.next[i])&&n(r.next[i])}(this),t.map(function(r,i){for(var o=i+(r.validEnd?"*":" ")+" ",s=0;s<r.next.length;s+=2)o+=(s?", ":"")+r.next[s].name+"->"+t.indexOf(r.next[s+1]);return o}).join("\n")},Object.defineProperties(rt.prototype,kr),rt.empty=new rt(!0);var Ie=function(t,n){this.string=t,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},Gi={next:{configurable:!0}};function Pe(e){var t=[];do{t.push(cs(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function cs(e){var t=[];do{t.push(Nt(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function Nt(e){for(var t=function ci(e){if(e.eat("(")){var t=Pe(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var n=function ls(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var i=[];for(var o in n){var s=n[o];s.groups.indexOf(t)>-1&&i.push(s)}return 0==i.length&&e.err("No node type or group '"+t+"' found"),i}(e,e.next).map(function(r){return null==e.inline?e.inline=r.isInline:e.inline!=r.isInline&&e.err("Mixing inline and block content"),{type:"name",value:r}});return e.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}e.err("Unexpected token '"+e.next+"'")}(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=Sn(e,t)}return t}function ye(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function Sn(e,t){var n=ye(e),r=n;return e.eat(",")&&(r="}"!=e.next?ye(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function Mn(e,t){return t-e}function $i(e,t){var n=[];return function r(i){var o=e[i];if(1==o.length&&!o[0].term)return r(o[0].to);n.push(i);for(var s=0;s<o.length;s++){var c=o[s],u=c.to;!c.term&&-1==n.indexOf(u)&&r(u)}}(t),n.sort(Mn)}function ue(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function ee(e,t){var n=Object.create(null);for(var r in e){var i=t&&t[r];if(void 0===i){var o=e[r];if(!o.hasDefault)throw new RangeError("No value supplied for attribute "+r);i=o.default}n[r]=i}return n}function pn(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new no(e[n]);return t}Gi.next.get=function(){return this.tokens[this.pos]},Ie.prototype.eat=function(t){return this.next==t&&(this.pos++||!0)},Ie.prototype.err=function(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")},Object.defineProperties(Ie.prototype,Gi);var qt=function(t,n,r){this.name=t,this.schema=n,this.spec=r,this.groups=r.group?r.group.split(" "):[],this.attrs=pn(r.attrs),this.defaultAttrs=ue(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(r.inline||"text"==t),this.isText="text"==t},Je={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0},whitespace:{configurable:!0}};Je.isInline.get=function(){return!this.isBlock},Je.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Je.isLeaf.get=function(){return this.contentMatch==rt.empty},Je.isAtom.get=function(){return this.isLeaf||this.spec.atom},Je.whitespace.get=function(){return this.spec.whitespace||(this.spec.code?"pre":"normal")},qt.prototype.hasRequiredAttrs=function(){for(var t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1},qt.prototype.compatibleContent=function(t){return this==t||this.contentMatch.compatible(t.contentMatch)},qt.prototype.computeAttrs=function(t){return!t&&this.defaultAttrs?this.defaultAttrs:ee(this.attrs,t)},qt.prototype.create=function(t,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Q(this,this.computeAttrs(t),R.from(n),st.setFrom(r))},qt.prototype.createChecked=function(t,n,r){if(n=R.from(n),!this.validContent(n))throw new RangeError("Invalid content for node "+this.name);return new Q(this,this.computeAttrs(t),n,st.setFrom(r))},qt.prototype.createAndFill=function(t,n,r){if(t=this.computeAttrs(t),(n=R.from(n)).size){var i=this.contentMatch.fillBefore(n);if(!i)return null;n=i.append(n)}var o=this.contentMatch.matchFragment(n).fillBefore(R.empty,!0);return o?new Q(this,t,n.append(o),st.setFrom(r)):null},qt.prototype.validContent=function(t){var n=this.contentMatch.matchFragment(t);if(!n||!n.validEnd)return!1;for(var r=0;r<t.childCount;r++)if(!this.allowsMarks(t.child(r).marks))return!1;return!0},qt.prototype.allowsMarkType=function(t){return null==this.markSet||this.markSet.indexOf(t)>-1},qt.prototype.allowsMarks=function(t){if(null==this.markSet)return!0;for(var n=0;n<t.length;n++)if(!this.allowsMarkType(t[n].type))return!1;return!0},qt.prototype.allowedMarks=function(t){if(null==this.markSet)return t;for(var n,r=0;r<t.length;r++)this.allowsMarkType(t[r].type)?n&&n.push(t[r]):n||(n=t.slice(0,r));return n?n.length?n:st.empty:t},qt.compile=function(t,n){var r=Object.create(null);t.forEach(function(s,c){return r[s]=new qt(s,n,c)});var i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(var o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r},Object.defineProperties(qt.prototype,Je);var no=function(t){this.hasDefault=Object.prototype.hasOwnProperty.call(t,"default"),this.default=t.default},ui={isRequired:{configurable:!0}};ui.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(no.prototype,ui);var Re=function(t,n,r,i){this.name=t,this.schema=r,this.spec=i,this.attrs=pn(i.attrs),this.rank=n,this.excluded=null;var o=ue(this.attrs);this.instance=o&&new st(this,o)};Re.prototype.create=function(t){return!t&&this.instance?this.instance:new st(this,ee(this.attrs,t))},Re.compile=function(t,n){var r=Object.create(null),i=0;return t.forEach(function(o,s){return r[o]=new Re(o,i++,n,s)}),r},Re.prototype.removeFromSet=function(t){for(var n=0;n<t.length;n++)t[n].type==this&&(t=t.slice(0,n).concat(t.slice(n+1)),n--);return t},Re.prototype.isInSet=function(t){for(var n=0;n<t.length;n++)if(t[n].type==this)return t[n]},Re.prototype.excludes=function(t){return this.excluded.indexOf(t)>-1};var be=function(t){for(var n in this.spec={},t)this.spec[n]=t[n];this.spec.nodes=ti.from(t.nodes),this.spec.marks=ti.from(t.marks),this.nodes=qt.compile(this.spec.nodes,this),this.marks=Re.compile(this.spec.marks,this);var r=Object.create(null);for(var i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");var o=this.nodes[i],s=o.spec.content||"",c=o.spec.marks;o.contentMatch=r[s]||(r[s]=rt.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==c?null:c?ro(this,c.split(" ")):""!=c&&o.inlineContent?null:[]}for(var l in this.marks){var u=this.marks[l],p=u.spec.excludes;u.excluded=null==p?[u]:""==p?[]:ro(this,p.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function ro(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r],o=e.marks[i],s=o;if(o)n.push(o);else for(var c in e.marks){var l=e.marks[c];("_"==i||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&n.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}be.prototype.node=function(t,n,r,i){if("string"==typeof t)t=this.nodeType(t);else{if(!(t instanceof qt))throw new RangeError("Invalid node type: "+t);if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}return t.createChecked(n,r,i)},be.prototype.text=function(t,n){var r=this.nodes.text;return new Xi(r,r.defaultAttrs,t,st.setFrom(n))},be.prototype.mark=function(t,n){return"string"==typeof t&&(t=this.marks[t]),t.create(n)},be.prototype.nodeFromJSON=function(t){return Q.fromJSON(this,t)},be.prototype.markFromJSON=function(t){return st.fromJSON(this,t)},be.prototype.nodeType=function(t){var n=this.nodes[t];if(!n)throw new RangeError("Unknown node type: "+t);return n};var Yt=function(t,n){var r=this;this.schema=t,this.rules=n,this.tags=[],this.styles=[],n.forEach(function(i){i.tag?r.tags.push(i):i.style&&r.styles.push(i)}),this.normalizeLists=!this.tags.some(function(i){if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;var o=t.nodes[i.node];return o.contentMatch.matchType(o)})};Yt.prototype.parse=function(t,n){void 0===n&&(n={});var r=new vt(this,n,!1);return r.addAll(t,null,n.from,n.to),r.finish()},Yt.prototype.parseSlice=function(t,n){void 0===n&&(n={});var r=new vt(this,n,!0);return r.addAll(t,null,n.from,n.to),V.maxOpen(r.finish())},Yt.prototype.matchTag=function(t,n,r){for(var i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){var o=this.tags[i];if(ps(t,o.tag)&&(void 0===o.namespace||t.namespaceURI==o.namespace)&&(!o.context||n.matchesContext(o.context))){if(o.getAttrs){var s=o.getAttrs(t);if(!1===s)continue;o.attrs=s}return o}}},Yt.prototype.matchStyle=function(t,n,r,i){for(var o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){var s=this.styles[o];if(!(0!=s.style.indexOf(t)||s.context&&!r.matchesContext(s.context)||s.style.length>t.length&&(61!=s.style.charCodeAt(t.length)||s.style.slice(t.length+1)!=n))){if(s.getAttrs){var c=s.getAttrs(n);if(!1===c)continue;s.attrs=c}return s}}},Yt.schemaRules=function(t){var n=[];function r(l){for(var u=null==l.priority?50:l.priority,p=0;p<n.length;p++){var f=n[p];if((null==f.priority?50:f.priority)<u)break}n.splice(p,0,l)}var u,i=function(l){var u=t.marks[l].spec.parseDOM;u&&u.forEach(function(p){r(p=so(p)),p.mark=l})};for(var o in t.marks)i(o);for(var c in t.nodes)u=void 0,(u=t.nodes[c].spec.parseDOM)&&u.forEach(function(p){r(p=so(p)),p.node=c});return n},Yt.fromSchema=function(t){return t.cached.domParser||(t.cached.domParser=new Yt(t,Yt.schemaRules(t)))};var pi={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Ue={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},io={ol:!0,ul:!0};function oo(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}var Ze=function(t,n,r,i,o,s,c){this.type=t,this.attrs=n,this.solid=o,this.match=s||(4&c?null:t.contentMatch),this.options=c,this.content=[],this.marks=r,this.activeMarks=st.none,this.pendingMarks=i,this.stashMarks=[]};Ze.prototype.findWrapping=function(t){if(!this.match){if(!this.type)return[];var n=this.type.contentMatch.fillBefore(R.from(t));if(!n){var i,r=this.type.contentMatch;return(i=r.findWrapping(t.type))?(this.match=r,i):null}this.match=this.type.contentMatch.matchFragment(n)}return this.match.findWrapping(t.type)},Ze.prototype.finish=function(t){if(!(1&this.options)){var r,n=this.content[this.content.length-1];n&&n.isText&&(r=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==r[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-r[0].length)))}var i=R.from(this.content);return!t&&this.match&&(i=i.append(this.match.fillBefore(R.empty,!0))),this.type?this.type.create(this.attrs,i,this.marks):i},Ze.prototype.popFromStashMark=function(t){for(var n=this.stashMarks.length-1;n>=0;n--)if(t.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]},Ze.prototype.applyPending=function(t){for(var n=0,r=this.pendingMarks;n<r.length;n++){var i=r[n];(this.type?this.type.allowsMarkType(i.type):ds(i.type,t))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}},Ze.prototype.inlineContext=function(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!pi.hasOwnProperty(t.parentNode.nodeName.toLowerCase())};var vt=function(t,n,r){this.parser=t,this.options=n,this.isOpen=r;var o,i=n.topNode,s=oo(null,n.preserveWhitespace,0)|(r?4:0);o=i?new Ze(i.type,i.attrs,st.none,st.none,!0,n.topMatch||i.type.contentMatch,s):new Ze(r?null:t.schema.topNodeType,null,st.none,st.none,!0,null,s),this.nodes=[o],this.open=0,this.find=n.findPositions,this.needsBlock=!1},fi={top:{configurable:!0},currentPos:{configurable:!0}};function ps(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function so(e){var t={};for(var n in e)t[n]=e[n];return t}function ds(e,t){var n=t.schema.nodes,r=function(s){var c=n[s];if(c.allowsMarkType(e)){var l=[],u=function(p){l.push(p);for(var f=0;f<p.edgeCount;f++){var d=p.edge(f),y=d.next;if(d.type==t||l.indexOf(y)<0&&u(y))return!0}};if(u(c.contentMatch))return{v:!0}}};for(var i in n){var o=r(i);if(o)return o.v}}fi.top.get=function(){return this.nodes[this.open]},vt.prototype.addDOM=function(t){if(3==t.nodeType)this.addTextNode(t);else if(1==t.nodeType){var n=t.getAttribute("style"),r=n?this.readStyles(function fs(e){for(var n,t=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];n=t.exec(e);)r.push(n[1],n[2].trim());return r}(n)):null,i=this.top;if(null!=r)for(var o=0;o<r.length;o++)this.addPendingMark(r[o]);if(this.addElement(t),null!=r)for(var s=0;s<r.length;s++)this.removePendingMark(r[s],i)}},vt.prototype.addTextNode=function(t){var n=t.nodeValue,r=this.top;if(2&r.options||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(n)){if(1&r.options)n=2&r.options?n.replace(/\r\n?/g,"\n"):n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){var i=r.content[r.content.length-1],o=t.previousSibling;(!i||o&&"BR"==o.nodeName||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(t)}else this.findInside(t)},vt.prototype.addElement=function(t,n){var i,r=t.nodeName.toLowerCase();io.hasOwnProperty(r)&&this.parser.normalizeLists&&function us(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=1==t.nodeType?t.nodeName.toLowerCase():null;r&&io.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):"li"==r?n=t:r&&(n=null)}}(t);var o=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(i=this.parser.matchTag(t,this,n));if(o?o.ignore:Ue.hasOwnProperty(r))this.findInside(t),this.ignoreFallback(t);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(t=o.skip);var s,c=this.top,l=this.needsBlock;if(pi.hasOwnProperty(r))s=!0,c.type||(this.needsBlock=!0);else if(!t.firstChild)return void this.leafFallback(t);this.addAll(t),s&&this.sync(c),this.needsBlock=l}else this.addElementByRule(t,o,!1===o.consuming?i:null)},vt.prototype.leafFallback=function(t){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"))},vt.prototype.ignoreFallback=function(t){"BR"==t.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))},vt.prototype.readStyles=function(t){var n=st.none;t:for(var r=0;r<t.length;r+=2)for(var i=null;;){var o=this.parser.matchStyle(t[r],t[r+1],this,i);if(!o)continue t;if(o.ignore)return null;if(n=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(n),!1!==o.consuming)break;i=o}return n},vt.prototype.addElementByRule=function(t,n,r){var o,s,l,i=this;n.node?(s=this.parser.schema.nodes[n.node]).isLeaf?this.insertNode(s.create(n.attrs))||this.leafFallback(t):o=this.enter(s,n.attrs,n.preserveWhitespace):(l=this.parser.schema.marks[n.mark].create(n.attrs),this.addPendingMark(l));var u=this.top;if(s&&s.isLeaf)this.findInside(t);else if(r)this.addElement(t,r);else if(n.getContent)this.findInside(t),n.getContent(t,this.parser.schema).forEach(function(f){return i.insertNode(f)});else{var p=n.contentElement;"string"==typeof p?p=t.querySelector(p):"function"==typeof p&&(p=p(t)),p||(p=t),this.findAround(t,p,!0),this.addAll(p,o)}o&&(this.sync(u),this.open--),l&&this.removePendingMark(l,u)},vt.prototype.addAll=function(t,n,r,i){for(var o=r||0,s=r?t.childNodes[r]:t.firstChild,c=null==i?null:t.childNodes[i];s!=c;s=s.nextSibling,++o)this.findAtPoint(t,o),this.addDOM(s),n&&pi.hasOwnProperty(s.nodeName.toLowerCase())&&this.sync(n);this.findAtPoint(t,o)},vt.prototype.findPlace=function(t){for(var n,r,i=this.open;i>=0;i--){var o=this.nodes[i],s=o.findWrapping(t);if(s&&(!n||n.length>s.length)&&(n=s,r=o,!s.length)||o.solid)break}if(!n)return!1;this.sync(r);for(var c=0;c<n.length;c++)this.enterInner(n[c],null,!1);return!0},vt.prototype.insertNode=function(t){if(t.isInline&&this.needsBlock&&!this.top.type){var n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(t)){this.closeExtra();var r=this.top;r.applyPending(t.type),r.match&&(r.match=r.match.matchType(t.type));for(var i=r.activeMarks,o=0;o<t.marks.length;o++)(!r.type||r.type.allowsMarkType(t.marks[o].type))&&(i=t.marks[o].addToSet(i));return r.content.push(t.mark(i)),!0}return!1},vt.prototype.enter=function(t,n,r){var i=this.findPlace(t.create(n));return i&&this.enterInner(t,n,!0,r),i},vt.prototype.enterInner=function(t,n,r,i){this.closeExtra();var o=this.top;o.applyPending(t),o.match=o.match&&o.match.matchType(t,n);var s=oo(t,i,o.options);4&o.options&&0==o.content.length&&(s|=4),this.nodes.push(new Ze(t,n,o.activeMarks,o.pendingMarks,r,null,s)),this.open++},vt.prototype.closeExtra=function(t){var n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(t));this.nodes.length=this.open+1}},vt.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},vt.prototype.sync=function(t){for(var n=this.open;n>=0;n--)if(this.nodes[n]==t)return void(this.open=n)},fi.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e},vt.prototype.findAtPoint=function(t,n){if(this.find)for(var r=0;r<this.find.length;r++)this.find[r].node==t&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)},vt.prototype.findInside=function(t){if(this.find)for(var n=0;n<this.find.length;n++)null==this.find[n].pos&&1==t.nodeType&&t.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)},vt.prototype.findAround=function(t,n,r){if(t!=n&&this.find)for(var i=0;i<this.find.length;i++)null==this.find[i].pos&&1==t.nodeType&&t.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)},vt.prototype.findInText=function(t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==t&&(this.find[n].pos=this.currentPos-(t.nodeValue.length-this.find[n].offset))},vt.prototype.matchesContext=function(t){var n=this;if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);var r=t.split("/"),i=this.options.context,o=!(this.isOpen||i&&i.parent.type!=this.nodes[0].type),s=(o?0:1)-(i?i.depth+1:0),c=function(l,u){for(;l>=0;l--){var p=r[l];if(""==p){if(l==r.length-1||0==l)continue;for(;u>=s;u--)if(c(l-1,u))return!0;return!1}var f=u>0||0==u&&o?n.nodes[u].type:i&&u>=s?i.node(u-s).type:null;if(!f||f.name!=p&&-1==f.groups.indexOf(p))return!1;u--}return!0};return c(r.length-1,this.open)},vt.prototype.textblockFromContext=function(){var t=this.options.context;if(t)for(var n=t.depth;n>=0;n--){var r=t.node(n).contentMatchAt(t.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(var i in this.parser.schema.nodes){var o=this.parser.schema.nodes[i];if(o.isTextblock&&o.defaultAttrs)return o}},vt.prototype.addPendingMark=function(t){var n=function hs(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(t,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=t.addToSet(this.top.pendingMarks)},vt.prototype.removePendingMark=function(t,n){for(var r=this.open;r>=0;r--){var i=this.nodes[r];if(i.pendingMarks.lastIndexOf(t)>-1)i.pendingMarks=t.removeFromSet(i.pendingMarks);else{i.activeMarks=t.removeFromSet(i.activeMarks);var s=i.popFromStashMark(t);s&&i.type&&i.type.allowsMarkType(s.type)&&(i.activeMarks=s.addToSet(i.activeMarks))}if(i==n)break}},Object.defineProperties(vt.prototype,fi);var Rt=function(t,n){this.nodes=t||{},this.marks=n||{}};function ao(e){var t={};for(var n in e){var r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function Mr(e){return e.document||window.document}Rt.prototype.serializeFragment=function(t,n,r){var i=this;void 0===n&&(n={}),r||(r=Mr(n).createDocumentFragment());var o=r,s=null;return t.forEach(function(c){if(s||c.marks.length){s||(s=[]);for(var l=0,u=0;l<s.length&&u<c.marks.length;){var p=c.marks[u];if(i.marks[p.type.name]){if(!p.eq(s[l])||!1===p.type.spec.spanning)break;l+=2,u++}else u++}for(;l<s.length;)o=s.pop(),s.pop();for(;u<c.marks.length;){var f=c.marks[u++],d=i.serializeMark(f,c.isInline,n);d&&(s.push(f,o),o.appendChild(d.dom),o=d.contentDOM||d.dom)}}o.appendChild(i.serializeNodeInner(c,n))}),r},Rt.prototype.serializeNodeInner=function(t,n){void 0===n&&(n={});var r=Rt.renderSpec(Mr(n),this.nodes[t.type.name](t)),i=r.dom,o=r.contentDOM;if(o){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");n.onContent?n.onContent(t,o,n):this.serializeFragment(t.content,n,o)}return i},Rt.prototype.serializeNode=function(t,n){void 0===n&&(n={});for(var r=this.serializeNodeInner(t,n),i=t.marks.length-1;i>=0;i--){var o=this.serializeMark(t.marks[i],t.isInline,n);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r},Rt.prototype.serializeMark=function(t,n,r){void 0===r&&(r={});var i=this.marks[t.type.name];return i&&Rt.renderSpec(Mr(r),i(t,n))},Rt.renderSpec=function(t,n,r){if(void 0===r&&(r=null),"string"==typeof n)return{dom:t.createTextNode(n)};if(null!=n.nodeType)return{dom:n};if(n.dom&&null!=n.dom.nodeType)return n;var i=n[0],o=i.indexOf(" ");o>0&&(r=i.slice(0,o),i=i.slice(o+1));var s=null,c=r?t.createElementNS(r,i):t.createElement(i),l=n[1],u=1;if(l&&"object"==typeof l&&null==l.nodeType&&!Array.isArray(l))for(var p in u=2,l)if(null!=l[p]){var f=p.indexOf(" ");f>0?c.setAttributeNS(p.slice(0,f),p.slice(f+1),l[p]):c.setAttribute(p,l[p])}for(var d=u;d<n.length;d++){var g=n[d];if(0===g){if(d<n.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:c,contentDOM:c}}var y=Rt.renderSpec(t,g,r),C=y.contentDOM;if(c.appendChild(y.dom),C){if(s)throw new RangeError("Multiple content holes");s=C}}return{dom:c,contentDOM:s}},Rt.fromSchema=function(t){return t.cached.domSerializer||(t.cached.domSerializer=new Rt(this.nodesFromSchema(t),this.marksFromSchema(t)))},Rt.nodesFromSchema=function(t){var n=ao(t.nodes);return n.text||(n.text=function(r){return r.text}),n},Rt.marksFromSchema=function(t){return ao(t.marks)};var h=Math.pow(2,16);function v(e,t){return e+t*h}function m(e){return 65535&e}var w=function(t,n,r){void 0===n&&(n=!1),void 0===r&&(r=null),this.pos=t,this.deleted=n,this.recover=r},T=function e(t,n){if(void 0===n&&(n=!1),!t.length&&e.empty)return e.empty;this.ranges=t,this.inverted=n};T.prototype.recover=function(t){var n=0,r=m(t);if(!this.inverted)for(var i=0;i<r;i++)n+=this.ranges[3*i+2]-this.ranges[3*i+1];return this.ranges[3*r]+n+function S(e){return(e-(65535&e))/h}(t)},T.prototype.mapResult=function(t,n){return void 0===n&&(n=1),this._map(t,n,!1)},T.prototype.map=function(t,n){return void 0===n&&(n=1),this._map(t,n,!0)},T.prototype._map=function(t,n,r){for(var i=0,o=this.inverted?2:1,s=this.inverted?1:2,c=0;c<this.ranges.length;c+=3){var l=this.ranges[c]-(this.inverted?i:0);if(l>t)break;var u=this.ranges[c+o],p=this.ranges[c+s],f=l+u;if(t<=f){var g=l+i+((u?t==l?-1:t==f?1:n:n)<0?0:p);if(r)return g;var y=t==(n<0?l:f)?null:v(c/3,t-l);return new w(g,n<0?t!=l:t!=f,y)}i+=p-u}return r?t+i:new w(t+i)},T.prototype.touches=function(t,n){for(var r=0,i=m(n),o=this.inverted?2:1,s=this.inverted?1:2,c=0;c<this.ranges.length;c+=3){var l=this.ranges[c]-(this.inverted?r:0);if(l>t)break;var u=this.ranges[c+o];if(t<=l+u&&c==3*i)return!0;r+=this.ranges[c+s]-u}return!1},T.prototype.forEach=function(t){for(var n=this.inverted?2:1,r=this.inverted?1:2,i=0,o=0;i<this.ranges.length;i+=3){var s=this.ranges[i],c=s-(this.inverted?o:0),l=s+(this.inverted?0:o),u=this.ranges[i+n],p=this.ranges[i+r];t(c,c+u,l,l+p),o+=p-u}},T.prototype.invert=function(){return new T(this.ranges,!this.inverted)},T.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},T.offset=function(t){return 0==t?T.empty:new T(t<0?[0,-t,0]:[0,0,t])},T.empty=new T([]);var O=function(t,n,r,i){this.maps=t||[],this.from=r||0,this.to=null==i?this.maps.length:i,this.mirror=n};function F(e){var t=Error.call(this,e);return t.__proto__=F.prototype,t}O.prototype.slice=function(t,n){return void 0===t&&(t=0),void 0===n&&(n=this.maps.length),new O(this.maps,this.mirror,t,n)},O.prototype.copy=function(){return new O(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},O.prototype.appendMap=function(t,n){this.to=this.maps.push(t),null!=n&&this.setMirror(this.maps.length-1,n)},O.prototype.appendMapping=function(t){for(var n=0,r=this.maps.length;n<t.maps.length;n++){var i=t.getMirror(n);this.appendMap(t.maps[n],null!=i&&i<n?r+i:null)}},O.prototype.getMirror=function(t){if(this.mirror)for(var n=0;n<this.mirror.length;n++)if(this.mirror[n]==t)return this.mirror[n+(n%2?-1:1)]},O.prototype.setMirror=function(t,n){this.mirror||(this.mirror=[]),this.mirror.push(t,n)},O.prototype.appendMappingInverted=function(t){for(var n=t.maps.length-1,r=this.maps.length+t.maps.length;n>=0;n--){var i=t.getMirror(n);this.appendMap(t.maps[n].invert(),null!=i&&i>n?r-i-1:null)}},O.prototype.invert=function(){var t=new O;return t.appendMappingInverted(this),t},O.prototype.map=function(t,n){if(void 0===n&&(n=1),this.mirror)return this._map(t,n,!0);for(var r=this.from;r<this.to;r++)t=this.maps[r].map(t,n);return t},O.prototype.mapResult=function(t,n){return void 0===n&&(n=1),this._map(t,n,!1)},O.prototype._map=function(t,n,r){for(var i=!1,o=this.from;o<this.to;o++){var c=this.maps[o].mapResult(t,n);if(null!=c.recover){var l=this.getMirror(o);if(null!=l&&l>o&&l<this.to){o=l,t=this.maps[l].recover(c.recover);continue}}c.deleted&&(i=!0),t=c.pos}return r?t:new w(t,i)},(F.prototype=Object.create(Error.prototype)).constructor=F,F.prototype.name="TransformError";var A=function(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new O},N={before:{configurable:!0},docChanged:{configurable:!0}};function E(){throw new Error("Override me")}N.before.get=function(){return this.docs.length?this.docs[0]:this.doc},A.prototype.step=function(t){var n=this.maybeStep(t);if(n.failed)throw new F(n.failed);return this},A.prototype.maybeStep=function(t){var n=t.apply(this.doc);return n.failed||this.addStep(t,n.doc),n},N.docChanged.get=function(){return this.steps.length>0},A.prototype.addStep=function(t,n){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=n},Object.defineProperties(A.prototype,N);var L=Object.create(null),Y=function(){};Y.prototype.apply=function(t){return E()},Y.prototype.getMap=function(){return T.empty},Y.prototype.invert=function(t){return E()},Y.prototype.map=function(t){return E()},Y.prototype.merge=function(t){return null},Y.prototype.toJSON=function(){return E()},Y.fromJSON=function(t,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");var r=L[n.stepType];if(!r)throw new RangeError("No step type "+n.stepType+" defined");return r.fromJSON(t,n)},Y.jsonID=function(t,n){if(t in L)throw new RangeError("Duplicate use of step JSON ID "+t);return L[t]=n,n.prototype.jsonID=t,n};var K=function(t,n){this.doc=t,this.failed=n};K.ok=function(t){return new K(t,null)},K.fail=function(t){return new K(null,t)},K.fromReplace=function(t,n,r,i){try{return K.ok(t.replace(n,r,i))}catch(o){if(o instanceof ge)return K.fail(o.message);throw o}};var ut=function(e){function t(n,r,i,o){e.call(this),this.from=n,this.to=r,this.slice=i,this.structure=!!o}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.apply=function(r){return this.structure&&kt(r,this.from,this.to)?K.fail("Structure replace would overwrite content"):K.fromReplace(r,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new T([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(r){return new t(this.from,this.from+this.slice.size,r.slice(this.from,this.to))},t.prototype.map=function(r){var i=r.mapResult(this.from,1),o=r.mapResult(this.to,-1);return i.deleted&&o.deleted?null:new t(i.pos,Math.max(i.pos,o.pos),this.slice)},t.prototype.merge=function(r){if(!(r instanceof t)||r.structure||this.structure)return null;if(this.from+this.slice.size!=r.from||this.slice.openEnd||r.slice.openStart){if(r.to!=this.from||this.slice.openStart||r.slice.openEnd)return null;var o=this.slice.size+r.slice.size==0?V.empty:new V(r.slice.content.append(this.slice.content),r.slice.openStart,this.slice.openEnd);return new t(r.from,this.to,o,this.structure)}var i=this.slice.size+r.slice.size==0?V.empty:new V(this.slice.content.append(r.slice.content),this.slice.openStart,r.slice.openEnd);return new t(this.from,this.to+(r.to-r.from),i,this.structure)},t.prototype.toJSON=function(){var r={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(r.slice=this.slice.toJSON()),this.structure&&(r.structure=!0),r},t.fromJSON=function(r,i){if("number"!=typeof i.from||"number"!=typeof i.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(i.from,i.to,V.fromJSON(r,i.slice),!!i.structure)},t}(Y);Y.jsonID("replace",ut);var $=function(e){function t(n,r,i,o,s,c,l){e.call(this),this.from=n,this.to=r,this.gapFrom=i,this.gapTo=o,this.slice=s,this.insert=c,this.structure=!!l}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.apply=function(r){if(this.structure&&(kt(r,this.from,this.gapFrom)||kt(r,this.gapTo,this.to)))return K.fail("Structure gap-replace would overwrite content");var i=r.slice(this.gapFrom,this.gapTo);if(i.openStart||i.openEnd)return K.fail("Gap is not a flat range");var o=this.slice.insertAt(this.insert,i.content);return o?K.fromReplace(r,this.from,this.to,o):K.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new T([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(r){var i=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+i,this.from+this.insert,this.from+this.insert+i,r.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(r){var i=r.mapResult(this.from,1),o=r.mapResult(this.to,-1),s=r.map(this.gapFrom,-1),c=r.map(this.gapTo,1);return i.deleted&&o.deleted||s<i.pos||c>o.pos?null:new t(i.pos,o.pos,s,c,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var r={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(r.slice=this.slice.toJSON()),this.structure&&(r.structure=!0),r},t.fromJSON=function(r,i){if("number"!=typeof i.from||"number"!=typeof i.to||"number"!=typeof i.gapFrom||"number"!=typeof i.gapTo||"number"!=typeof i.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(i.from,i.to,i.gapFrom,i.gapTo,V.fromJSON(r,i.slice),i.insert,!!i.structure)},t}(Y);function kt(e,t,n){for(var r=e.resolve(t),i=n-t,o=r.depth;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0)for(var s=r.node(o).maybeChild(r.indexAfter(o));i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}return!1}function Dt(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function bt(e){for(var n=e.parent.content.cutByIndex(e.startIndex,e.endIndex),r=e.depth;;--r){var i=e.$from.node(r),o=e.$from.index(r),s=e.$to.indexAfter(r);if(r<e.depth&&i.canReplace(o,s,n))return r;if(0==r||i.type.spec.isolating||!Dt(i,o,s))break}}function _e(e,t,n,r){void 0===r&&(r=e);var i=function z(e,t){var n=e.parent,r=e.startIndex,i=e.endIndex,o=n.contentMatchAt(r).findWrapping(t);return o&&n.canReplaceWith(r,i,o.length?o[0]:t)?o:null}(e,t),o=i&&function ht(e,t){var n=e.parent,r=e.startIndex,i=e.endIndex,o=n.child(r),s=t.contentMatch.findWrapping(o.type);if(!s)return null;for(var l=(s.length?s[s.length-1]:t).contentMatch,u=r;l&&u<i;u++)l=l.matchType(n.child(u).type);return l&&l.validEnd?s:null}(r,t);return o?i.map(Kt).concat({type:t,attrs:n}).concat(o.map(Kt)):null}function Kt(e){return{type:e,attrs:null}}function Mt(e,t,n,r){void 0===n&&(n=1);var i=e.resolve(t),o=i.depth-n,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(var c=i.depth-1,l=n-2;c>o;c--,l--){var u=i.node(c),p=i.index(c);if(u.type.spec.isolating)return!1;var f=u.content.cutByIndex(p,u.childCount),d=r&&r[l]||u;if(d!=u&&(f=f.replaceChild(0,d.type.create(d.attrs))),!u.canReplace(p+1,u.childCount)||!d.type.validContent(f))return!1}var g=i.indexAfter(o),y=r&&r[0];return i.node(o).canReplaceWith(g,g,y?y.type:i.node(o+1).type)}function ne(e,t){var n=e.resolve(t),r=n.index();return function je(e,t){return e&&t&&!e.isLeaf&&e.canAppend(t)}(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function xe(e,t,n){var r=e.resolve(t);if(!n.content.size)return t;for(var i=n.content,o=0;o<n.openStart;o++)i=i.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var c=r.depth;c>=0;c--){var l=c==r.depth?0:r.pos<=(r.start(c+1)+r.end(c+1))/2?-1:1,u=r.index(c)+(l>0?1:0),p=r.node(c),f=!1;if(1==s)f=p.canReplace(u,u,i);else{var d=p.contentMatchAt(u).findWrapping(i.firstChild.type);f=d&&p.canReplaceWith(u,u,d[0])}if(f)return 0==l?r.pos:l<0?r.before(c+1):r.after(c+1)}return null}function Bt(e,t,n){for(var r=[],i=0;i<e.childCount;i++){var o=e.child(i);o.content.size&&(o=o.copy(Bt(o.content,t,o))),o.isInline&&(o=t(o,n,i)),r.push(o)}return R.fromArray(r)}Y.jsonID("replaceAround",$),A.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,i=e.depth,o=n.before(i+1),s=r.after(i+1),c=o,l=s,u=R.empty,p=0,f=i,d=!1;f>t;f--)d||n.index(f)>0?(d=!0,u=R.from(n.node(f).copy(u)),p++):c--;for(var g=R.empty,y=0,_=i,C=!1;_>t;_--)C||r.after(_+1)<r.end(_)?(C=!0,g=R.from(r.node(_).copy(g)),y++):l++;return this.step(new $(c,l,o,s,new V(u.append(g),p,y),u.size-p,!0))},A.prototype.wrap=function(e,t){for(var n=R.empty,r=t.length-1;r>=0;r--){if(n.size){var i=t[r].type.contentMatch.matchFragment(n);if(!i||!i.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=R.from(t[r].type.create(t[r].attrs,n))}var o=e.start,s=e.end;return this.step(new $(o,s,o,s,new V(n,0,0),t.length,!0))},A.prototype.setBlockType=function(e,t,n,r){var i=this;if(void 0===t&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var o=this.steps.length;return this.doc.nodesBetween(e,t,function(s,c){if(s.isTextblock&&!s.hasMarkup(n,r)&&function Ot(e,t,n){var r=e.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}(i.doc,i.mapping.slice(o).map(c),n)){i.clearIncompatible(i.mapping.slice(o).map(c,1),n);var l=i.mapping.slice(o),u=l.map(c,1),p=l.map(c+s.nodeSize,1);return i.step(new $(u,p,u+1,p-1,new V(R.from(n.create(r,null,s.marks)),0,0),1,!0)),!1}}),this},A.prototype.setNodeMarkup=function(e,t,n,r){var i=this.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);var o=t.create(n,null,r||i.marks);if(i.isLeaf)return this.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new $(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new V(R.from(o),0,0),1,!0))},A.prototype.split=function(e,t,n){void 0===t&&(t=1);for(var r=this.doc.resolve(e),i=R.empty,o=R.empty,s=r.depth,c=r.depth-t,l=t-1;s>c;s--,l--){i=R.from(r.node(s).copy(i));var u=n&&n[l];o=R.from(u?u.type.create(u.attrs,o):r.node(s).copy(o))}return this.step(new ut(e,e,new V(i.append(o),t,t),!0))},A.prototype.join=function(e,t){void 0===t&&(t=1);var n=new ut(e-t,e+t,V.empty,!0);return this.step(n)};var qe=function(e){function t(n,r,i){e.call(this),this.from=n,this.to=r,this.mark=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.apply=function(r){var i=this,o=r.slice(this.from,this.to),s=r.resolve(this.from),c=s.node(s.sharedDepth(this.to)),l=new V(Bt(o.content,function(u,p){return u.isAtom&&p.type.allowsMarkType(i.mark.type)?u.mark(i.mark.addToSet(u.marks)):u},c),o.openStart,o.openEnd);return K.fromReplace(r,this.from,this.to,l)},t.prototype.invert=function(){return new Ye(this.from,this.to,this.mark)},t.prototype.map=function(r){var i=r.mapResult(this.from,1),o=r.mapResult(this.to,-1);return i.deleted&&o.deleted||i.pos>=o.pos?null:new t(i.pos,o.pos,this.mark)},t.prototype.merge=function(r){if(r instanceof t&&r.mark.eq(this.mark)&&this.from<=r.to&&this.to>=r.from)return new t(Math.min(this.from,r.from),Math.max(this.to,r.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(r,i){if("number"!=typeof i.from||"number"!=typeof i.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(i.from,i.to,r.markFromJSON(i.mark))},t}(Y);Y.jsonID("addMark",qe);var Ye=function(e){function t(n,r,i){e.call(this),this.from=n,this.to=r,this.mark=i}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.apply=function(r){var i=this,o=r.slice(this.from,this.to),s=new V(Bt(o.content,function(c){return c.mark(i.mark.removeFromSet(c.marks))}),o.openStart,o.openEnd);return K.fromReplace(r,this.from,this.to,s)},t.prototype.invert=function(){return new qe(this.from,this.to,this.mark)},t.prototype.map=function(r){var i=r.mapResult(this.from,1),o=r.mapResult(this.to,-1);return i.deleted&&o.deleted||i.pos>=o.pos?null:new t(i.pos,o.pos,this.mark)},t.prototype.merge=function(r){if(r instanceof t&&r.mark.eq(this.mark)&&this.from<=r.to&&this.to>=r.from)return new t(Math.min(this.from,r.from),Math.max(this.to,r.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(r,i){if("number"!=typeof i.from||"number"!=typeof i.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(i.from,i.to,r.markFromJSON(i.mark))},t}(Y);function er(e,t,n,r){if(void 0===n&&(n=t),void 0===r&&(r=V.empty),t==n&&!r.size)return null;var i=e.resolve(t),o=e.resolve(n);return Or(i,o,r)?new ut(t,n,r):new re(i,o,r).fit()}function Or(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}Y.jsonID("removeMark",Ye),A.prototype.addMark=function(e,t,n){var r=this,i=[],o=[],s=null,c=null;return this.doc.nodesBetween(e,t,function(l,u,p){if(l.isInline){var f=l.marks;if(!n.isInSet(f)&&p.type.allowsMarkType(n.type)){for(var d=Math.max(u,e),g=Math.min(u+l.nodeSize,t),y=n.addToSet(f),_=0;_<f.length;_++)f[_].isInSet(y)||(s&&s.to==d&&s.mark.eq(f[_])?s.to=g:i.push(s=new Ye(d,g,f[_])));c&&c.to==d?c.to=g:o.push(c=new qe(d,g,n))}}}),i.forEach(function(l){return r.step(l)}),o.forEach(function(l){return r.step(l)}),this},A.prototype.removeMark=function(e,t,n){var r=this;void 0===n&&(n=null);var i=[],o=0;return this.doc.nodesBetween(e,t,function(s,c){if(s.isInline){o++;var l=null;if(n instanceof Re)for(var p,u=s.marks;p=n.isInSet(u);)(l||(l=[])).push(p),u=p.removeFromSet(u);else n?n.isInSet(s.marks)&&(l=[n]):l=s.marks;if(l&&l.length)for(var f=Math.min(c+s.nodeSize,t),d=0;d<l.length;d++){for(var g=l[d],y=void 0,_=0;_<i.length;_++){var C=i[_];C.step==o-1&&g.eq(i[_].style)&&(y=C)}y?(y.to=f,y.step=o):i.push({style:g,from:Math.max(c,e),to:f,step:o})}}}),i.forEach(function(s){return r.step(new Ye(s.from,s.to,s.style))}),this},A.prototype.clearIncompatible=function(e,t,n){void 0===n&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),i=[],o=e+1,s=0;s<r.childCount;s++){var c=r.child(s),l=o+c.nodeSize,u=n.matchType(c.type,c.attrs);if(u){n=u;for(var p=0;p<c.marks.length;p++)t.allowsMarkType(c.marks[p].type)||this.step(new Ye(o,l,c.marks[p]))}else i.push(new ut(o,l,V.empty));o=l}if(!n.validEnd){var f=n.fillBefore(R.empty,!0);this.replace(o,o,new V(f,0,0))}for(var d=i.length-1;d>=0;d--)this.step(i[d]);return this},A.prototype.replace=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=V.empty);var r=er(this.doc,e,t,n);return r&&this.step(r),this},A.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new V(R.from(n),0,0))},A.prototype.delete=function(e,t){return this.replace(e,t,V.empty)},A.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};var re=function(t,n,r){this.$to=n,this.$from=t,this.unplaced=r,this.frontier=[];for(var i=0;i<=t.depth;i++){var o=t.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(t.indexAfter(i))})}this.placed=R.empty;for(var s=t.depth;s>0;s--)this.placed=R.from(t.node(s).copy(this.placed))},di={depth:{configurable:!0}};function An(e,t,n){return 0==t?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(An(e.firstChild.content,t-1,n)))}function En(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(En(e.lastChild.content,t-1,n)))}function hi(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function co(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,co(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(R.empty,!0)))),e.copy(r)}function ms(e,t,n,r,i){var o=e.node(t),s=i?e.indexAfter(t):e.index(t);if(s==o.childCount&&!n.compatibleContent(o.type))return null;var c=r.fillBefore(o.content,!0,s);return c&&!function Wu(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,o.content,s)?c:null}function Za(e,t,n,r,i){if(t<n){var o=e.firstChild;e=e.replaceChild(0,o.copy(Za(o.content,t+1,n,r,o)))}if(t>r){var s=i.contentMatchAt(0),c=s.fillBefore(e).append(e);e=c.append(s.matchFragment(c).fillBefore(R.empty,!0))}return e}function qa(e,t){for(var n=[],i=Math.min(e.depth,t.depth);i>=0;i--){var o=e.start(i);if(o<e.pos-(e.depth-i)||t.end(i)>t.pos+(t.depth-i)||e.node(i).type.spec.isolating||t.node(i).type.spec.isolating)break;(o==t.start(i)||i==e.depth&&i==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&i&&t.start(i-1)==o-1)&&n.push(i)}return n}di.depth.get=function(){return this.frontier.length-1},re.prototype.fit=function(){for(;this.unplaced.size;){var t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}var n=this.mustMoveInline(),r=this.placed.size-this.depth-this.$from.depth,i=this.$from,o=this.close(n<0?this.$to:i.doc.resolve(n));if(!o)return null;for(var s=this.placed,c=i.depth,l=o.depth;c&&l&&1==s.childCount;)s=s.firstChild.content,c--,l--;var u=new V(s,c,l);return n>-1?new $(i.pos,n,this.$to.pos,this.$to.end(),u,r):u.size||i.pos!=this.$to.pos?new ut(i.pos,o.pos,u):void 0},re.prototype.findFittable=function(){for(var t=1;t<=2;t++)for(var n=this.unplaced.openStart;n>=0;n--)for(var i=void 0,o=(n?(i=hi(this.unplaced.content,n-1).firstChild).content:this.unplaced.content).firstChild,s=this.depth;s>=0;s--){var c=this.frontier[s],l=c.type,u=c.match,p=void 0,f=void 0;if(1==t&&(o?u.matchType(o.type)||(f=u.fillBefore(R.from(o),!1)):l.compatibleContent(i.type)))return{sliceDepth:n,frontierDepth:s,parent:i,inject:f};if(2==t&&o&&(p=u.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:s,parent:i,wrap:p};if(i&&u.matchType(i.type))break}},re.prototype.openMore=function(){var t=this.unplaced,n=t.content,r=t.openStart,i=t.openEnd,o=hi(n,r);return!(!o.childCount||o.firstChild.isLeaf||(this.unplaced=new V(n,r+1,Math.max(i,o.size+r>=n.size-i?r+1:0)),0))},re.prototype.dropNode=function(){var t=this.unplaced,n=t.content,r=t.openStart,i=t.openEnd,o=hi(n,r);if(o.childCount<=1&&r>0){var s=n.size-r<=r+o.size;this.unplaced=new V(An(n,r-1,1),r-1,s?r-1:i)}else this.unplaced=new V(An(n,r,1),r,i)},re.prototype.placeNodes=function(t){for(var n=t.sliceDepth,r=t.frontierDepth,i=t.parent,o=t.inject,s=t.wrap;this.depth>r;)this.closeFrontierNode();if(s)for(var c=0;c<s.length;c++)this.openFrontierNode(s[c]);var l=this.unplaced,u=i?i.content:l.content,p=l.openStart-n,f=0,d=[],g=this.frontier[r],y=g.match,_=g.type;if(o){for(var C=0;C<o.childCount;C++)d.push(o.child(C));y=y.matchFragment(o)}for(var k=u.size+n-(l.content.size-l.openEnd);f<u.childCount;){var M=u.child(f),B=y.matchType(M.type);if(!B)break;(++f>1||0==p||M.content.size)&&(y=B,d.push(co(M.mark(_.allowedMarks(M.marks)),1==f?p:0,f==u.childCount?k:-1)))}var b=f==u.childCount;b||(k=-1),this.placed=En(this.placed,r,R.from(d)),this.frontier[r].match=y,b&&k<0&&i&&i.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var P=0,D=u;P<k;P++){var J=D.lastChild;this.frontier.push({type:J.type,match:J.contentMatchAt(J.childCount)}),D=J.content}this.unplaced=b?0==n?V.empty:new V(An(l.content,n-1,1),n-1,k<0?l.openEnd:n-1):new V(An(l.content,n,f),l.openStart,l.openEnd)},re.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var n,t=this.frontier[this.depth];if(!t.type.isTextblock||!ms(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;for(var i=this.$to.depth,o=this.$to.after(i);i>1&&o==this.$to.end(--i);)++o;return o},re.prototype.findCloseLevel=function(t){t:for(var n=Math.min(this.depth,t.depth);n>=0;n--){var r=this.frontier[n],i=r.match,o=r.type,s=n<t.depth&&t.end(n+1)==t.pos+(t.depth-(n+1)),c=ms(t,n,o,i,s);if(c){for(var l=n-1;l>=0;l--){var u=this.frontier[l],d=ms(t,l,u.type,u.match,!0);if(!d||d.childCount)continue t}return{depth:n,fit:c,move:s?t.doc.resolve(t.after(n+1)):t}}}},re.prototype.close=function(t){var n=this.findCloseLevel(t);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=En(this.placed,n.depth,n.fit)),t=n.move;for(var r=n.depth+1;r<=t.depth;r++){var i=t.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,t.index(r));this.openFrontierNode(i.type,i.attrs,o)}return t},re.prototype.openFrontierNode=function(t,n,r){var i=this.frontier[this.depth];i.match=i.match.matchType(t),this.placed=En(this.placed,this.depth,R.from(t.create(n,r))),this.frontier.push({type:t,match:t.contentMatch})},re.prototype.closeFrontierNode=function(){var n=this.frontier.pop().match.fillBefore(R.empty,!0);n.childCount&&(this.placed=En(this.placed,this.frontier.length,n))},Object.defineProperties(re.prototype,di),A.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),i=this.doc.resolve(t);if(Or(r,i,n))return this.step(new ut(e,t,n));var o=qa(r,this.doc.resolve(t));0==o[o.length-1]&&o.pop();var s=-(r.depth+1);o.unshift(s);for(var c=r.depth,l=r.pos-1;c>0;c--,l--){var u=r.node(c).type.spec;if(u.defining||u.isolating)break;o.indexOf(c)>-1?s=c:r.before(c)==l&&o.splice(1,0,-c)}for(var p=o.indexOf(s),f=[],d=n.openStart,g=n.content,y=0;;y++){var _=g.firstChild;if(f.push(_),y==n.openStart)break;g=_.content}d>0&&f[d-1].type.spec.defining&&r.node(p).type!=f[d-1].type?d-=1:d>=2&&f[d-1].isTextblock&&f[d-2].type.spec.defining&&r.node(p).type!=f[d-2].type&&(d-=2);for(var C=n.openStart;C>=0;C--){var k=(C+d+1)%(n.openStart+1),M=f[k];if(M)for(var B=0;B<o.length;B++){var b=o[(B+p)%o.length],P=!0;b<0&&(P=!1,b=-b);var D=r.node(b-1),J=r.index(b-1);if(D.canReplaceWith(J,J,M.type,M.marks))return this.replace(r.before(b),P?i.after(b):t,new V(Za(n.content,0,n.openStart,k),k,n.openEnd))}}for(var j=this.steps.length,X=o.length-1;X>=0&&(this.replace(e,t,n),!(this.steps.length>j));X--){var nt=o[X];nt<0||(e=r.before(nt),t=i.after(nt))}return this},A.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=function We(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(var i=r.depth-1;i>=0;i--){var o=r.index(i);if(r.node(i).canReplaceWith(o,o,n))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var c=r.indexAfter(s);if(r.node(s).canReplaceWith(c,c,n))return r.after(s+1);if(c<r.node(s).childCount)return null}}(this.doc,e,n.type);null!=r&&(e=t=r)}return this.replaceRange(e,t,new V(R.from(n),0,0))},A.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),i=qa(n,r),o=0;o<i.length;o++){var s=i[o],c=o==i.length-1;if(c&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(c||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var l=1;l<=n.depth&&l<=r.depth;l++)if(e-n.start(l)==n.depth-l&&t>n.end(l)&&r.end(l)-t!=r.depth-l)return this.delete(n.before(l),t);return this.delete(e,t)};var gs=Object.create(null),tt=function(t,n,r){this.ranges=r||[new Yu(t.min(n),t.max(n))],this.$anchor=t,this.$head=n},Nn={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};Nn.anchor.get=function(){return this.$anchor.pos},Nn.head.get=function(){return this.$head.pos},Nn.from.get=function(){return this.$from.pos},Nn.to.get=function(){return this.$to.pos},Nn.$from.get=function(){return this.ranges[0].$from},Nn.$to.get=function(){return this.ranges[0].$to},Nn.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0},tt.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},tt.prototype.replace=function(t,n){void 0===n&&(n=V.empty);for(var r=n.content.lastChild,i=null,o=0;o<n.openEnd;o++)i=r,r=r.lastChild;for(var s=t.steps.length,c=this.ranges,l=0;l<c.length;l++){var u=c[l],p=u.$from,f=u.$to,d=t.mapping.slice(s);t.replaceRange(d.map(p.pos),d.map(f.pos),l?V.empty:n),0==l&&Ba(t,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}},tt.prototype.replaceWith=function(t,n){for(var r=t.steps.length,i=this.ranges,o=0;o<i.length;o++){var s=i[o],c=s.$from,l=s.$to,u=t.mapping.slice(r),p=u.map(c.pos),f=u.map(l.pos);o?t.deleteRange(p,f):(t.replaceRangeWith(p,f,n),Ba(t,r,n.isInline?-1:1))}},tt.findFrom=function(t,n,r){var i=t.parent.inlineContent?new at(t):Ar(t.node(0),t.parent,t.pos,t.index(),n,r);if(i)return i;for(var o=t.depth-1;o>=0;o--){var s=n<0?Ar(t.node(0),t.node(o),t.before(o+1),t.index(o),n,r):Ar(t.node(0),t.node(o),t.after(o+1),t.index(o)+1,n,r);if(s)return s}},tt.near=function(t,n){return void 0===n&&(n=1),this.findFrom(t,n)||this.findFrom(t,-n)||new fn(t.node(0))},tt.atStart=function(t){return Ar(t,t,0,0,1)||new fn(t)},tt.atEnd=function(t){return Ar(t,t,t.content.size,t.childCount,-1)||new fn(t)},tt.fromJSON=function(t,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");var r=gs[n.type];if(!r)throw new RangeError("No selection type "+n.type+" defined");return r.fromJSON(t,n)},tt.jsonID=function(t,n){if(t in gs)throw new RangeError("Duplicate use of selection JSON ID "+t);return gs[t]=n,n.prototype.jsonID=t,n},tt.prototype.getBookmark=function(){return at.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(tt.prototype,Nn),tt.prototype.visible=!0;var Yu=function(t,n){this.$from=t,this.$to=n},at=function(e){function t(r,i){void 0===i&&(i=r),e.call(this,r,i)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(i,o){var s=i.resolve(o.map(this.head));if(!s.parent.inlineContent)return e.near(s);var c=i.resolve(o.map(this.anchor));return new t(c.parent.inlineContent?c:s,s)},t.prototype.replace=function(i,o){if(void 0===o&&(o=V.empty),e.prototype.replace.call(this,i,o),o==V.empty){var s=this.$from.marksAcross(this.$to);s&&i.ensureMarks(s)}},t.prototype.eq=function(i){return i instanceof t&&i.anchor==this.anchor&&i.head==this.head},t.prototype.getBookmark=function(){return new mi(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(i,o){if("number"!=typeof o.anchor||"number"!=typeof o.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(i.resolve(o.anchor),i.resolve(o.head))},t.create=function(i,o,s){void 0===s&&(s=o);var c=i.resolve(o);return new this(c,s==o?c:i.resolve(s))},t.between=function(i,o,s){var c=i.pos-o.pos;if((!s||c)&&(s=c>=0?1:-1),!o.parent.inlineContent){var l=e.findFrom(o,s,!0)||e.findFrom(o,-s,!0);if(!l)return e.near(o,s);o=l.$head}return i.parent.inlineContent||(0==c||(i=(e.findFrom(i,-s,!0)||e.findFrom(i,s,!0)).$anchor).pos<o.pos!=c<0)&&(i=o),new t(i,o)},Object.defineProperties(t.prototype,n),t}(tt);tt.jsonID("text",at);var mi=function(t,n){this.anchor=t,this.head=n};mi.prototype.map=function(t){return new mi(t.map(this.anchor),t.map(this.head))},mi.prototype.resolve=function(t){return at.between(t.resolve(this.anchor),t.resolve(this.head))};var et=function(e){function t(n){var r=n.nodeAfter,i=n.node(0).resolve(n.pos+r.nodeSize);e.call(this,n,i),this.node=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.map=function(r,i){var o=i.mapResult(this.anchor),s=o.deleted,l=r.resolve(o.pos);return s?e.near(l):new t(l)},t.prototype.content=function(){return new V(R.from(this.node),0,0)},t.prototype.eq=function(r){return r instanceof t&&r.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new lo(this.anchor)},t.fromJSON=function(r,i){if("number"!=typeof i.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(r.resolve(i.anchor))},t.create=function(r,i){return new this(r.resolve(i))},t.isSelectable=function(r){return!r.isText&&!1!==r.type.spec.selectable},t}(tt);et.prototype.visible=!1,tt.jsonID("node",et);var lo=function(t){this.anchor=t};lo.prototype.map=function(t){var n=t.mapResult(this.anchor),i=n.pos;return n.deleted?new mi(i,i):new lo(i)},lo.prototype.resolve=function(t){var n=t.resolve(this.anchor),r=n.nodeAfter;return r&&et.isSelectable(r)?new et(n):tt.near(n)};var fn=function(e){function t(n){e.call(this,n.resolve(0),n.resolve(n.content.size))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.replace=function(r,i){if(void 0===i&&(i=V.empty),i==V.empty){r.delete(0,r.doc.content.size);var o=e.atStart(r.doc);o.eq(r.selection)||r.setSelection(o)}else e.prototype.replace.call(this,r,i)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(r){return new t(r)},t.prototype.map=function(r){return new t(r)},t.prototype.eq=function(r){return r instanceof t},t.prototype.getBookmark=function(){return Ku},t}(tt);tt.jsonID("all",fn);var Ku={map:function(){return this},resolve:function(t){return new fn(t)}};function Ar(e,t,n,r,i,o){if(t.inlineContent)return at.create(e,n);for(var s=r-(i>0?0:1);i>0?s<t.childCount:s>=0;s+=i){var c=t.child(s);if(c.isAtom){if(!o&&et.isSelectable(c))return et.create(e,n-(i<0?c.nodeSize:0))}else{var l=Ar(e,c,n+i,i<0?c.childCount:0,i,o);if(l)return l}n+=c.nodeSize*i}}function Ba(e,t,n){var r=e.steps.length-1;if(!(r<t)){var s,i=e.steps[r];(i instanceof ut||i instanceof $)&&(e.mapping.maps[r].forEach(function(c,l,u,p){null==s&&(s=p)}),e.setSelection(tt.near(e.doc.resolve(s),n)))}}var Qu=function(e){function t(r){e.call(this,r.doc),this.time=Date.now(),this.curSelection=r.selection,this.curSelectionFor=0,this.storedMarks=r.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(i){if(i.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=i,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},t.prototype.setStoredMarks=function(i){return this.storedMarks=i,this.updated|=2,this},t.prototype.ensureMarks=function(i){return st.sameSet(this.storedMarks||this.selection.$from.marks(),i)||this.setStoredMarks(i),this},t.prototype.addStoredMark=function(i){return this.ensureMarks(i.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(i){return this.ensureMarks(i.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},t.prototype.addStep=function(i,o){e.prototype.addStep.call(this,i,o),this.updated=-3&this.updated,this.storedMarks=null},t.prototype.setTime=function(i){return this.time=i,this},t.prototype.replaceSelection=function(i){return this.selection.replace(this,i),this},t.prototype.replaceSelectionWith=function(i,o){var s=this.selection;return!1!==o&&(i=i.mark(this.storedMarks||(s.empty?s.$from.marks():s.$from.marksAcross(s.$to)||st.none))),s.replaceWith(this,i),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(i,o,s){void 0===s&&(s=o);var c=this.doc.type.schema;if(null==o)return i?this.replaceSelectionWith(c.text(i),!0):this.deleteSelection();if(!i)return this.deleteRange(o,s);var l=this.storedMarks;if(!l){var u=this.doc.resolve(o);l=s==o?u.marks():u.marksAcross(this.doc.resolve(s))}return this.replaceRangeWith(o,s,c.text(i,l)),this.selection.empty||this.setSelection(tt.near(this.selection.$to)),this},t.prototype.setMeta=function(i,o){return this.meta["string"==typeof i?i:i.key]=o,this},t.prototype.getMeta=function(i){return this.meta["string"==typeof i?i:i.key]},n.isGeneric.get=function(){for(var r in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(t.prototype,n),t}(A);function za(e,t){return t&&e?e.bind(t):e}var gi=function(t,n,r){this.name=t,this.init=za(n.init,r),this.apply=za(n.apply,r)},Xu=[new gi("doc",{init:function(t){return t.doc||t.schema.topNodeType.createAndFill()},apply:function(t){return t.doc}}),new gi("selection",{init:function(t,n){return t.selection||tt.atStart(n.doc)},apply:function(t){return t.selection}}),new gi("storedMarks",{init:function(t){return t.storedMarks||null},apply:function(t,n,r,i){return i.selection.$cursor?t.storedMarks:null}}),new gi("scrollToSelection",{init:function(){return 0},apply:function(t,n){return t.scrolledIntoView?n+1:n}})],vs=function(t,n){var r=this;this.schema=t,this.fields=Xu.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),n&&n.forEach(function(i){if(r.pluginsByKey[i.key])throw new RangeError("Adding different instances of a keyed plugin ("+i.key+")");r.plugins.push(i),r.pluginsByKey[i.key]=i,i.spec.state&&r.fields.push(new gi(i.key,i.spec.state,i))})},Qt=function(t){this.config=t},po={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};po.schema.get=function(){return this.config.schema},po.plugins.get=function(){return this.config.plugins},Qt.prototype.apply=function(t){return this.applyTransaction(t).state},Qt.prototype.filterTransaction=function(t,n){void 0===n&&(n=-1);for(var r=0;r<this.config.plugins.length;r++)if(r!=n){var i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,t,this))return!1}return!0},Qt.prototype.applyTransaction=function(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};for(var n=[t],r=this.applyInner(t),i=null;;){for(var o=!1,s=0;s<this.config.plugins.length;s++){var c=this.config.plugins[s];if(c.spec.appendTransaction){var l=i?i[s].n:0,u=i?i[s].state:this,p=l<n.length&&c.spec.appendTransaction.call(c,l?n.slice(l):n,u,r);if(p&&r.filterTransaction(p,s)){if(p.setMeta("appendedTransaction",t),!i){i=[];for(var f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:r,n:n.length}:{state:this,n:0})}n.push(p),r=r.applyInner(p),o=!0}i&&(i[s]={state:r,n:n.length})}}if(!o)return{state:r,transactions:n}}},Qt.prototype.applyInner=function(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new Qt(this.config),r=this.config.fields,i=0;i<r.length;i++){var o=r[i];n[o.name]=o.apply(t,this[o.name],this,n)}for(var s=0;s<vi.length;s++)vi[s](this,t,n);return n},po.tr.get=function(){return new Qu(this)},Qt.create=function(t){for(var n=new vs(t.doc?t.doc.type.schema:t.schema,t.plugins),r=new Qt(n),i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(t,r);return r},Qt.prototype.reconfigure=function(t){for(var n=new vs(this.schema,t.plugins),r=n.fields,i=new Qt(n),o=0;o<r.length;o++){var s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(t,i)}return i},Qt.prototype.toJSON=function(t){var n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(function(s){return s.toJSON()})),t&&"object"==typeof t)for(var r in t){if("doc"==r||"selection"==r)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var i=t[r],o=i.spec.state;o&&o.toJSON&&(n[r]=o.toJSON.call(i,this[i.key]))}return n},Qt.fromJSON=function(t,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");var i=new vs(t.schema,t.plugins),o=new Qt(i);return i.fields.forEach(function(s){if("doc"==s.name)o.doc=Q.fromJSON(t.schema,n.doc);else if("selection"==s.name)o.selection=tt.fromJSON(o.doc,n.selection);else if("storedMarks"==s.name)n.storedMarks&&(o.storedMarks=n.storedMarks.map(t.schema.markFromJSON));else{if(r)for(var c in r){var l=r[c],u=l.spec.state;if(l.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(n,c))return void(o[s.name]=u.fromJSON.call(l,t,n[c],o))}o[s.name]=s.init(t,o)}}),o},Qt.addApplyListener=function(t){vi.push(t)},Qt.removeApplyListener=function(t){var n=vi.indexOf(t);n>-1&&vi.splice(n,1)},Object.defineProperties(Qt.prototype,po);var vi=[];function Va(e,t,n){for(var r in e){var i=e[r];i instanceof Function?i=i.bind(t):"handleDOMEvents"==r&&(i=Va(i,t,{})),n[r]=i}return n}var ie=function(t){this.props={},t.props&&Va(t.props,this,this.props),this.spec=t,this.key=t.key?t.key.key:Ha("plugin")};ie.prototype.getState=function(t){return t[this.key]};var ys=Object.create(null);function Ha(e){return e in ys?e+"$"+ ++ys[e]:(ys[e]=0,e+"$")}var Te=function(t){void 0===t&&(t="key"),this.key=Ha(t)};function bs(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function Ja(e,t,n){var i=e.selection.$cursor;if(!i||(n?!n.endOfTextblock("backward",e):i.parentOffset>0))return!1;var o=ja(i);if(!o){var s=i.blockRange(),c=s&&bt(s);return null!=c&&(t&&t(e.tr.lift(s,c).scrollIntoView()),!0)}var l=o.nodeBefore;if(!l.type.spec.isolating&&ec(e,o,t))return!0;if(0==i.parent.content.size&&(Er(l,"end")||et.isSelectable(l))){var u=er(e.doc,i.before(),i.after(),V.empty);if(u.slice.size<u.to-u.from){if(t){var p=e.tr.step(u);p.setSelection(Er(l,"end")?tt.findFrom(p.doc.resolve(p.mapping.map(o.pos,-1)),-1):et.create(p.doc,o.pos-l.nodeSize)),t(p.scrollIntoView())}return!0}}return!(!l.isAtom||o.depth!=i.depth-1||(t&&t(e.tr.delete(o.pos-l.nodeSize,o.pos).scrollIntoView()),0))}function Er(e,t,n){for(;e;e="start"==t?e.firstChild:e.lastChild){if(e.isTextblock)return!0;if(n&&1!=e.childCount)return!1}return!1}function Ua(e,t,n){var r=e.selection,i=r.$head,s=i;if(!r.empty)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):i.parentOffset>0)return!1;s=ja(i)}var c=s&&s.nodeBefore;return!(!c||!et.isSelectable(c)||(t&&t(e.tr.setSelection(et.create(e.doc,s.pos-c.nodeSize)).scrollIntoView()),0))}function ja(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function Wa(e,t,n){var i=e.selection.$cursor;if(!i||(n?!n.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size))return!1;var o=Ka(i);if(!o)return!1;var s=o.nodeAfter;if(ec(e,o,t))return!0;if(0==i.parent.content.size&&(Er(s,"start")||et.isSelectable(s))){var c=er(e.doc,i.before(),i.after(),V.empty);if(c.slice.size<c.to-c.from){if(t){var l=e.tr.step(c);l.setSelection(Er(s,"start")?tt.findFrom(l.doc.resolve(l.mapping.map(o.pos)),1):et.create(l.doc,l.mapping.map(o.pos))),t(l.scrollIntoView())}return!0}}return!(!s.isAtom||o.depth!=i.depth-1||(t&&t(e.tr.delete(o.pos,o.pos+s.nodeSize).scrollIntoView()),0))}function Ya(e,t,n){var r=e.selection,i=r.$head,s=i;if(!r.empty)return!1;if(i.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size)return!1;s=Ka(i)}var c=s&&s.nodeAfter;return!(!c||!et.isSelectable(c)||(t&&t(e.tr.setSelection(et.create(e.doc,s.pos)).scrollIntoView()),0))}function Ka(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function Qa(e,t){var n=e.selection,r=n.$head;return!(!r.parent.type.spec.code||!r.sameParent(n.$anchor)||(t&&t(e.tr.insertText("\n").scrollIntoView()),0))}function _s(e){for(var t=0;t<e.edgeCount;t++){var r=e.edge(t).type;if(r.isTextblock&&!r.hasRequiredAttrs())return r}return null}function Xa(e,t){var n=e.selection,r=n.$head;if(!r.parent.type.spec.code||!r.sameParent(n.$anchor))return!1;var o=r.node(-1),s=r.indexAfter(-1),c=_s(o.contentMatchAt(s));if(!o.canReplaceWith(s,s,c))return!1;if(t){var l=r.after(),u=e.tr.replaceWith(l,l,c.createAndFill());u.setSelection(tt.near(u.doc.resolve(l),1)),t(u.scrollIntoView())}return!0}function Ga(e,t){var n=e.selection,r=n.$from,i=n.$to;if(n instanceof fn||r.parent.inlineContent||i.parent.inlineContent)return!1;var o=_s(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){var s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,c=e.tr.insert(s,o.createAndFill());c.setSelection(at.create(c.doc,s+1)),t(c.scrollIntoView())}return!0}function $a(e,t){var r=e.selection.$cursor;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){var i=r.before();if(Mt(e.doc,i))return t&&t(e.tr.split(i).scrollIntoView()),!0}var o=r.blockRange(),s=o&&bt(o);return null!=s&&(t&&t(e.tr.lift(o,s).scrollIntoView()),!0)}function ec(e,t,n){var o,s,r=t.nodeBefore,i=t.nodeAfter;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(function ep(e,t,n){var r=t.nodeBefore,i=t.nodeAfter,o=t.index();return!(!(r&&i&&r.type.compatibleContent(i.type))||(!r.content.size&&t.parent.canReplace(o-1,o)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(o,o+1)||!i.isTextblock&&!ne(e.doc,t.pos)||(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;var c=t.parent.canReplace(t.index(),t.index()+1);if(c&&(o=(s=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&s.matchType(o[0]||i.type).validEnd){if(n){for(var l=t.pos+i.nodeSize,u=R.empty,p=o.length-1;p>=0;p--)u=R.from(o[p].create(null,u));u=R.from(r.copy(u));var f=e.tr.step(new $(t.pos-1,l,t.pos,l,new V(u,1,0),o.length,!0)),d=l+2*o.length;ne(f.doc,d)&&f.join(d),n(f.scrollIntoView())}return!0}var g=tt.findFrom(t,1),y=g&&g.$from.blockRange(g.$to),_=y&&bt(y);if(null!=_&&_>=t.depth)return n&&n(e.tr.lift(y,_).scrollIntoView()),!0;if(c&&Er(i,"start",!0)&&Er(r,"end")){for(var C=r,k=[];k.push(C),!C.isTextblock;)C=C.lastChild;for(var M=i,B=1;!M.isTextblock;M=M.firstChild)B++;if(C.canReplace(C.childCount,C.childCount,M.content)){if(n){for(var b=R.empty,P=k.length-1;P>=0;P--)b=R.from(k[P].copy(b));n(e.tr.step(new $(t.pos-k.length,t.pos+i.nodeSize,t.pos+B,t.pos+i.nodeSize-B,new V(b,k.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function nc(e){return function(t,n){for(var r=t.selection,i=e<0?r.$from:r.$to,o=i.depth;i.node(o).isInline;){if(!o)return!1;o--}return!!i.node(o).isTextblock&&(n&&n(t.tr.setSelection(at.create(t.doc,e<0?i.start(o):i.end(o)))),!0)}}Te.prototype.get=function(t){return t.config.pluginsByKey[this.key]},Te.prototype.getState=function(t){return t[this.key]};var rc=nc(-1),ic=nc(1);function oc(e,t){return function(n,r){var i=n.selection,o=i.from,s=i.to,c=!1;return n.doc.nodesBetween(o,s,function(l,u){if(c)return!1;if(l.isTextblock&&!l.hasMarkup(e,t))if(l.type==e)c=!0;else{var p=n.doc.resolve(u),f=p.index();c=p.parent.canReplaceWith(f,f+1,e)}}),!!c&&(r&&r(n.tr.setBlockType(o,s,e,t).scrollIntoView()),!0)}}function xs(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(n,r,i){for(var o=0;o<e.length;o++)if(e[o](n,r,i))return!0;return!1}}var ws=xs(bs,Ja,Ua),sc=xs(bs,Wa,Ya),Dn={Enter:xs(Qa,Ga,$a,function tc(e,t){var n=e.selection,r=n.$from,i=n.$to;if(e.selection instanceof et&&e.selection.node.isBlock)return!(!r.parentOffset||!Mt(e.doc,r.pos)||(t&&t(e.tr.split(r.pos).scrollIntoView()),0));if(!r.parent.isBlock)return!1;if(t){var o=i.parentOffset==i.parent.content.size,s=e.tr;(e.selection instanceof at||e.selection instanceof fn)&&s.deleteSelection();var c=0==r.depth?null:_s(r.node(-1).contentMatchAt(r.indexAfter(-1))),l=o&&c?[{type:c}]:null,u=Mt(s.doc,s.mapping.map(r.pos),1,l);if(!l&&!u&&Mt(s.doc,s.mapping.map(r.pos),1,c&&[{type:c}])&&(l=[{type:c}],u=!0),u&&(s.split(s.mapping.map(r.pos),1,l),!o&&!r.parentOffset&&r.parent.type!=c)){var p=s.mapping.map(r.before()),f=s.doc.resolve(p);r.node(-1).canReplaceWith(f.index(),f.index()+1,c)&&s.setNodeMarkup(s.mapping.map(r.before()),c)}t(s.scrollIntoView())}return!0}),"Mod-Enter":Xa,Backspace:ws,"Mod-Backspace":ws,"Shift-Backspace":ws,Delete:sc,"Mod-Delete":sc,"Mod-a":function tp(e,t){return t&&t(e.tr.setSelection(new fn(e.doc))),!0}},op={"Ctrl-h":Dn.Backspace,"Alt-Backspace":Dn["Mod-Backspace"],"Ctrl-d":Dn.Delete,"Ctrl-Alt-Backspace":Dn["Mod-Delete"],"Alt-Delete":Dn["Mod-Delete"],"Alt-d":Dn["Mod-Delete"],"Ctrl-a":rc,"Ctrl-e":ic};for(var ac in Dn)op[ac]=Dn[ac];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform();var q={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Ts=/Edge\/(\d+)/.exec(navigator.userAgent),cc=/MSIE \d/.test(navigator.userAgent),ks=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ss=q.ie=!!(cc||ks||Ts);q.ie_version=cc?document.documentMode||6:ks?+ks[1]:Ts?+Ts[1]:null,q.gecko=!Ss&&/gecko\/(\d+)/i.test(navigator.userAgent),q.gecko_version=q.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var Ms=!Ss&&/Chrome\/(\d+)/.exec(navigator.userAgent);q.chrome=!!Ms,q.chrome_version=Ms&&+Ms[1],q.safari=!Ss&&/Apple Computer/.test(navigator.vendor),q.ios=q.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),q.mac=q.ios||/Mac/.test(navigator.platform),q.android=/Android \d/.test(navigator.userAgent),q.webkit="webkitFontSmoothing"in document.documentElement.style,q.webkit_version=q.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var we=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},Os=function(e){var t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},lc=null,dn=function(e,t,n){var r=lc||(lc=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},yi=function(e,t,n,r){return n&&(uc(e,t,n,r,-1)||uc(e,t,n,r,1))},yp=/^(img|br|input|textarea|hr)$/i;function uc(e,t,n,r,i){for(;;){if(e==n&&t==r)return!0;if(t==(i<0?0:Ke(e))){var o=e.parentNode;if(!o||1!=o.nodeType||_p(e)||yp.test(e.nodeName)||"false"==e.contentEditable)return!1;t=we(e)+(i<0?0:1),e=o}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(i<0?-1:0)]).contentEditable)return!1;t=i<0?Ke(e):0}}}function Ke(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function _p(e){for(var t,n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var As=function(e){var t=e.isCollapsed;return t&&q.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t};function Nr(e,t){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}function xp(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function In(e,t){return"number"==typeof e?e:e[t]}function wp(e){var t=e.getBoundingClientRect();return{left:t.left,right:t.left+e.clientWidth*(t.width/e.offsetWidth||1),top:t.top,bottom:t.top+e.clientHeight*(t.height/e.offsetHeight||1)}}function fc(e){for(var t=[],n=e.ownerDocument;e&&(t.push({dom:e,top:e.scrollTop,left:e.scrollLeft}),e!=n);e=Os(e));return t}function dc(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=r.dom,o=r.top,s=r.left;i.scrollTop!=o+t&&(i.scrollTop=o+t),i.scrollLeft!=s&&(i.scrollLeft=s)}}var Dr=null;function hc(e,t){for(var n,i,r=2e8,o=0,s=t.top,c=t.top,l=e.firstChild,u=0;l;l=l.nextSibling,u++){var p=void 0;if(1==l.nodeType)p=l.getClientRects();else{if(3!=l.nodeType)continue;p=dn(l).getClientRects()}for(var f=0;f<p.length;f++){var d=p[f];if(d.top<=s&&d.bottom>=c){s=Math.max(d.bottom,s),c=Math.min(d.top,c);var g=d.left>t.left?d.left-t.left:d.right<t.left?t.left-d.right:0;if(g<r){n=l,r=g,i=g&&3==n.nodeType?{left:d.right<t.left?d.right:d.left,top:t.top}:t,1==l.nodeType&&g&&(o=u+(t.left>=(d.left+d.right)/2?1:0));continue}}!n&&(t.left>=d.right&&t.top>=d.top||t.left>=d.left&&t.top>=d.bottom)&&(o=u+1)}}return n&&3==n.nodeType?function Sp(e,t){for(var n=e.nodeValue.length,r=document.createRange(),i=0;i<n;i++){r.setEnd(e,i+1),r.setStart(e,i);var o=Pn(r,1);if(o.top!=o.bottom&&Es(t,o))return{node:e,offset:i+(t.left>=(o.left+o.right)/2?1:0)}}return{node:e,offset:0}}(n,i):!n||r&&1==n.nodeType?{node:e,offset:o}:hc(n,i)}function Es(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function mc(e,t,n){var r=e.childNodes.length;if(r&&n.top<n.bottom)for(var i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),o=i;;){var s=e.childNodes[o];if(1==s.nodeType)for(var c=s.getClientRects(),l=0;l<c.length;l++){var u=c[l];if(Es(t,u))return mc(s,t,u)}if((o=(o+1)%r)==i)break}return e}function Ep(e,t){var n,r,o,s,i=e.dom.ownerDocument;if(i.caretPositionFromPoint)try{var c=i.caretPositionFromPoint(t.left,t.top);c&&(o=(n=c).offsetNode,s=n.offset)}catch(C){}if(!o&&i.caretRangeFromPoint){var l=i.caretRangeFromPoint(t.left,t.top);l&&(o=(r=l).startContainer,s=r.startOffset)}var p,u=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top+1);if(!u||!e.dom.contains(1!=u.nodeType?u.parentNode:u)){var f=e.dom.getBoundingClientRect();if(!Es(t,f)||!(u=mc(e.dom,t,f)))return null}if(q.safari)for(var d=u;o&&d;d=Os(d))d.draggable&&(o=s=null);if(u=function Mp(e,t){var n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(u,t),o){if(q.gecko&&1==o.nodeType&&(s=Math.min(s,o.childNodes.length))<o.childNodes.length){var y,g=o.childNodes[s];"IMG"==g.nodeName&&(y=g.getBoundingClientRect()).right<=t.left&&y.bottom>t.top&&s++}o==e.dom&&s==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?p=e.state.doc.content.size:(0==s||1!=o.nodeType||"BR"!=o.childNodes[s-1].nodeName)&&(p=function Ap(e,t,n,r){for(var i=-1,o=t;o!=e.dom;){var s=e.docView.nearestDesc(o,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var c=s.dom.getBoundingClientRect();if(c.left>r.left||c.top>r.top)i=s.posBefore;else{if(!(c.right<r.left||c.bottom<r.top))break;i=s.posAfter}}o=s.dom.parentNode}return i>-1?i:e.docView.posFromDOM(t,n)}(e,o,s,t))}null==p&&(p=function Op(e,t,n){var r=hc(t,n),i=r.node,o=r.offset,s=-1;if(1==i.nodeType&&!i.firstChild){var c=i.getBoundingClientRect();s=c.left!=c.right&&n.left>(c.left+c.right)/2?1:-1}return e.docView.posFromDOM(i,o,s)}(e,u,t));var _=e.docView.nearestDesc(u,!0);return{pos:p,inside:_?_.posAtStart-_.border:-1}}function Pn(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}var Np=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function gc(e,t,n){var r=e.docView.domFromPos(t,n<0?-1:1),i=r.node,o=r.offset,s=q.webkit||q.gecko;if(3==i.nodeType){if(!s||!Np.test(i.nodeValue)&&(n<0?o:o!=i.nodeValue.length)){var p=o,f=o,d=n<0?1:-1;return n<0&&!o?(f++,d=-1):n>=0&&o==i.nodeValue.length?(p--,d=1):n<0?p--:f++,bi(Pn(dn(i,p,f),d),d<0)}var c=Pn(dn(i,o,o),n);if(q.gecko&&o&&/\s/.test(i.nodeValue[o-1])&&o<i.nodeValue.length){var l=Pn(dn(i,o-1,o-1),-1);if(l.top==c.top){var u=Pn(dn(i,o,o+1),-1);if(u.top!=c.top)return bi(u,u.left<l.left)}}return c}if(!e.state.doc.resolve(t).parent.inlineContent){if(o&&(n<0||o==Ke(i))){var g=i.childNodes[o-1];if(1==g.nodeType)return Ns(g.getBoundingClientRect(),!1)}if(o<Ke(i)){var y=i.childNodes[o];if(1==y.nodeType)return Ns(y.getBoundingClientRect(),!0)}return Ns(i.getBoundingClientRect(),n>=0)}if(o&&(n<0||o==Ke(i))){var _=i.childNodes[o-1],C=3==_.nodeType?dn(_,Ke(_)-(s?0:1)):1!=_.nodeType||"BR"==_.nodeName&&_.nextSibling?null:_;if(C)return bi(Pn(C,1),!1)}if(o<Ke(i)){for(var k=i.childNodes[o];k.pmViewDesc&&k.pmViewDesc.ignoreForCoords;)k=k.nextSibling;var M=k?3==k.nodeType?dn(k,0,s?0:1):1==k.nodeType?k:null:null;if(M)return bi(Pn(M,-1),!0)}return bi(Pn(3==i.nodeType?dn(i):i,-n),n>=0)}function bi(e,t){if(0==e.width)return e;var n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function Ns(e,t){if(0==e.height)return e;var n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function vc(e,t,n){var r=e.state,i=e.root.activeElement;r!=t&&e.updateState(t),i!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),i!=e.dom&&i&&i.focus()}}var Ip=/[\u0590-\u08ac]/,yc=null,bc=null,_c=!1;var _t=function(t,n,r,i){this.parent=t,this.children=n,this.dom=r,r.pmViewDesc=this,this.contentDOM=i,this.dirty=0},Qe={size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};_t.prototype.matchesWidget=function(){return!1},_t.prototype.matchesMark=function(){return!1},_t.prototype.matchesNode=function(){return!1},_t.prototype.matchesHack=function(t){return!1},_t.prototype.parseRule=function(){return null},_t.prototype.stopEvent=function(){return!1},Qe.size.get=function(){for(var e=0,t=0;t<this.children.length;t++)e+=this.children[t].size;return e},Qe.border.get=function(){return 0},_t.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)this.children[t].destroy()},_t.prototype.posBeforeChild=function(t){for(var n=0,r=this.posAtStart;n<this.children.length;n++){var i=this.children[n];if(i==t)return r;r+=i.size}},Qe.posBefore.get=function(){return this.parent.posBeforeChild(this)},Qe.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Qe.posAfter.get=function(){return this.posBefore+this.size},Qe.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},_t.prototype.localPosFromDOM=function(t,n,r){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(r<0){var i,o;if(t==this.contentDOM)i=t.childNodes[n-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.previousSibling}for(;i&&(!(o=i.pmViewDesc)||o.parent!=this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}var s,c;if(t==this.contentDOM)s=t.childNodes[n];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;s=t.nextSibling}for(;s&&(!(c=s.pmViewDesc)||c.parent!=this);)s=s.nextSibling;return s?this.posBeforeChild(c):this.posAtEnd}var l;if(t==this.dom&&this.contentDOM)l=n>we(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))l=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==n)for(var u=t;;u=u.parentNode){if(u==this.dom){l=!1;break}if(u.parentNode.firstChild!=u)break}if(null==l&&n==t.childNodes.length)for(var p=t;;p=p.parentNode){if(p==this.dom){l=!0;break}if(p.parentNode.lastChild!=p)break}}return(null==l?r>0:l)?this.posAtEnd:this.posAtStart},_t.prototype.nearestDesc=function(t,n){for(var r=!0,i=t;i;i=i.parentNode){var o=this.getDesc(i);if(o&&(!n||o.node)){if(!r||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==t.nodeType?t:t.parentNode):o.nodeDOM==t))return o;r=!1}}},_t.prototype.getDesc=function(t){for(var n=t.pmViewDesc,r=n;r;r=r.parent)if(r==this)return n},_t.prototype.posFromDOM=function(t,n,r){for(var i=t;i;i=i.parentNode){var o=this.getDesc(i);if(o)return o.localPosFromDOM(t,n,r)}return-1},_t.prototype.descAt=function(t){for(var n=0,r=0;n<this.children.length;n++){var i=this.children[n],o=r+i.size;if(r==t&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(t<o)return i.descAt(t-r-i.border);r=o}},_t.prototype.domFromPos=function(t,n){if(!this.contentDOM)return{node:this.dom,offset:0};for(var r=0,i=0,o=0;r<this.children.length;r++){var s=this.children[r],c=o+s.size;if(c>t||s instanceof kc){i=t-o;break}o=c}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(var l=void 0;r&&!(l=this.children[r-1]).size&&l instanceof wc&&l.widget.type.side>=0;r--);if(n<=0){for(var u,p=!0;(u=r?this.children[r-1]:null)&&u.dom.parentNode!=this.contentDOM;r--,p=!1);return u&&n&&p&&!u.border&&!u.domAtom?u.domFromPos(u.size,n):{node:this.contentDOM,offset:u?we(u.dom)+1:0}}for(var f,d=!0;(f=r<this.children.length?this.children[r]:null)&&f.dom.parentNode!=this.contentDOM;r++,d=!1);return f&&d&&!f.border&&!f.domAtom?f.domFromPos(0,n):{node:this.contentDOM,offset:f?we(f.dom):this.contentDOM.childNodes.length}},_t.prototype.parseRange=function(t,n,r){if(void 0===r&&(r=0),0==this.children.length)return{node:this.contentDOM,from:t,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var i=-1,o=-1,s=r,c=0;;c++){var l=this.children[c],u=s+l.size;if(-1==i&&t<=u){var p=s+l.border;if(t>=p&&n<=u-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(t,n,p);t=s;for(var f=c;f>0;f--){var d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=we(d.dom)+1;break}t-=d.size}-1==i&&(i=0)}if(i>-1&&(u>n||c==this.children.length-1)){n=u;for(var g=c+1;g<this.children.length;g++){var y=this.children[g];if(y.size&&y.dom.parentNode==this.contentDOM&&!y.emptyChildAt(-1)){o=we(y.dom);break}n+=y.size}-1==o&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:t,to:n,fromOffset:i,toOffset:o}},_t.prototype.emptyChildAt=function(t){if(this.border||!this.contentDOM||!this.children.length)return!1;var n=this.children[t<0?0:this.children.length-1];return 0==n.size||n.emptyChildAt(t)},_t.prototype.domAfterPos=function(t){var n=this.domFromPos(t,0),r=n.node,i=n.offset;if(1!=r.nodeType||i==r.childNodes.length)throw new RangeError("No node after pos "+t);return r.childNodes[i]},_t.prototype.setSelection=function(t,n,r,i){for(var o=Math.min(t,n),s=Math.max(t,n),c=0,l=0;c<this.children.length;c++){var u=this.children[c],p=l+u.size;if(o>l&&s<p)return u.setSelection(t-l-u.border,n-l-u.border,r,i);l=p}var f=this.domFromPos(t,t?-1:1),d=n==t?f:this.domFromPos(n,n?-1:1),g=r.getSelection(),y=!1;if((q.gecko||q.safari)&&t==n){var _=f.node,C=f.offset;if(3==_.nodeType){if((y=C&&"\n"==_.nodeValue[C-1])&&C==_.nodeValue.length)for(var k=_,M=void 0;k;k=k.parentNode){if(M=k.nextSibling){"BR"==M.nodeName&&(f=d={node:M.parentNode,offset:we(M)+1});break}var B=k.pmViewDesc;if(B&&B.node&&B.node.isBlock)break}}else{var b=_.childNodes[C-1];y=b&&("BR"==b.nodeName||"false"==b.contentEditable)}}if(q.gecko&&g.focusNode&&g.focusNode!=d.node&&1==g.focusNode.nodeType){var P=g.focusNode.childNodes[g.focusOffset];P&&"false"==P.contentEditable&&(i=!0)}if(i||y&&q.safari||!yi(f.node,f.offset,g.anchorNode,g.anchorOffset)||!yi(d.node,d.offset,g.focusNode,g.focusOffset)){var D=!1;if((g.extend||t==n)&&!y){g.collapse(f.node,f.offset);try{t!=n&&g.extend(d.node,d.offset),D=!0}catch(X){if(!(X instanceof DOMException))throw X}}if(!D){if(t>n){var J=f;f=d,d=J}var j=document.createRange();j.setEnd(d.node,d.offset),j.setStart(f.node,f.offset),g.removeAllRanges(),g.addRange(j)}}},_t.prototype.ignoreMutation=function(t){return!this.contentDOM&&"selection"!=t.type},Qe.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},_t.prototype.markDirty=function(t,n){for(var r=0,i=0;i<this.children.length;i++){var o=this.children[i],s=r+o.size;if(r==s?t<=s&&n>=r:t<s&&n>r){var c=r+o.border,l=s-o.border;if(t>=c&&n<=l)return this.dirty=t==r||n==s?2:1,void(t!=c||n!=l||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(t-c,n-c):o.dirty=3);o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}r=s}this.dirty=2},_t.prototype.markParentsDirty=function(){for(var t=1,n=this.parent;n;n=n.parent,t++){var r=1==t?2:1;n.dirty<r&&(n.dirty=r)}},Qe.domAtom.get=function(){return!1},Qe.ignoreForCoords.get=function(){return!1},Object.defineProperties(_t.prototype,Qe);var Rn=[],wc=function(e){function t(r,i,o,s){var c,l=i.type.toDOM;if("function"==typeof l&&(l=l(o,function(){return c?c.parent?c.parent.posBeforeChild(c):void 0:s})),!i.type.spec.raw){if(1!=l.nodeType){var u=document.createElement("span");u.appendChild(l),l=u}l.contentEditable=!1,l.classList.add("ProseMirror-widget")}e.call(this,r,Rn,l,null),this.widget=i,c=this}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.matchesWidget=function(i){return 0==this.dirty&&i.type.eq(this.widget.type)},t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.stopEvent=function(i){var o=this.widget.spec.stopEvent;return!!o&&o(i)},t.prototype.ignoreMutation=function(i){return"selection"!=i.type||this.widget.spec.ignoreSelection},t.prototype.destroy=function(){this.widget.type.destroy(this.dom),e.prototype.destroy.call(this)},n.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,n),t}(_t),Zp=function(e){function t(r,i,o,s){e.call(this,r,Rn,i,null),this.textDOM=o,this.text=s}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},t.prototype.localPosFromDOM=function(i,o){return i!=this.textDOM?this.posAtStart+(o?this.size:0):this.posAtStart+o},t.prototype.domFromPos=function(i){return{node:this.textDOM,offset:i}},t.prototype.ignoreMutation=function(i){return"characterData"===i.type&&i.target.nodeValue==i.oldValue},Object.defineProperties(t.prototype,n),t}(_t),fo=function(e){function t(n,r,i,o){e.call(this,n,[],i,o),this.mark=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.create=function(r,i,o,s){var c=s.nodeViews[i.type.name],l=c&&c(i,s,o);return(!l||!l.dom)&&(l=Rt.renderSpec(document,i.type.spec.toDOM(i,o))),new t(r,i,l.dom,l.contentDOM||l.dom)},t.prototype.parseRule=function(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},t.prototype.matchesMark=function(r){return 3!=this.dirty&&this.mark.eq(r)},t.prototype.markDirty=function(r,i){if(e.prototype.markDirty.call(this,r,i),0!=this.dirty){for(var o=this.parent;!o.node;)o=o.parent;o.dirty<this.dirty&&(o.dirty=this.dirty),this.dirty=0}},t.prototype.slice=function(r,i,o){var s=t.create(this.parent,this.mark,!0,o),c=this.children,l=this.size;i<l&&(c=Ps(c,i,l,o)),r>0&&(c=Ps(c,0,r,o));for(var u=0;u<c.length;u++)c[u].parent=s;return s.children=c,s},t}(_t),xi=function(e){function t(r,i,o,s,c,l,u,p,f){e.call(this,r,i.isLeaf?Rn:[],c,l),this.nodeDOM=u,this.node=i,this.outerDeco=o,this.innerDeco=s,l&&this.updateChildren(p,f)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return t.create=function(i,o,s,c,l,u){var p,d,f=l.nodeViews[o.type.name],g=f&&f(o,l,function(){return d?d.parent?d.parent.posBeforeChild(d):void 0:u},s,c),y=g&&g.dom,_=g&&g.contentDOM;if(o.isText)if(y){if(3!=y.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else y=document.createTextNode(o.text);else y||(y=(p=Rt.renderSpec(document,o.type.spec.toDOM(o))).dom,_=p.contentDOM);!_&&!o.isText&&"BR"!=y.nodeName&&(y.hasAttribute("contenteditable")||(y.contentEditable=!1),o.type.spec.draggable&&(y.draggable=!0));var C=y;return y=Oc(y,s,o),g?d=new qp(i,o,s,c,y,_,C,g,l,u+1):o.isText?new Tc(i,o,s,c,y,C,l):new t(i,o,s,c,y,_,C,l,u+1)},t.prototype.parseRule=function(){var i=this;if(this.node.type.spec.reparseInView)return null;var o={node:this.node.type.name,attrs:this.node.attrs};return"pre"==this.node.type.whitespace&&(o.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?o.contentElement=this.contentDOM:o.getContent=function(){return i.contentDOM?R.empty:i.node.content},o},t.prototype.matchesNode=function(i,o,s){return 0==this.dirty&&i.eq(this.node)&&Is(o,this.outerDeco)&&s.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},t.prototype.updateChildren=function(i,o){var s=this,c=this.node.inlineContent,l=o,u=i.composing&&this.localCompositionInfo(i,o),p=u&&u.pos>-1?u:null,f=u&&u.pos<0,d=new ke(this,p&&p.node);(function zp(e,t,n,r){var i=t.locals(e),o=0;if(0!=i.length)for(var l=0,u=[],p=null,f=0;;){if(l<i.length&&i[l].to==o){for(var d=i[l++],g=void 0;l<i.length&&i[l].to==o;)(g||(g=[d])).push(i[l++]);if(g){g.sort(Lp);for(var y=0;y<g.length;y++)n(g[y],f,!!p)}else n(d,f,!!p)}var _=void 0,C=void 0;if(p)C=-1,_=p,p=null;else{if(!(f<e.childCount))break;C=f,_=e.child(f++)}for(var k=0;k<u.length;k++)u[k].to<=o&&u.splice(k--,1);for(;l<i.length&&i[l].from<=o&&i[l].to>o;)u.push(i[l++]);var M=o+_.nodeSize;if(_.isText){var B=M;l<i.length&&i[l].from<B&&(B=i[l].from);for(var b=0;b<u.length;b++)u[b].to<B&&(B=u[b].to);B<M&&(p=_.cut(B-o),_=_.cut(0,B-o),M=B,C=-1)}r(_,u.length?_.isInline&&!_.isLeaf?u.filter(function(D){return!D.inline}):u.slice():Rn,t.forChild(o,_),C),o=M}else for(var s=0;s<e.childCount;s++){var c=e.child(s);r(c,i,t.forChild(o,c),s),o+=c.nodeSize}})(this.node,this.innerDeco,function(g,y,_){g.spec.marks?d.syncToMarks(g.spec.marks,c,i):g.type.side>=0&&!_&&d.syncToMarks(y==s.node.childCount?st.none:s.node.child(y).marks,c,i),d.placeWidget(g,i,l)},function(g,y,_,C){var k;d.syncToMarks(g.marks,c,i),d.findNodeMatch(g,y,_,C)||f&&i.state.selection.from>l&&i.state.selection.to<l+g.nodeSize&&(k=d.findIndexWithChild(u.node))>-1&&d.updateNodeAt(g,y,_,k,i)||d.updateNextNode(g,y,_,i,C)||d.addNode(g,y,_,i,l),l+=g.nodeSize}),d.syncToMarks(Rn,c,i),this.node.isTextblock&&d.addTextblockHacks(),d.destroyRest(),(d.changed||2==this.dirty)&&(p&&this.protectLocalComposition(i,p),Sc(this.contentDOM,this.children,i),q.ios&&function Vp(e){if("UL"==e.nodeName||"OL"==e.nodeName){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e),e.style.cssText=t}}(this.dom))},t.prototype.localCompositionInfo=function(i,o){var s=i.state.selection,c=s.from,l=s.to;if(!(!(i.state.selection instanceof at)||c<o||l>o+this.node.content.size)){var u=i.root.getSelection(),p=function Hp(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];t=Ke(e=e.childNodes[t-1])}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(u.focusNode,u.focusOffset);if(p&&this.dom.contains(p.parentNode)){if(this.node.inlineContent){var f=p.nodeValue,d=function Jp(e,t,n,r){for(var i=0,o=0;i<e.childCount&&o<=r;){var s=e.child(i++),c=o;if(o+=s.nodeSize,s.isText){for(var l=s.text;i<e.childCount;){var u=e.child(i++);if(o+=u.nodeSize,!u.isText)break;l+=u.text}if(o>=n){var p=c<r?l.lastIndexOf(t,r-c-1):-1;if(p>=0&&p+t.length+c>=n)return c+p;if(n==r&&l.length>=r+t.length-c&&l.slice(r-c,r-c+t.length)==t)return r}}}return-1}(this.node.content,f,c-o,l-o);return d<0?null:{node:p,pos:d,text:f}}return{node:p,pos:-1}}}},t.prototype.protectLocalComposition=function(i,o){var s=o.node,c=o.pos,l=o.text;if(!this.getDesc(s)){for(var u=s;u.parentNode!=this.contentDOM;u=u.parentNode){for(;u.previousSibling;)u.parentNode.removeChild(u.previousSibling);for(;u.nextSibling;)u.parentNode.removeChild(u.nextSibling);u.pmViewDesc&&(u.pmViewDesc=null)}var p=new Zp(this,u,s,l);i.compositionNodes.push(p),this.children=Ps(this.children,c,c+l.length,i,p)}},t.prototype.update=function(i,o,s,c){return!(3==this.dirty||!i.sameMarkup(this.node)||(this.updateInner(i,o,s,c),0))},t.prototype.updateInner=function(i,o,s,c){this.updateOuterDeco(o),this.node=i,this.innerDeco=s,this.contentDOM&&this.updateChildren(c,this.posAtStart),this.dirty=0},t.prototype.updateOuterDeco=function(i){if(!Is(i,this.outerDeco)){var o=1!=this.nodeDOM.nodeType,s=this.dom;this.dom=Mc(this.dom,this.nodeDOM,Ds(this.outerDeco,this.node,o),Ds(i,this.node,o)),this.dom!=s&&(s.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=i}},t.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)},t.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(t.prototype,n),t}(_t);function Cc(e,t,n,r,i){return Oc(r,t,e),new xi(null,e,t,n,r,r,r,i,0)}var Tc=function(e){function t(r,i,o,s,c,l,u){e.call(this,r,i,o,s,c,null,l,u)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){for(var i=this.nodeDOM.parentNode;i&&i!=this.dom&&!i.pmIsDeco;)i=i.parentNode;return{skip:i||!0}},t.prototype.update=function(i,o,s,c){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!i.sameMarkup(this.node)||(this.updateOuterDeco(o),(0!=this.dirty||i.text!=this.node.text)&&i.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=i.text,c.trackWrites==this.nodeDOM&&(c.trackWrites=null)),this.node=i,this.dirty=0,0))},t.prototype.inParent=function(){for(var i=this.parent.contentDOM,o=this.nodeDOM;o;o=o.parentNode)if(o==i)return!0;return!1},t.prototype.domFromPos=function(i){return{node:this.nodeDOM,offset:i}},t.prototype.localPosFromDOM=function(i,o,s){return i==this.nodeDOM?this.posAtStart+Math.min(o,this.node.text.length):e.prototype.localPosFromDOM.call(this,i,o,s)},t.prototype.ignoreMutation=function(i){return"characterData"!=i.type&&"selection"!=i.type},t.prototype.slice=function(i,o,s){var c=this.node.cut(i,o),l=document.createTextNode(c.text);return new t(this.parent,c,this.outerDeco,this.innerDeco,l,l,s)},t.prototype.markDirty=function(i,o){e.prototype.markDirty.call(this,i,o),this.dom!=this.nodeDOM&&(0==i||o==this.nodeDOM.nodeValue.length)&&(this.dirty=3)},n.domAtom.get=function(){return!1},Object.defineProperties(t.prototype,n),t}(xi),kc=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={domAtom:{configurable:!0},ignoreForCoords:{configurable:!0}};return t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.matchesHack=function(i){return 0==this.dirty&&this.dom.nodeName==i},n.domAtom.get=function(){return!0},n.ignoreForCoords.get=function(){return"IMG"==this.dom.nodeName},Object.defineProperties(t.prototype,n),t}(_t),qp=function(e){function t(n,r,i,o,s,c,l,u,p,f){e.call(this,n,r,i,o,s,c,l,p,f),this.spec=u}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.update=function(r,i,o,s){if(3==this.dirty)return!1;if(this.spec.update){var c=this.spec.update(r,i,o);return c&&this.updateInner(r,i,o,s),c}return!(!this.contentDOM&&!r.isLeaf)&&e.prototype.update.call(this,r,i,o,s)},t.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():e.prototype.selectNode.call(this)},t.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():e.prototype.deselectNode.call(this)},t.prototype.setSelection=function(r,i,o,s){this.spec.setSelection?this.spec.setSelection(r,i,o):e.prototype.setSelection.call(this,r,i,o,s)},t.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),e.prototype.destroy.call(this)},t.prototype.stopEvent=function(r){return!!this.spec.stopEvent&&this.spec.stopEvent(r)},t.prototype.ignoreMutation=function(r){return this.spec.ignoreMutation?this.spec.ignoreMutation(r):e.prototype.ignoreMutation.call(this,r)},t}(xi);function Sc(e,t,n){for(var r=e.firstChild,i=!1,o=0;o<t.length;o++){var s=t[o],c=s.dom;if(c.parentNode==e){for(;c!=r;)r=Ac(r),i=!0;r=r.nextSibling}else i=!0,e.insertBefore(c,r);if(s instanceof fo){var l=r?r.previousSibling:e.lastChild;Sc(s.contentDOM,s.children,n),r=l?l.nextSibling:e.firstChild}}for(;r;)r=Ac(r),i=!0;i&&n.trackWrites==e&&(n.trackWrites=null)}function wi(e){e&&(this.nodeName=e)}wi.prototype=Object.create(null);var nr=[new wi];function Ds(e,t,n){if(0==e.length)return nr;for(var r=n?nr[0]:new wi,i=[r],o=0;o<e.length;o++){var s=e[o].type.attrs;if(s)for(var c in s.nodeName&&i.push(r=new wi(s.nodeName)),s){var l=s[c];null!=l&&(n&&1==i.length&&i.push(r=new wi(t.isInline?"span":"div")),"class"==c?r.class=(r.class?r.class+" ":"")+l:"style"==c?r.style=(r.style?r.style+";":"")+l:"nodeName"!=c&&(r[c]=l))}}return i}function Mc(e,t,n,r){if(n==nr&&r==nr)return t;for(var i=t,o=0;o<r.length;o++){var s=r[o],c=n[o];if(o){var l=void 0;c&&c.nodeName==s.nodeName&&i!=e&&(l=i.parentNode)&&l.tagName.toLowerCase()==s.nodeName||((l=document.createElement(s.nodeName)).pmIsDeco=!0,l.appendChild(i),c=nr[0]),i=l}Bp(i,c||nr[0],s)}return i}function Bp(e,t,n){for(var r in t)"class"!=r&&"style"!=r&&"nodeName"!=r&&!(r in n)&&e.removeAttribute(r);for(var i in n)"class"!=i&&"style"!=i&&"nodeName"!=i&&n[i]!=t[i]&&e.setAttribute(i,n[i]);if(t.class!=n.class){for(var o=t.class?t.class.split(" ").filter(Boolean):Rn,s=n.class?n.class.split(" ").filter(Boolean):Rn,c=0;c<o.length;c++)-1==s.indexOf(o[c])&&e.classList.remove(o[c]);for(var l=0;l<s.length;l++)-1==o.indexOf(s[l])&&e.classList.add(s[l]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style)for(var p,u=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;p=u.exec(t.style);)e.style.removeProperty(p[1]);n.style&&(e.style.cssText+=n.style)}}function Oc(e,t,n){return Mc(e,e,nr,Ds(t,n,1!=e.nodeType))}function Is(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function Ac(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}var ke=function(t,n){this.top=t,this.lock=n,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function Fp(e,t){var n=t,r=n.children.length,i=e.childCount,o=new Map,s=[];t:for(;i>0;){for(var c=void 0;;)if(r){var l=n.children[r-1];if(!(l instanceof fo)){c=l,r--;break}n=l,r=l.children.length}else{if(n==t)break t;r=n.parent.children.indexOf(n),n=n.parent}var u=c.node;if(u){if(u!=e.child(i-1))break;--i,o.set(c,i),s.push(c)}}return{index:i,matched:o,matches:s.reverse()}}(t.node.content,t)};function Lp(e,t){return e.type.side-t.type.side}function Ps(e,t,n,r,i){for(var o=[],s=0,c=0;s<e.length;s++){var l=e[s],u=c,p=c+=l.size;u>=n||p<=t?o.push(l):(u<t&&o.push(l.slice(0,t-u,r)),i&&(o.push(i),i=null),p>n&&o.push(l.slice(n-u,l.size,r)))}return o}function Ec(e,t){var n=e.root.getSelection(),r=e.state.doc;if(!n.focusNode)return null;var i=e.docView.nearestDesc(n.focusNode),o=i&&0==i.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset);if(s<0)return null;var l,u,c=r.resolve(s);if(As(n)){for(l=c;i&&!i.node;)i=i.parent;if(i&&i.node.isAtom&&et.isSelectable(i.node)&&i.parent&&(!i.node.isInline||!function bp(e,t,n){for(var r=0==t,i=t==Ke(e);r||i;){if(e==n)return!0;var o=we(e);if(!(e=e.parentNode))return!1;r=r&&0==o,i=i&&o==Ke(e)}}(n.focusNode,n.focusOffset,i.dom))){var p=i.posBefore;u=new et(s==p?c:r.resolve(p))}}else{var f=e.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;l=r.resolve(f)}return u||(u=Zs(e,l,c,"pointer"==t||e.state.selection.head<c.pos&&!o?1:-1)),u}function Nc(e){return e.editable?e.hasFocus():qs(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Zn(e,t){var n=e.state.selection;if(Rc(e,n),Nc(e)){if(!t&&e.mouseDown&&e.mouseDown.allowDefault&&q.chrome){var r=e.root.getSelection(),i=e.domObserver.currentSelection;if(r.anchorNode&&yi(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset))return e.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function jp(e){var t=e.root.getSelection(),n=document.createRange(),r=e.cursorWrapper.dom,i="IMG"==r.nodeName;i?n.setEnd(r.parentNode,we(r)+1):n.setEnd(r,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!i&&!e.state.selection.visible&&q.ie&&q.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{var c,l,o=n.anchor,s=n.head;Dc&&!(n instanceof at)&&(n.$from.parent.inlineContent||(c=Ic(e,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(l=Ic(e,n.to))),e.docView.setSelection(o,s,e.root,t),Dc&&(c&&Pc(c),l&&Pc(l)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function Up(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.hideSelectionGuard);var n=e.root.getSelection(),r=n.anchorNode,i=n.anchorOffset;t.addEventListener("selectionchange",e.hideSelectionGuard=function(){(n.anchorNode!=r||n.anchorOffset!=i)&&(t.removeEventListener("selectionchange",e.hideSelectionGuard),setTimeout(function(){(!Nc(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}ke.prototype.destroyBetween=function(t,n){if(t!=n){for(var r=t;r<n;r++)this.top.children[r].destroy();this.top.children.splice(t,n-t),this.changed=!0}},ke.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},ke.prototype.syncToMarks=function(t,n,r){for(var i=0,o=this.stack.length>>1,s=Math.min(o,t.length);i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(t[i])&&!1!==t[i].type.spec.spanning;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<t.length;){this.stack.push(this.top,this.index+1);for(var c=-1,l=this.index;l<Math.min(this.index+3,this.top.children.length);l++)if(this.top.children[l].matchesMark(t[o])){c=l;break}if(c>-1)c>this.index&&(this.changed=!0,this.destroyBetween(this.index,c)),this.top=this.top.children[this.index];else{var u=fo.create(this.top,t[o],n,r);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,o++}},ke.prototype.findNodeMatch=function(t,n,r,i){var s,o=-1;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(t,n,r))o=this.top.children.indexOf(s,this.index);else for(var c=this.index,l=Math.min(this.top.children.length,c+5);c<l;c++){var u=this.top.children[c];if(u.matchesNode(t,n,r)&&!this.preMatch.matched.has(u)){o=c;break}}return!(o<0||(this.destroyBetween(this.index,o),this.index++,0))},ke.prototype.updateNodeAt=function(t,n,r,i,o){return!!this.top.children[i].update(t,n,r,o)&&(this.destroyBetween(this.index,i),this.index=i+1,!0)},ke.prototype.findIndexWithChild=function(t){for(;;){var n=t.parentNode;if(!n)return-1;if(n==this.top.contentDOM){var r=t.pmViewDesc;if(r)for(var i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i;return-1}t=n}},ke.prototype.updateNextNode=function(t,n,r,i,o){for(var s=this.index;s<this.top.children.length;s++){var c=this.top.children[s];if(c instanceof xi){var l=this.preMatch.matched.get(c);if(null!=l&&l!=o)return!1;var u=c.dom;if((!this.lock||!(u==this.lock||1==u.nodeType&&u.contains(this.lock.parentNode))||t.isText&&c.node&&c.node.isText&&c.nodeDOM.nodeValue==t.text&&3!=c.dirty&&Is(n,c.outerDeco))&&c.update(t,n,r,i))return this.destroyBetween(this.index,s),c.dom!=u&&(this.changed=!0),this.index++,!0;break}}return!1},ke.prototype.addNode=function(t,n,r,i,o){this.top.children.splice(this.index++,0,xi.create(this.top,t,n,r,i,o)),this.changed=!0},ke.prototype.placeWidget=function(t,n,r){var i=this.index<this.top.children.length?this.top.children[this.index]:null;if(!i||!i.matchesWidget(t)||t!=i.widget&&i.widget.type.toDOM.parentNode){var o=new wc(this.top,t,n,r);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},ke.prototype.addTextblockHacks=function(){for(var t=this.top.children[this.index-1];t instanceof fo;)t=t.children[t.children.length-1];(!t||!(t instanceof Tc)||/\n$/.test(t.node.text))&&((q.safari||q.chrome)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},ke.prototype.addHackNode=function(t){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(t))this.index++;else{var n=document.createElement(t);"IMG"==t&&(n.className="ProseMirror-separator",n.alt=""),"BR"==t&&(n.className="ProseMirror-trailingBreak"),this.top.children.splice(this.index++,0,new kc(this.top,Rn,n,null)),this.changed=!0}};var Dc=q.safari||q.chrome&&q.chrome_version<63;function Ic(e,t){var n=e.docView.domFromPos(t,0),r=n.node,i=n.offset,o=i<r.childNodes.length?r.childNodes[i]:null,s=i?r.childNodes[i-1]:null;if(q.safari&&o&&"false"==o.contentEditable)return Rs(o);if(!(o&&"false"!=o.contentEditable||s&&"false"!=s.contentEditable)){if(o)return Rs(o);if(s)return Rs(s)}}function Rs(e){return e.contentEditable="true",q.safari&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Pc(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Rc(e,t){if(t instanceof et){var n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(Zc(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else Zc(e)}function Zc(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=null)}function Zs(e,t,n,r){return e.someProp("createSelectionBetween",function(i){return i(e,t,n)})||at.between(t,n,r)}function qs(e){var t=e.root.getSelection();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function Bs(e,t){var n=e.selection,r=n.$anchor,i=n.$head,o=t>0?r.max(i):r.min(i),s=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return s&&tt.findFrom(s,t)}function rr(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function qc(e,t,n){var r=e.state.selection;if(!(r instanceof at)){if(r instanceof et&&r.node.isInline)return rr(e,new at(t>0?r.$to:r.$from));var u=Bs(e.state,t);return!!u&&rr(e,u)}if(!r.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var i=Bs(e.state,t);return!!(i&&i instanceof et)&&rr(e,i)}if(!(q.mac&&n.indexOf("m")>-1)){var c,o=r.$head,s=o.textOffset?null:t<0?o.nodeBefore:o.nodeAfter;if(!s||s.isText)return!1;var l=t<0?o.pos-s.nodeSize:o.pos;return!!(s.isAtom||(c=e.docView.descAt(l))&&!c.contentDOM)&&(et.isSelectable(s)?rr(e,new et(t<0?e.state.doc.resolve(o.pos-s.nodeSize):o)):!!q.webkit&&rr(e,new at(e.state.doc.resolve(t<0?l:l+s.nodeSize))))}}function ho(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Ci(e){var t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function Fs(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){var i,o,s=!1;for(q.gecko&&1==n.nodeType&&r<ho(n)&&Ci(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var c=n.childNodes[r-1];if(Ci(c))i=n,o=--r;else{if(3!=c.nodeType)break;r=(n=c).nodeValue.length}}else{if(Bc(n))break;for(var l=n.previousSibling;l&&Ci(l);)i=n.parentNode,o=we(l),l=l.previousSibling;if(l)r=ho(n=l);else{if((n=n.parentNode)==e.dom)break;r=0}}s?zs(e,t,n,r):i&&zs(e,t,i,o)}}function Ls(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){for(var o,s,i=ho(n);;)if(r<i){if(1!=n.nodeType)break;if(!Ci(n.childNodes[r]))break;o=n,s=++r}else{if(Bc(n))break;for(var l=n.nextSibling;l&&Ci(l);)o=l.parentNode,s=we(l)+1,l=l.nextSibling;if(l)r=0,i=ho(n=l);else{if((n=n.parentNode)==e.dom)break;r=i=0}}o&&zs(e,t,o,s)}}function Bc(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function zs(e,t,n,r){if(As(t)){var i=document.createRange();i.setEnd(n,r),i.setStart(n,r),t.removeAllRanges(),t.addRange(i)}else t.extend&&t.extend(n,r);e.domObserver.setCurSelection();var o=e.state;setTimeout(function(){e.state==o&&Zn(e)},50)}function Fc(e,t,n){var r=e.state.selection;if(r instanceof at&&!r.empty||n.indexOf("s")>-1||q.mac&&n.indexOf("m")>-1)return!1;var i=r.$from,o=r.$to;if(!i.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var s=Bs(e.state,t);if(s&&s instanceof et)return rr(e,s)}if(!i.parent.inlineContent){var c=t<0?i:o,l=r instanceof fn?tt.near(c,t):tt.findFrom(c,t);return!!l&&rr(e,l)}return!1}function Lc(e,t){if(!(e.state.selection instanceof at))return!0;var n=e.state.selection,r=n.$head,o=n.empty;if(!r.sameParent(n.$anchor))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var c=e.state.tr;return t<0?c.delete(r.pos-s.nodeSize,r.pos):c.delete(r.pos,r.pos+s.nodeSize),e.dispatch(c),!0}return!1}function zc(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function $p(e){var t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(q.safari&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(e.parentNode.lastChild==e||q.safari&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0}}function Vc(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:Zs(e,t.resolve(n.anchor),t.resolve(n.head))}function Vs(e,t,n){for(var r=e.depth,i=t?e.end():e.pos;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,i++,t=!1;if(n)for(var o=e.node(r).maybeChild(e.indexAfter(r));o&&!o.isLeaf;)o=o.firstChild,i++;return i}function Hc(e,t){for(var n=[],r=t.content,i=t.openStart,o=t.openEnd;i>1&&o>1&&1==r.childCount&&1==r.firstChild.childCount;){i--,o--;var s=r.firstChild;n.push(s.type.name,s.attrs!=s.type.defaultAttrs?s.attrs:null),r=s.content}var c=e.someProp("clipboardSerializer")||Rt.fromSchema(e.state.schema),l=Xc(),u=l.createElement("div");u.appendChild(c.serializeFragment(r,{document:l}));for(var f,p=u.firstChild;p&&1==p.nodeType&&(f=Kc[p.nodeName.toLowerCase()]);){for(var d=f.length-1;d>=0;d--){for(var g=l.createElement(f[d]);u.firstChild;)g.appendChild(u.firstChild);u.appendChild(g),"tbody"!=f[d]&&(i++,o++)}p=u.firstChild}return p&&1==p.nodeType&&p.setAttribute("data-pm-slice",i+" "+o+" "+JSON.stringify(n)),{dom:u,text:e.someProp("clipboardTextSerializer",function(_){return _(t)})||t.content.textBetween(0,t.content.size,"\n\n")}}function Jc(e,t,n,r,i){var o,c,s=i.parent.type.spec.code;if(!n&&!t)return null;var l=t&&(r||s||!n);if(l){if(e.someProp("transformPastedText",function(P){t=P(t,s||r)}),s)return t?new V(R.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):V.empty;var u=e.someProp("clipboardTextParser",function(P){return P(t,i,r)});if(u)c=u;else{var p=i.marks(),d=e.state.schema,g=Rt.fromSchema(d);o=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(function(P){var D=o.appendChild(document.createElement("p"));P&&D.appendChild(g.serializeNode(d.text(P,p)))})}}else e.someProp("transformPastedHTML",function(P){n=P(n)}),o=function af(e){var t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var i,n=Xc().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(e);if((i=r&&Kc[r[1].toLowerCase()])&&(e=i.map(function(s){return"<"+s+">"}).join("")+e+i.map(function(s){return"</"+s+">"}).reverse().join("")),n.innerHTML=e,i)for(var o=0;o<i.length;o++)n=n.querySelector(i[o])||n;return n}(n),q.webkit&&function cf(e){for(var t=e.querySelectorAll(q.chrome?"span:not([class]):not([style])":"span.Apple-converted-space"),n=0;n<t.length;n++){var r=t[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(o);var y=o&&o.querySelector("[data-pm-slice]"),_=y&&/^(\d+) (\d+) (.*)/.exec(y.getAttribute("data-pm-slice"));if(!c){var C=e.someProp("clipboardParser")||e.someProp("domParser")||Yt.fromSchema(e.state.schema);c=C.parseSlice(o,{preserveWhitespace:!(!l&&!_),context:i,ruleFromNode:function(D){if("BR"==D.nodeName&&!D.nextSibling&&D.parentNode&&!of.test(D.parentNode.nodeName))return{ignore:!0}}})}if(_)c=function lf(e,t){if(!e.size)return e;var r,n=e.content.firstChild.type.schema;try{r=JSON.parse(t)}catch(u){return e}for(var i=e.content,o=e.openStart,s=e.openEnd,c=r.length-2;c>=0;c-=2){var l=n.nodes[r[c]];if(!l||l.hasRequiredAttrs())break;i=R.from(l.create(r[c+1],i)),o++,s++}return new V(i,o,s)}(Yc(c,+_[1],+_[2]),_[3]);else if(c=V.maxOpen(function sf(e,t){if(e.childCount<2)return e;for(var n=function(o){var c=t.node(o).contentMatchAt(t.index(o)),l=void 0,u=[];if(e.forEach(function(p){if(u){var d,f=c.findWrapping(p.type);if(!f)return u=null;if(d=u.length&&l.length&&jc(f,l,p,u[u.length-1],0))u[u.length-1]=d;else{u.length&&(u[u.length-1]=Wc(u[u.length-1],l.length));var g=Uc(p,f);u.push(g),c=c.matchType(g.type,g.attrs),l=f}}}),u)return{v:R.from(u)}},r=t.depth;r>=0;r--){var i=n(r);if(i)return i.v}return e}(c.content,i),!0),c.openStart||c.openEnd){for(var k=0,M=0,B=c.content.firstChild;k<c.openStart&&!B.type.spec.isolating;k++,B=B.firstChild);for(var b=c.content.lastChild;M<c.openEnd&&!b.type.spec.isolating;M++,b=b.lastChild);c=Yc(c,k,M)}return e.someProp("transformPasted",function(P){c=P(c)}),c}var of=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Uc(e,t,n){void 0===n&&(n=0);for(var r=t.length-1;r>=n;r--)e=t[r].create(null,R.from(e));return e}function jc(e,t,n,r,i){if(i<e.length&&i<t.length&&e[i]==t[i]){var o=jc(e,t,n,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==e.length-1?n.type:e[i+1]))return r.copy(r.content.append(R.from(Uc(n,e,i+1))))}}function Wc(e,t){if(0==t)return e;var n=e.content.replaceChild(e.childCount-1,Wc(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(R.empty,!0);return e.copy(n.append(r))}function Hs(e,t,n,r,i,o){var s=t<0?e.firstChild:e.lastChild,c=s.content;return i<r-1&&(c=Hs(c,t,n,r,i+1,o)),i>=n&&(c=t<0?s.contentMatchAt(0).fillBefore(c,e.childCount>1||o<=i).append(c):c.append(s.contentMatchAt(s.childCount).fillBefore(R.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(c))}function Yc(e,t,n){return t<e.openStart&&(e=new V(Hs(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new V(Hs(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}var Kc={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},Qc=null;function Xc(){return Qc||(Qc=document.implementation.createHTMLDocument("title"))}var uf={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Js=q.ie&&q.ie_version<=11,Us=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};Us.prototype.set=function(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset},Us.prototype.eq=function(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset};var Ce=function(t,n){var r=this;this.view=t,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver(function(i){for(var o=0;o<i.length;o++)r.queue.push(i[o]);q.ie&&q.ie_version<=11&&i.some(function(s){return"childList"==s.type&&s.removedNodes.length||"characterData"==s.type&&s.oldValue.length>s.target.nodeValue.length})?r.flushSoon():r.flush()}),this.currentSelection=new Us,Js&&(this.onCharData=function(i){r.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),r.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};Ce.prototype.flushSoon=function(){var t=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(function(){t.flushingSoon=-1,t.flush()},20))},Ce.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},Ce.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,uf),Js&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},Ce.prototype.stop=function(){var t=this;if(this.observer){var n=this.observer.takeRecords();if(n.length){for(var r=0;r<n.length;r++)this.queue.push(n[r]);window.setTimeout(function(){return t.flush()},20)}this.observer.disconnect()}Js&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},Ce.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},Ce.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},Ce.prototype.suppressSelectionUpdates=function(){var t=this;this.suppressingSelectionUpdates=!0,setTimeout(function(){return t.suppressingSelectionUpdates=!1},50)},Ce.prototype.onSelectionChange=function(){if(function Wp(e){return(!e.editable||e.root.activeElement==e.dom)&&qs(e)}(this.view)){if(this.suppressingSelectionUpdates)return Zn(this.view);if(q.ie&&q.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&yi(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},Ce.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},Ce.prototype.ignoreSelectionChange=function(t){if(0==t.rangeCount)return!0;var n=t.getRangeAt(0).commonAncestorContainer,r=this.view.docView.nearestDesc(n);return r&&r.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n})?(this.setCurSelection(),!0):void 0},Ce.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var n=this.view.root.getSelection(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&qs(this.view)&&!this.ignoreSelectionChange(n),i=-1,o=-1,s=!1,c=[];if(this.view.editable)for(var l=0;l<t.length;l++){var u=this.registerMutation(t[l],c);u&&(i=i<0?u.from:Math.min(u.from,i),o=o<0?u.to:Math.max(u.to,o),u.typeOver&&(s=!0))}if(q.gecko&&c.length>1){var p=c.filter(function(g){return"BR"==g.nodeName});if(2==p.length){var f=p[0],d=p[1];f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}}(i>-1||r)&&(i>-1&&(this.view.docView.markDirty(i,o),function pf(e){Gc||(Gc=!0,"normal"==getComputedStyle(e.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))}(this.view)),this.handleDOMChange(i,o,s,c),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(n)||Zn(this.view),this.currentSelection.set(n))}},Ce.prototype.registerMutation=function(t,n){if(n.indexOf(t.target)>-1)return null;var r=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(r==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!r||r.ignoreMutation(t))return null;if("childList"==t.type){for(var i=0;i<t.addedNodes.length;i++)n.push(t.addedNodes[i]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(t.target))return{from:r.posBefore,to:r.posAfter};var o=t.previousSibling,s=t.nextSibling;if(q.ie&&q.ie_version<=11&&t.addedNodes.length)for(var c=0;c<t.addedNodes.length;c++){var l=t.addedNodes[c],u=l.previousSibling,p=l.nextSibling;(!u||Array.prototype.indexOf.call(t.addedNodes,u)<0)&&(o=u),(!p||Array.prototype.indexOf.call(t.addedNodes,p)<0)&&(s=p)}var f=o&&o.parentNode==t.target?we(o)+1:0,d=r.localPosFromDOM(t.target,f,-1),g=s&&s.parentNode==t.target?we(s):t.target.childNodes.length;return{from:d,to:r.localPosFromDOM(t.target,g,1)}}return"attributes"==t.type?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}};var Gc=!1,pe={},oe={};function ir(e,t){e.lastSelectionOrigin=t,e.lastSelectionTime=Date.now()}function js(e){e.someProp("handleDOMEvents",function(t){for(var n in t)e.eventHandlers[n]||e.dom.addEventListener(n,e.eventHandlers[n]=function(r){return Ws(e,r)})})}function Ws(e,t){return e.someProp("handleDOMEvents",function(n){var r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function mo(e){return{left:e.clientX,top:e.clientY}}function Ys(e,t,n,r,i){if(-1==r)return!1;for(var o=e.state.doc.resolve(r),s=function(u){if(e.someProp(t,function(p){return u>o.depth?p(e,n,o.nodeAfter,o.before(u),i,!0):p(e,n,o.node(u),o.before(u),i,!1)}))return{v:!0}},c=o.depth+1;c>0;c--){var l=s(c);if(l)return l.v}return!1}function Ir(e,t,n){e.focused||e.focus();var r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function _f(e,t,n,r){return Ys(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",function(i){return i(e,t,r)})}function xf(e,t,n,r){return Ys(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",function(i){return i(e,t,r)})||function wf(e,t,n){if(0!=n.button)return!1;var r=e.state.doc;if(-1==t)return!!r.inlineContent&&(Ir(e,at.create(r,0,r.content.size),"pointer"),!0);for(var i=r.resolve(t),o=i.depth+1;o>0;o--){var s=o>i.depth?i.nodeAfter:i.node(o),c=i.before(o);if(s.inlineContent)Ir(e,at.create(r,c+1,c+1+s.content.size),"pointer");else{if(!et.isSelectable(s))continue;Ir(e,et.create(r,c),"pointer")}return!0}}(e,n,r)}function Ks(e){return vo(e)}oe.keydown=function(e,t){if(e.shiftKey=16==t.keyCode||t.shiftKey,!tl(e,t)&&(e.lastKeyCode=t.keyCode,e.lastKeyCodeTime=Date.now(),!q.android||!q.chrome||13!=t.keyCode))if(229!=t.keyCode&&e.domObserver.forceFlush(),!q.ios||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",function(r){return r(e,t)})||function Xp(e,t){var n=t.keyCode,r=function Qp(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);return 8==n||q.mac&&72==n&&"c"==r?Lc(e,-1)||Fs(e):46==n||q.mac&&68==n&&"c"==r?Lc(e,1)||Ls(e):13==n||27==n||(37==n?qc(e,-1,r)||Fs(e):39==n?qc(e,1,r)||Ls(e):38==n?Fc(e,-1,r)||Fs(e):40==n?function Kp(e){if(q.safari&&!(e.state.selection.$head.parentOffset>0)){var t=e.root.getSelection(),n=t.focusNode;if(n&&1==n.nodeType&&0==t.focusOffset&&n.firstChild&&"false"==n.firstChild.contentEditable){var i=n.firstChild;zc(e,i,!0),setTimeout(function(){return zc(e,i,!1)},20)}}}(e)||Fc(e,1,r)||Ls(e):r==(q.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}(e,t)?t.preventDefault():ir(e,"key");else{var n=Date.now();e.lastIOSEnter=n,e.lastIOSEnterFallbackTimeout=setTimeout(function(){e.lastIOSEnter==n&&(e.someProp("handleKeyDown",function(r){return r(e,Nr(13,"Enter"))}),e.lastIOSEnter=0)},200)}},oe.keyup=function(e,t){16==t.keyCode&&(e.shiftKey=!1)},oe.keypress=function(e,t){if(!(tl(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||q.mac&&t.metaKey)){if(e.someProp("handleKeyPress",function(i){return i(e,t)}))return void t.preventDefault();var n=e.state.selection;if(!(n instanceof at&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(t.charCode);e.someProp("handleTextInput",function(i){return i(e,n.$from.pos,n.$to.pos,r)})||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}}};var $c=q.mac?"metaKey":"ctrlKey";pe.mousedown=function(e,t){e.shiftKey=t.shiftKey;var n=Ks(e),r=Date.now(),i="singleClick";r-e.lastClick.time<500&&function gf(e,t){var n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(t,e.lastClick)&&!t[$c]&&("singleClick"==e.lastClick.type?i="doubleClick":"doubleClick"==e.lastClick.type&&(i="tripleClick")),e.lastClick={time:r,x:t.clientX,y:t.clientY,type:i};var o=e.posAtCoords(mo(t));!o||("singleClick"==i?(e.mouseDown&&e.mouseDown.done(),e.mouseDown=new go(e,o,t,n)):("doubleClick"==i?_f:xf)(e,o.pos,o.inside,t)?t.preventDefault():ir(e,"pointer"))};var go=function(t,n,r,i){var s,c,o=this;if(this.view=t,this.startDoc=t.state.doc,this.pos=n,this.event=r,this.flushed=i,this.selectNode=r[$c],this.allowDefault=r.shiftKey,this.delayedSelectionSync=!1,n.inside>-1)s=t.state.doc.nodeAt(n.inside),c=n.inside;else{var l=t.state.doc.resolve(n.pos);s=l.parent,c=l.depth?l.before():0}this.mightDrag=null;var u=i?null:r.target,p=u?t.docView.nearestDesc(u,!0):null;this.target=p?p.dom:null;var d=t.state.selection;(0==r.button&&s.type.spec.draggable&&!1!==s.type.spec.selectable||d instanceof et&&d.from<=c&&d.to>c)&&(this.mightDrag={node:s,pos:c,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&q.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){o.view.mouseDown==o&&o.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),ir(t,"pointer")};function tl(e,t){return!!e.composing||!!(q.safari&&Math.abs(t.timeStamp-e.compositionEndedAt)<500)&&(e.compositionEndedAt=-2e8,!0)}go.prototype.done=function(){var t=this;this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(function(){return Zn(t.view)}),this.view.mouseDown=null},go.prototype.up=function(t){if(this.done(),this.view.dom.contains(3==t.target.nodeType?t.target.parentNode:t.target)){var n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(mo(t))),this.allowDefault||!n?ir(this.view,"pointer"):function bf(e,t,n,r,i){return Ys(e,"handleClickOn",t,n,r)||e.someProp("handleClick",function(o){return o(e,t,r)})||(i?function yf(e,t){if(-1==t)return!1;var r,i,n=e.state.selection;n instanceof et&&(r=n.node);for(var o=e.state.doc.resolve(t),s=o.depth+1;s>0;s--){var c=s>o.depth?o.nodeAfter:o.node(s);if(et.isSelectable(c)){i=r&&n.$from.depth>0&&s>=n.$from.depth&&o.before(n.$from.depth+1)==n.$from.pos?o.before(n.$from.depth):o.before(s);break}}return null!=i&&(Ir(e,et.create(e.state.doc,i),"pointer"),!0)}(e,n):function vf(e,t){if(-1==t)return!1;var n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&et.isSelectable(r))&&(Ir(e,new et(n),"pointer"),!0)}(e,n))}(this.view,n.pos,n.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||q.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||q.chrome&&!(this.view.state.selection instanceof at)&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Ir(this.view,tt.near(this.view.state.doc.resolve(n.pos)),"pointer"),t.preventDefault()):ir(this.view,"pointer")}},go.prototype.move=function(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),ir(this.view,"pointer"),0==t.buttons&&this.done()},pe.touchdown=function(e){Ks(e),ir(e,"pointer")},pe.contextmenu=function(e){return Ks(e)};var Cf=q.android?5e3:-1;function el(e,t){clearTimeout(e.composingTimeout),t>-1&&(e.composingTimeout=setTimeout(function(){return vo(e)},t))}function nl(e){for(e.composing&&(e.composing=!1,e.compositionEndedAt=function Tf(){var e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.compositionNodes.length>0;)e.compositionNodes.pop().markParentsDirty()}function vo(e,t){if(!(q.android&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),nl(e),t||e.docView&&e.docView.dirty){var n=Ec(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}}oe.compositionstart=oe.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(function(c){return!1===c.type.spec.inclusive})))e.markCursor=e.state.storedMarks||n.marks(),vo(e,!0),e.markCursor=null;else if(vo(e),q.gecko&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=e.root.getSelection(),i=r.focusNode,o=r.focusOffset;i&&1==i.nodeType&&0!=o;){var s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}i=s,o=-1}e.composing=!0}el(e,Cf)},oe.compositionend=function(e,t){e.composing&&(e.composing=!1,e.compositionEndedAt=t.timeStamp,el(e,20))};var Pr=q.ie&&q.ie_version<15||q.ios&&q.webkit_version<604;function Qs(e,t,n,r){var i=Jc(e,t,n,e.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",function(c){return c(e,r,i||V.empty)}))return!0;if(!i)return!1;var o=function Sf(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(i),s=o?e.state.tr.replaceSelectionWith(o,e.shiftKey):e.state.tr.replaceSelection(i);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}pe.copy=oe.cut=function(e,t){var n=e.state.selection,r="cut"==t.type;if(!n.empty){var i=Pr?null:t.clipboardData,s=Hc(e,n.content()),c=s.dom,l=s.text;i?(t.preventDefault(),i.clearData(),i.setData("text/html",c.innerHTML),i.setData("text/plain",l)):function kf(e,t){if(e.dom.parentNode){var n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),i=document.createRange();i.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(function(){n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}}(e,c),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},oe.paste=function(e,t){if(!e.composing||q.android){var n=Pr?null:t.clipboardData;n&&Qs(e,n.getData("text/plain"),n.getData("text/html"),t)?t.preventDefault():function Mf(e,t){if(e.dom.parentNode){var n=e.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(function(){e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Qs(e,r.value,null,t):Qs(e,r.textContent,r.innerHTML,t)},50)}}(e,t)}};var Of=function(t,n){this.slice=t,this.move=n},rl=q.mac?"altKey":"ctrlKey";for(var il in pe.dragstart=function(e,t){var n=e.mouseDown;if(n&&n.done(),t.dataTransfer){var r=e.state.selection,i=r.empty?null:e.posAtCoords(mo(t));if(!(i&&i.pos>=r.from&&i.pos<=(r instanceof et?r.to-1:r.to)))if(n&&n.mightDrag)e.dispatch(e.state.tr.setSelection(et.create(e.state.doc,n.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var o=e.docView.nearestDesc(t.target,!0);o&&o.node.type.spec.draggable&&o!=e.docView&&e.dispatch(e.state.tr.setSelection(et.create(e.state.doc,o.posBefore)))}var s=e.state.selection.content(),c=Hc(e,s),l=c.dom,u=c.text;t.dataTransfer.clearData(),t.dataTransfer.setData(Pr?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Pr||t.dataTransfer.setData("text/plain",u),e.dragging=new Of(s,!t[rl])}},pe.dragend=function(e){var t=e.dragging;window.setTimeout(function(){e.dragging==t&&(e.dragging=null)},50)},oe.dragover=oe.dragenter=function(e,t){return t.preventDefault()},oe.drop=function(e,t){var n=e.dragging;if(e.dragging=null,t.dataTransfer){var r=e.posAtCoords(mo(t));if(r){var i=e.state.doc.resolve(r.pos);if(i){var o=n&&n.slice;o?e.someProp("transformPasted",function(y){o=y(o)}):o=Jc(e,t.dataTransfer.getData(Pr?"Text":"text/plain"),Pr?null:t.dataTransfer.getData("text/html"),!1,i);var s=n&&!t[rl];if(e.someProp("handleDrop",function(y){return y(e,t,o||V.empty,s)}))return void t.preventDefault();if(o){t.preventDefault();var c=o?xe(e.state.doc,i.pos,o):i.pos;null==c&&(c=i.pos);var l=e.state.tr;s&&l.deleteSelection();var u=l.mapping.map(c),p=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,f=l.doc;if(p?l.replaceRangeWith(u,u,o.content.firstChild):l.replaceRange(u,u,o),!l.doc.eq(f)){var d=l.doc.resolve(u);if(p&&et.isSelectable(o.content.firstChild)&&d.nodeAfter&&d.nodeAfter.sameMarkup(o.content.firstChild))l.setSelection(new et(d));else{var g=l.mapping.map(c);l.mapping.maps[l.mapping.maps.length-1].forEach(function(y,_,C,k){return g=k}),l.setSelection(Zs(e,d,l.doc.resolve(g)))}e.focus(),e.dispatch(l.setMeta("uiEvent","drop"))}}}}}},pe.focus=function(e){e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.root.getSelection())&&Zn(e)},20))},pe.blur=function(e,t){e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.set({}),e.focused=!1)},pe.beforeinput=function(e,t){if(q.chrome&&q.android&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();var n=e.domChangeCount;setTimeout(function(){if(e.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",function(o){return o(e,Nr(8,"Backspace"))}))){var i=e.state.selection.$cursor;i&&i.pos>0&&e.dispatch(e.state.tr.delete(i.pos-1,i.pos).scrollIntoView())}},50)}},oe)pe[il]=oe[il];function Ti(e,t){if(e==t)return!0;for(var n in e)if(e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0}var Rr=function(t,n){this.spec=n||or,this.side=this.spec.side||0,this.toDOM=t};Rr.prototype.map=function(t,n,r,i){var o=t.mapResult(n.from+i,this.side<0?-1:1),s=o.pos;return o.deleted?null:new Ft(s-r,s-r,this)},Rr.prototype.valid=function(){return!0},Rr.prototype.eq=function(t){return this==t||t instanceof Rr&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&Ti(this.spec,t.spec))},Rr.prototype.destroy=function(t){this.spec.destroy&&this.spec.destroy(t)};var Fe=function(t,n){this.spec=n||or,this.attrs=t};Fe.prototype.map=function(t,n,r,i){var o=t.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,s=t.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new Ft(o,s,this)},Fe.prototype.valid=function(t,n){return n.from<n.to},Fe.prototype.eq=function(t){return this==t||t instanceof Fe&&Ti(this.attrs,t.attrs)&&Ti(this.spec,t.spec)},Fe.is=function(t){return t.type instanceof Fe};var ki=function(t,n){this.spec=n||or,this.attrs=t};ki.prototype.map=function(t,n,r,i){var o=t.mapResult(n.from+i,1);if(o.deleted)return null;var s=t.mapResult(n.to+i,-1);return s.deleted||s.pos<=o.pos?null:new Ft(o.pos-r,s.pos-r,this)},ki.prototype.valid=function(t,n){var s,r=t.content.findIndex(n.from),o=r.offset;return o==n.from&&!(s=t.child(r.index)).isText&&o+s.nodeSize==n.to},ki.prototype.eq=function(t){return this==t||t instanceof ki&&Ti(this.attrs,t.attrs)&&Ti(this.spec,t.spec)};var Ft=function(t,n,r){this.from=t,this.to=n,this.type=r},Xs={spec:{configurable:!0},inline:{configurable:!0}};Ft.prototype.copy=function(t,n){return new Ft(t,n,this.type)},Ft.prototype.eq=function(t,n){return void 0===n&&(n=0),this.type.eq(t.type)&&this.from+n==t.from&&this.to+n==t.to},Ft.prototype.map=function(t,n,r){return this.type.map(t,this,n,r)},Ft.widget=function(t,n,r){return new Ft(t,t,new Rr(n,r))},Ft.inline=function(t,n,r,i){return new Ft(t,n,new Fe(r,i))},Ft.node=function(t,n,r,i){return new Ft(t,n,new ki(r,i))},Xs.spec.get=function(){return this.type.spec},Xs.inline.get=function(){return this.type instanceof Fe},Object.defineProperties(Ft.prototype,Xs);var yo=[],or={},yt=function(t,n){this.local=t&&t.length?t:yo,this.children=n&&n.length?n:yo};yt.create=function(t,n){return n.length?bo(n,t,0,or):zt},yt.prototype.find=function(t,n,r){var i=[];return this.findInner(null==t?0:t,null==n?1e9:n,i,0,r),i},yt.prototype.findInner=function(t,n,r,i,o){for(var s=0;s<this.local.length;s++){var c=this.local[s];c.from<=n&&c.to>=t&&(!o||o(c.spec))&&r.push(c.copy(c.from+i,c.to+i))}for(var l=0;l<this.children.length;l+=3)if(this.children[l]<n&&this.children[l+1]>t){var u=this.children[l]+1;this.children[l+2].findInner(t-u,n-u,r,i+u,o)}},yt.prototype.map=function(t,n,r){return this==zt||0==t.maps.length?this:this.mapInner(t,n,0,0,r||or)},yt.prototype.mapInner=function(t,n,r,i,o){for(var s,c=0;c<this.local.length;c++){var l=this.local[c].map(t,r,i);l&&l.type.valid(n,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[c].spec)}return this.children.length?function Af(e,t,n,r,i,o,s){for(var c=e.slice(),l=function(ct,ft,mt,Zt){for(var xt=0;xt<c.length;xt+=3){var lt=c[xt+1],Pt=void 0;-1==lt||ct>lt+o||(ft>=c[xt]+o?c[xt+1]=-1:mt>=i&&(Pt=Zt-mt-(ft-ct))&&(c[xt]+=Pt,c[xt+1]+=Pt))}},u=0;u<n.maps.length;u++)n.maps[u].forEach(l);for(var p=!1,f=0;f<c.length;f+=3)if(-1==c[f+1]){var d=n.map(e[f]+o),g=d-i;if(g<0||g>=r.content.size){p=!0;continue}var _=n.map(e[f+1]+o,-1)-i,C=r.content.findIndex(g),M=C.offset,B=r.maybeChild(C.index);if(B&&M==g&&M+B.nodeSize==_){var b=c[f+2].mapInner(n,B,d+1,e[f]+o+1,s);b!=zt?(c[f]=g,c[f+1]=_,c[f+2]=b):(c[f+1]=-2,p=!0)}else p=!0}if(p){var P=function Ef(e,t,n,r,i,o,s){function c(u,p){for(var f=0;f<u.local.length;f++){var d=u.local[f].map(r,i,p);d?n.push(d):s.onRemove&&s.onRemove(u.local[f].spec)}for(var g=0;g<u.children.length;g+=3)c(u.children[g+2],u.children[g]+p+1)}for(var l=0;l<e.length;l+=3)-1==e[l+1]&&c(e[l+2],t[l]+o+1);return n}(c,e,t||[],n,i,o,s),D=bo(P,r,0,s);t=D.local;for(var J=0;J<c.length;J+=3)c[J+1]<0&&(c.splice(J,3),J-=3);for(var j=0,X=0;j<D.children.length;j+=3){for(var nt=D.children[j];X<c.length&&c[X]<nt;)X+=3;c.splice(X,0,D.children[j],D.children[j+1],D.children[j+2])}}return new yt(t&&t.sort(sr),c)}(this.children,s,t,n,r,i,o):s?new yt(s.sort(sr)):zt},yt.prototype.add=function(t,n){return n.length?this==zt?yt.create(t,n):this.addInner(t,n,0):this},yt.prototype.addInner=function(t,n,r){var o,i=this,s=0;t.forEach(function(u,p){var d,f=p+r;if(d=sl(n,u,f)){for(o||(o=i.children.slice());s<o.length&&o[s]<p;)s+=3;o[s]==p?o[s+2]=o[s+2].addInner(u,d,f+1):o.splice(s,0,p,p+u.nodeSize,bo(d,u,f+1,or)),s+=3}});for(var c=ol(s?al(n):n,-r),l=0;l<c.length;l++)c[l].type.valid(t,c[l])||c.splice(l--,1);return new yt(c.length?this.local.concat(c).sort(sr):this.local,o||this.children)},yt.prototype.remove=function(t){return 0==t.length||this==zt?this:this.removeInner(t,0)},yt.prototype.removeInner=function(t,n){for(var r=this.children,i=this.local,o=0;o<r.length;o+=3){for(var s=void 0,c=r[o]+n,l=r[o+1]+n,u=0,p=void 0;u<t.length;u++)(p=t[u])&&p.from>c&&p.to<l&&(t[u]=null,(s||(s=[])).push(p));if(s){r==this.children&&(r=this.children.slice());var f=r[o+2].removeInner(s,c+1);f!=zt?r[o+2]=f:(r.splice(o,3),o-=3)}}if(i.length)for(var d=0,g=void 0;d<t.length;d++)if(g=t[d])for(var y=0;y<i.length;y++)i[y].eq(g,n)&&(i==this.local&&(i=this.local.slice()),i.splice(y--,1));return r==this.children&&i==this.local?this:i.length||r.length?new yt(i,r):zt},yt.prototype.forChild=function(t,n){if(this==zt)return this;if(n.isLeaf)return yt.empty;for(var r,i,o=0;o<this.children.length;o+=3)if(this.children[o]>=t){this.children[o]==t&&(r=this.children[o+2]);break}for(var s=t+1,c=s+n.content.size,l=0;l<this.local.length;l++){var u=this.local[l];if(u.from<c&&u.to>s&&u.type instanceof Fe){var p=Math.max(s,u.from)-s,f=Math.min(c,u.to)-s;p<f&&(i||(i=[])).push(u.copy(p,f))}}if(i){var d=new yt(i.sort(sr));return r?new Se([d,r]):d}return r||zt},yt.prototype.eq=function(t){if(this==t)return!0;if(!(t instanceof yt)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(var n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(var r=0;r<this.children.length;r+=3)if(this.children[r]!=t.children[r]||this.children[r+1]!=t.children[r+1]||!this.children[r+2].eq(t.children[r+2]))return!1;return!0},yt.prototype.locals=function(t){return Gs(this.localsInner(t))},yt.prototype.localsInner=function(t){if(this==zt)return yo;if(t.inlineContent||!this.local.some(Fe.is))return this.local;for(var n=[],r=0;r<this.local.length;r++)this.local[r].type instanceof Fe||n.push(this.local[r]);return n};var zt=new yt;yt.empty=zt,yt.removeOverlap=Gs;var Se=function(t){this.members=t};function ol(e,t){if(!t||!e.length)return e;for(var n=[],r=0;r<e.length;r++){var i=e[r];n.push(new Ft(i.from+t,i.to+t,i.type))}return n}function sl(e,t,n){if(t.isLeaf)return null;for(var r=n+t.nodeSize,i=null,o=0,s=void 0;o<e.length;o++)(s=e[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),e[o]=null);return i}function al(e){for(var t=[],n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function bo(e,t,n,r){var i=[],o=!1;t.forEach(function(l,u){var p=sl(e,l,u+n);if(p){o=!0;var f=bo(p,l,n+u+1,r);f!=zt&&i.push(u,u+l.nodeSize,f)}});for(var s=ol(o?al(e):e,-n).sort(sr),c=0;c<s.length;c++)s[c].type.valid(t,s[c])||(r.onRemove&&r.onRemove(s[c].spec),s.splice(c--,1));return s.length||i.length?new yt(s,i):zt}function sr(e,t){return e.from-t.from||e.to-t.to}function Gs(e){for(var t=e,n=0;n<t.length-1;n++){var r=t[n];if(r.from!=r.to)for(var i=n+1;i<t.length;i++){var o=t[i];if(o.from!=r.from){o.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,o.from),cl(t,i,r.copy(o.from,r.to)));break}o.to!=r.to&&(t==e&&(t=e.slice()),t[i]=o.copy(o.from,r.to),cl(t,i+1,o.copy(r.to,o.to)))}}return t}function cl(e,t,n){for(;t<e.length&&sr(n,e[t])>0;)t++;e.splice(t,0,n)}function $s(e){var t=[];return e.someProp("decorations",function(n){var r=n(e.state);r&&r!=zt&&t.push(r)}),e.cursorWrapper&&t.push(yt.create(e.state.doc,[e.cursorWrapper.deco])),Se.from(t)}Se.prototype.map=function(t,n){var r=this.members.map(function(i){return i.map(t,n,or)});return Se.from(r)},Se.prototype.forChild=function(t,n){if(n.isLeaf)return yt.empty;for(var r=[],i=0;i<this.members.length;i++){var o=this.members[i].forChild(t,n);o!=zt&&(o instanceof Se?r=r.concat(o.members):r.push(o))}return Se.from(r)},Se.prototype.eq=function(t){if(!(t instanceof Se)||t.members.length!=this.members.length)return!1;for(var n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0},Se.prototype.locals=function(t){for(var n,r=!0,i=0;i<this.members.length;i++){var o=this.members[i].localsInner(t);if(o.length)if(n){r&&(n=n.slice(),r=!1);for(var s=0;s<o.length;s++)n.push(o[s])}else n=o}return n?Gs(r?n:n.sort(sr)):yo},Se.from=function(t){switch(t.length){case 0:return zt;case 1:return t[0];default:return new Se(t)}};var It=function(t,n){this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(dl),this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):t.apply?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=pl(this),this.markCursor=null,this.cursorWrapper=null,ul(this),this.nodeViews=fl(this),this.docView=Cc(this.state.doc,ll(this),$s(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function ff(e){e.shiftKey=!1,e.mouseDown=null,e.lastKeyCode=null,e.lastKeyCodeTime=0,e.lastClick={time:0,x:0,y:0,type:""},e.lastSelectionOrigin=null,e.lastSelectionTime=0,e.lastIOSEnter=0,e.lastIOSEnterFallbackTimeout=null,e.lastAndroidDelete=0,e.composing=!1,e.composingTimeout=null,e.compositionNodes=[],e.compositionEndedAt=-2e8,e.domObserver=new Ce(e,function(r,i,o,s){return function tf(e,t,n,r,i){if(t<0){var o=e.lastSelectionTime>Date.now()-50?e.lastSelectionOrigin:null,s=Ec(e,o);if(s&&!e.state.selection.eq(s)){var c=e.state.tr.setSelection(s);"pointer"==o?c.setMeta("pointer",!0):"key"==o&&c.scrollIntoView(),e.dispatch(c)}}else{var l=e.state.doc.resolve(t),u=l.sharedDepth(n);t=l.before(u+1),n=e.state.doc.resolve(n).after(u+1);var p=e.state.selection,f=function Gp(e,t,n){var r=e.docView.parseRange(t,n),i=r.node,o=r.fromOffset,s=r.toOffset,c=r.from,l=r.to,u=e.root.getSelection(),p=null,f=u.anchorNode;if(f&&e.dom.contains(1==f.nodeType?f:f.parentNode)&&(p=[{node:f,offset:u.anchorOffset}],As(u)||p.push({node:u.focusNode,offset:u.focusOffset})),q.chrome&&8===e.lastKeyCode)for(var d=s;d>o;d--){var g=i.childNodes[d-1],y=g.pmViewDesc;if("BR"==g.nodeName&&!y){s=d;break}if(!y||y.size)break}var _=e.state.doc,C=e.someProp("domParser")||Yt.fromSchema(e.state.schema),k=_.resolve(c),M=null,B=C.parse(i,{topNode:k.parent,topMatch:k.parent.contentMatchAt(k.index()),topOpen:!0,from:o,to:s,preserveWhitespace:"pre"!=k.parent.type.whitespace||"full",editableContent:!0,findPositions:p,ruleFromNode:$p,context:k});if(p&&null!=p[0].pos){var b=p[0].pos,P=p[1]&&p[1].pos;null==P&&(P=b),M={anchor:b+c,head:P+c}}return{doc:B,sel:M,from:c,to:l}}(e,t,n);if(q.chrome&&e.cursorWrapper&&f.sel&&f.sel.anchor==e.cursorWrapper.deco.from){var d=e.cursorWrapper.deco.type.toDOM.nextSibling,g=d&&d.nodeValue?d.nodeValue.length:1;f.sel={anchor:f.sel.anchor+g,head:f.sel.anchor+g}}var C,k,y=e.state.doc,_=y.slice(f.from,f.to);8===e.lastKeyCode&&Date.now()-100<e.lastKeyCodeTime?(C=e.state.selection.to,k="end"):(C=e.state.selection.from,k="start"),e.lastKeyCode=null;var M=function rf(e,t,n,r,i){var o=e.findDiffStart(t,n);if(null==o)return null;var s=e.findDiffEnd(t,n+e.size,n+t.size),c=s.a,l=s.b;return"end"==i&&(r-=c+Math.max(0,o-Math.min(c,l))-o),c<o&&e.size<t.size?(l=(o-=r<=o&&r>=c?o-r:0)+(l-c),c=o):l<o&&(c=(o-=r<=o&&r>=l?o-r:0)+(c-l),l=o),{start:o,endA:c,endB:l}}(_.content,f.doc.content,f.from,C,k);if(!M){if(!(r&&p instanceof at&&!p.empty&&p.$head.sameParent(p.$anchor))||e.composing||f.sel&&f.sel.anchor!=f.sel.head){if((q.ios&&e.lastIOSEnter>Date.now()-225||q.android)&&i.some(function(lt){return"DIV"==lt.nodeName||"P"==lt.nodeName})&&e.someProp("handleKeyDown",function(lt){return lt(e,Nr(13,"Enter"))}))return void(e.lastIOSEnter=0);if(f.sel){var B=Vc(e,e.state.doc,f.sel);B&&!B.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(B))}return}M={start:p.from,endA:p.to,endB:p.to}}e.domChangeCount++,e.state.selection.from<e.state.selection.to&&M.start==M.endB&&e.state.selection instanceof at&&(M.start>e.state.selection.from&&M.start<=e.state.selection.from+2&&e.state.selection.from>=f.from?M.start=e.state.selection.from:M.endA<e.state.selection.to&&M.endA>=e.state.selection.to-2&&e.state.selection.to<=f.to&&(M.endB+=e.state.selection.to-M.endA,M.endA=e.state.selection.to)),q.ie&&q.ie_version<=11&&M.endB==M.start+1&&M.endA==M.start&&M.start>f.from&&" \xa0"==f.doc.textBetween(M.start-f.from-1,M.start-f.from+1)&&(M.start--,M.endA--,M.endB--);var J,b=f.doc.resolveNoCache(M.start-f.from),P=f.doc.resolveNoCache(M.endB-f.from),D=b.sameParent(P)&&b.parent.inlineContent;if((q.ios&&e.lastIOSEnter>Date.now()-225&&(!D||i.some(function(lt){return"DIV"==lt.nodeName||"P"==lt.nodeName}))||!D&&b.pos<f.doc.content.size&&(J=tt.findFrom(f.doc.resolve(b.pos+1),1,!0))&&J.head==P.pos)&&e.someProp("handleKeyDown",function(lt){return lt(e,Nr(13,"Enter"))}))e.lastIOSEnter=0;else if(e.state.selection.anchor>M.start&&function nf(e,t,n,r,i){if(!r.parent.isTextblock||n-t<=i.pos-r.pos||Vs(r,!0,!1)<i.pos)return!1;var o=e.resolve(t);if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;var s=e.resolve(Vs(o,!0,!0));return!(!s.parent.isTextblock||s.pos>n||Vs(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(y,M.start,M.endA,b,P)&&e.someProp("handleKeyDown",function(lt){return lt(e,Nr(8,"Backspace"))}))q.android&&q.chrome&&e.domObserver.suppressSelectionUpdates();else{q.chrome&&q.android&&M.toB==M.from&&(e.lastAndroidDelete=Date.now()),q.android&&!D&&b.start()!=P.start()&&0==P.parentOffset&&b.depth==P.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==M.endA&&(M.endB-=2,P=f.doc.resolveNoCache(M.endB-f.from),setTimeout(function(){e.someProp("handleKeyDown",function(lt){return lt(e,Nr(13,"Enter"))})},20));var nt,ct,ft,mt,j=M.start,X=M.endA;if(D)if(b.pos==P.pos)q.ie&&q.ie_version<=11&&0==b.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(function(){return Zn(e)},20)),nt=e.state.tr.delete(j,X),ct=y.resolve(M.start).marksAcross(y.resolve(M.endA));else if(M.endA==M.endB&&(mt=y.resolve(M.start))&&(ft=function ef(e,t){for(var s,c,l,n=e.firstChild.marks,r=t.firstChild.marks,i=n,o=r,u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(var p=0;p<n.length;p++)o=n[p].removeFromSet(o);if(1==i.length&&0==o.length)c=i[0],s="add",l=function(g){return g.mark(c.addToSet(g.marks))};else{if(0!=i.length||1!=o.length)return null;c=o[0],s="remove",l=function(g){return g.mark(c.removeFromSet(g.marks))}}for(var f=[],d=0;d<t.childCount;d++)f.push(l(t.child(d)));if(R.from(f).eq(e))return{mark:c,type:s}}(b.parent.content.cut(b.parentOffset,P.parentOffset),mt.parent.content.cut(mt.parentOffset,M.endA-mt.start()))))nt=e.state.tr,"add"==ft.type?nt.addMark(j,X,ft.mark):nt.removeMark(j,X,ft.mark);else if(b.parent.child(b.index()).isText&&b.index()==P.index()-(P.textOffset?0:1)){var Zt=b.parent.textBetween(b.parentOffset,P.parentOffset);if(e.someProp("handleTextInput",function(lt){return lt(e,j,X,Zt)}))return;nt=e.state.tr.insertText(Zt,j,X)}if(nt||(nt=e.state.tr.replace(j,X,f.doc.slice(M.start-f.from,M.endB-f.from))),f.sel){var xt=Vc(e,nt.doc,f.sel);xt&&!(q.chrome&&q.android&&e.composing&&xt.empty&&(M.start!=M.endB||e.lastAndroidDelete<Date.now()-100)&&(xt.head==j||xt.head==nt.mapping.map(X)-1)||q.ie&&xt.empty&&xt.head==j)&&nt.setSelection(xt)}ct&&nt.ensureMarks(ct),e.dispatch(nt.scrollIntoView())}}}(e,r,i,o,s)}),e.domObserver.start(),e.domChangeCount=0,e.eventHandlers=Object.create(null);var t=function(r){var i=pe[r];e.dom.addEventListener(r,e.eventHandlers[r]=function(o){(function hf(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0})(e,o)&&!Ws(e,o)&&(e.editable||!(o.type in oe))&&i(e,o)})};for(var n in pe)t(n);q.safari&&e.dom.addEventListener("input",function(){return null}),js(e)}(this),this.prevDirectPlugins=[],this.pluginViews=[],this.updatePluginViews()},_o={props:{configurable:!0},root:{configurable:!0},isDestroyed:{configurable:!0}};function ll(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),t.translate="no",e.someProp("attributes",function(n){if("function"==typeof n&&(n=n(e.state)),n)for(var r in n)"class"==r&&(t.class+=" "+n[r]),"style"==r?t.style=(t.style?t.style+";":"")+n[r]:!t[r]&&"contenteditable"!=r&&"nodeName"!=r&&(t[r]=String(n[r]))}),[Ft.node(0,e.state.doc.content.size,t)]}function ul(e){if(e.markCursor){var t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:Ft.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function pl(e){return!e.someProp("editable",function(t){return!1===t(e.state)})}function fl(e){var t={};return e.someProp("nodeViews",function(n){for(var r in n)Object.prototype.hasOwnProperty.call(t,r)||(t[r]=n[r])}),t}function dl(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}_o.props.get=function(){if(this._props.state!=this.state){var e=this._props;for(var t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props},It.prototype.update=function(t){t.handleDOMEvents!=this._props.handleDOMEvents&&js(this),this._props=t,t.plugins&&(t.plugins.forEach(dl),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)},It.prototype.setProps=function(t){var n={};for(var r in this._props)n[r]=this._props[r];for(var i in n.state=this.state,t)n[i]=t[i];this.update(n)},It.prototype.updateState=function(t){this.updateStateInner(t,this.state.plugins!=t.plugins)},It.prototype.updateStateInner=function(t,n){var r=this,i=this.state,o=!1,s=!1;if(t.storedMarks&&this.composing&&(nl(this),s=!0),this.state=t,n){var c=fl(this);(function Df(e,t){var n=0,r=0;for(var i in e){if(e[i]!=t[i])return!0;n++}for(var o in t)r++;return n!=r})(c,this.nodeViews)&&(this.nodeViews=c,o=!0),js(this)}this.editable=pl(this),ul(this);var l=$s(this),u=ll(this),p=n?"reset":t.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(t.doc,u,l);(f||!t.selection.eq(i.selection))&&(s=!0);var d="preserve"==p&&s&&null==this.dom.style.overflowAnchor&&function Cp(e){for(var r,i,t=e.dom.getBoundingClientRect(),n=Math.max(0,t.top),o=(t.left+t.right)/2,s=n+1;s<Math.min(innerHeight,t.bottom);s+=5){var c=e.root.elementFromPoint(o,s);if(c!=e.dom&&e.dom.contains(c)){var l=c.getBoundingClientRect();if(l.top>=n-20){r=c,i=l.top;break}}}return{refDOM:r,refTop:i,stack:fc(e.dom)}}(this);if(s){this.domObserver.stop();var g=f&&(q.ie||q.chrome)&&!this.composing&&!i.selection.empty&&!t.selection.empty&&function Nf(e,t){var n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(i.selection,t.selection);if(f){var y=q.chrome?this.trackWrites=this.root.getSelection().focusNode:null;(o||!this.docView.update(t.doc,u,l,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=Cc(t.doc,u,l,this.dom,this)),y&&!this.trackWrites&&(g=!0)}g||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&function Yp(e){var t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.root.getSelection();return yi(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?Zn(this,g):(Rc(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(i),"reset"==p)this.dom.scrollTop=0;else if("to selection"==p){var _=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",function(C){return C(r)})||function pc(e,t,n){for(var r=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,o=e.dom.ownerDocument,s=n||e.dom;s;s=Os(s))if(1==s.nodeType){var c=s==o.body||1!=s.nodeType,l=c?xp(o):wp(s),u=0,p=0;if(t.top<l.top+In(r,"top")?p=-(l.top-t.top+In(i,"top")):t.bottom>l.bottom-In(r,"bottom")&&(p=t.bottom-l.bottom+In(i,"bottom")),t.left<l.left+In(r,"left")?u=-(l.left-t.left+In(i,"left")):t.right>l.right-In(r,"right")&&(u=t.right-l.right+In(i,"right")),u||p)if(c)o.defaultView.scrollBy(u,p);else{var f=s.scrollLeft,d=s.scrollTop;p&&(s.scrollTop+=p),u&&(s.scrollLeft+=u);var g=s.scrollLeft-f,y=s.scrollTop-d;t={left:t.left-g,top:t.top-y,right:t.right-g,bottom:t.bottom-y}}if(c)break}}(this,t.selection instanceof et?this.docView.domAfterPos(t.selection.from).getBoundingClientRect():this.coordsAtPos(t.selection.head,1),_)}else d&&function Tp(e){var t=e.refDOM,n=e.refTop,r=e.stack,i=t?t.getBoundingClientRect().top:0;dc(r,0==i?0:i-n)}(d)},It.prototype.destroyPluginViews=function(){for(var t;t=this.pluginViews.pop();)t.destroy&&t.destroy()},It.prototype.updatePluginViews=function(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(var s=0;s<this.pluginViews.length;s++){var c=this.pluginViews[s];c.update&&c.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(var n=0;n<this.directPlugins.length;n++){var r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(var i=0;i<this.state.plugins.length;i++){var o=this.state.plugins[i];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},It.prototype.someProp=function(t,n){var i,r=this._props&&this._props[t];if(null!=r&&(i=n?n(r):r))return i;for(var o=0;o<this.directPlugins.length;o++){var s=this.directPlugins[o].props[t];if(null!=s&&(i=n?n(s):s))return i}var c=this.state.plugins;if(c)for(var l=0;l<c.length;l++){var u=c[l].props[t];if(null!=u&&(i=n?n(u):u))return i}},It.prototype.hasFocus=function(){return this.root.activeElement==this.dom},It.prototype.focus=function(){this.domObserver.stop(),this.editable&&function kp(e){if(e.setActive)return e.setActive();if(Dr)return e.focus(Dr);var t=fc(e);e.focus(null==Dr?{get preventScroll(){return Dr={preventScroll:!0},!0}}:void 0),Dr||(Dr=!1,dc(t,0))}(this.dom),Zn(this),this.domObserver.start()},_o.root.get=function(){var e=this._root;if(null==e)for(var t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=function(){return document.getSelection()}),this._root=t;return e||document},It.prototype.posAtCoords=function(t){return Ep(this,t)},It.prototype.coordsAtPos=function(t,n){return void 0===n&&(n=1),gc(this,t,n)},It.prototype.domAtPos=function(t,n){return void 0===n&&(n=0),this.docView.domFromPos(t,n)},It.prototype.nodeDOM=function(t){var n=this.docView.descAt(t);return n?n.nodeDOM:null},It.prototype.posAtDOM=function(t,n,r){void 0===r&&(r=-1);var i=this.docView.posFromDOM(t,n,r);if(null==i)throw new RangeError("DOM position not inside the editor");return i},It.prototype.endOfTextblock=function(t,n){return function Rp(e,t,n){return yc==t&&bc==n?_c:(yc=t,bc=n,_c="up"==n||"down"==n?function Dp(e,t,n){var r=t.selection,i="up"==n?r.$from:r.$to;return vc(e,t,function(){for(var s=e.docView.domFromPos(i.pos,"up"==n?-1:1).node;;){var c=e.docView.nearestDesc(s,!0);if(!c)break;if(c.node.isBlock){s=c.dom;break}s=c.dom.parentNode}for(var l=gc(e,i.pos,1),u=s.firstChild;u;u=u.nextSibling){var p=void 0;if(1==u.nodeType)p=u.getClientRects();else{if(3!=u.nodeType)continue;p=dn(u,0,u.nodeValue.length).getClientRects()}for(var f=0;f<p.length;f++){var d=p[f];if(d.bottom>d.top+1&&("up"==n?l.top-d.top>2*(d.bottom-l.top):d.bottom-l.bottom>2*(l.bottom-d.top)))return!1}}return!0})}(e,t,n):function Pp(e,t,n){var i=t.selection.$head;if(!i.parent.isTextblock)return!1;var o=i.parentOffset,s=!o,c=o==i.parent.content.size,l=e.root.getSelection();return Ip.test(i.parent.textContent)&&l.modify?vc(e,t,function(){var u=l.getRangeAt(0),p=l.focusNode,f=l.focusOffset,d=l.caretBidiLevel;l.modify("move",n,"character");var y=!(i.depth?e.docView.domAfterPos(i.before()):e.dom).contains(1==l.focusNode.nodeType?l.focusNode:l.focusNode.parentNode)||p==l.focusNode&&f==l.focusOffset;return l.removeAllRanges(),l.addRange(u),null!=d&&(l.caretBidiLevel=d),y}):"left"==n||"backward"==n?s:c}(e,t,n))}(this,n||this.state,t)},It.prototype.destroy=function(){!this.docView||(function df(e){for(var t in e.domObserver.stop(),e.eventHandlers)e.dom.removeEventListener(t,e.eventHandlers[t]);clearTimeout(e.composingTimeout),clearTimeout(e.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],$s(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},_o.isDestroyed.get=function(){return null==this.docView},It.prototype.dispatchEvent=function(t){return function mf(e,t){!Ws(e,t)&&pe[t.type]&&(e.editable||!(t.type in oe))&&pe[t.type](e,t)}(this,t)},It.prototype.dispatch=function(t){var n=this._props.dispatchTransaction;n?n.call(this,t):this.updateState(this.state.apply(t))},Object.defineProperties(It.prototype,_o);for(var qn={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},xo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},hl="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),If="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),Pf="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),ml="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Rf="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Zf=hl&&(ml||+hl[1]<57)||Pf&&ml,Vt=0;Vt<10;Vt++)qn[48+Vt]=qn[96+Vt]=String(Vt);for(Vt=1;Vt<=24;Vt++)qn[Vt+111]="F"+Vt;for(Vt=65;Vt<=90;Vt++)qn[Vt]=String.fromCharCode(Vt+32),xo[Vt]=String.fromCharCode(Vt);for(var ta in qn)xo.hasOwnProperty(ta)||(xo[ta]=qn[ta]);var Bf="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function Ff(e){var t=e.split(/-(?!$)/),n=t[t.length-1];"Space"==n&&(n=" ");for(var r,i,o,s,c=0;c<t.length-1;c++){var l=t[c];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);Bf?s=!0:i=!0}}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),s&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function ea(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}function gl(e){var t=function Lf(e){var t=Object.create(null);for(var n in e)t[Ff(n)]=e[n];return t}(e);return function(n,r){var s,i=function qf(e){var n=!(Zf&&(e.ctrlKey||e.altKey||e.metaKey)||(If||Rf)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?xo:qn)[e.keyCode]||e.key||"Unidentified";return"Esc"==n&&(n="Escape"),"Del"==n&&(n="Delete"),"Left"==n&&(n="ArrowLeft"),"Up"==n&&(n="ArrowUp"),"Right"==n&&(n="ArrowRight"),"Down"==n&&(n="ArrowDown"),n}(r),o=1==i.length&&" "!=i,c=t[ea(i,r,!o)];if(c&&c(n.state,n.dispatch,n))return!0;if(o&&(r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(s=qn[r.keyCode])&&s!=i){var l=t[ea(s,r,!0)];if(l&&l(n.state,n.dispatch,n))return!0}else if(o&&r.shiftKey){var u=t[ea(i,r,!0)];if(u&&u(n.state,n.dispatch,n))return!0}return!1}}function na(e){return"Object"===function Vf(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function wo(e,t){const n=Z({},e);return na(e)&&na(t)&&Object.keys(t).forEach(r=>{na(t[r])?r in e?n[r]=wo(e[r],t[r]):Object.assign(n,{[r]:t[r]}):Object.assign(n,{[r]:t[r]})}),n}function vl(e){return"function"==typeof e}function ot(e,t,...n){return vl(e)?t?e.bind(t)(...n):e(...n):e}function U(e,t,n){return void 0===e.config[t]&&e.parent?U(e.parent,t,n):"function"==typeof e.config[t]?e.config[t].bind(Xt(Z({},n),{parent:e.parent?U(e.parent,t,n):null})):e.config[t]}class se{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Z(Z({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ot(U(this,"addOptions",{name:this.name}))),this.storage=ot(U(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new se(t)}configure(t={}){const n=this.extend();return n.options=wo(this.options,t),n.storage=ot(U(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new se(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ot(U(n,"addOptions",{name:n.name})),n.storage=ot(U(n,"addStorage",{name:n.name,options:n.options})),n}}function yl(e,t,n){const{from:r,to:i}=t,{blockSeparator:o="\n\n",textSerializers:s={}}=n||{};let c="",l=!0;return e.nodesBetween(r,i,(u,p,f,d)=>{var g;const y=null==s?void 0:s[u.type.name];y?(u.isBlock&&!l&&(c+=o,l=!0),c+=y({node:u,pos:p,parent:f,index:d})):u.isText?(c+=null===(g=null==u?void 0:u.text)||void 0===g?void 0:g.slice(Math.max(r,p)-p,i-p),l=!1):u.isBlock&&!l&&(c+=o,l=!0)}),c}function ra(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const Hf=se.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new ie({key:new Te("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:i}=t,{ranges:o}=i;return yl(r,{from:Math.min(...o.map(p=>p.$from.pos)),to:Math.max(...o.map(p=>p.$to.pos))},{textSerializers:ra(n)})}}})]}});var Jf=Object.freeze({__proto__:null,blur:()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null===(n=null==window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())}),!0)}),Uf=Object.freeze({__proto__:null,clearContent:(e=!1)=>({commands:t})=>t.setContent("",e)}),jf=Object.freeze({__proto__:null,clearNodes:()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:i}=r;return n&&i.forEach(({$from:o,$to:s})=>{e.doc.nodesBetween(o.pos,s.pos,(c,l)=>{if(c.type.isText)return;const{doc:u,mapping:p}=t,f=u.resolve(p.map(l)),d=u.resolve(p.map(l+c.nodeSize)),g=f.blockRange(d);if(!g)return;const y=bt(g);if(c.type.isTextblock){const{defaultType:_}=f.parent.contentMatchAt(f.index());t.setNodeMarkup(g.start,_)}(y||0===y)&&t.lift(g,y)})}),!0}}),Wf=Object.freeze({__proto__:null,command:e=>t=>e(t)}),Yf=Object.freeze({__proto__:null,createParagraphNear:()=>({state:e,dispatch:t})=>Ga(e,t)});function Lt(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var Kf=Object.freeze({__proto__:null,deleteNode:e=>({tr:t,state:n,dispatch:r})=>{const i=Lt(e,n.schema),o=t.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),u=o.after(s);t.delete(l,u).scrollIntoView()}return!0}return!1}}),Qf=Object.freeze({__proto__:null,deleteRange:e=>({tr:t,dispatch:n})=>{const{from:r,to:i}=e;return n&&t.delete(r,i),!0}}),Xf=Object.freeze({__proto__:null,deleteSelection:()=>({state:e,dispatch:t})=>bs(e,t)}),Gf=Object.freeze({__proto__:null,enter:()=>({commands:e})=>e.keyboardShortcut("Enter")}),$f=Object.freeze({__proto__:null,exitCode:()=>({state:e,dispatch:t})=>Xa(e,t)});function Bn(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function ia(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function Co(e,t,n={strict:!0}){const r=Object.keys(t);return!r.length||r.every(i=>n.strict?t[i]===e[i]:ia(t[i])?t[i].test(e[i]):t[i]===e[i])}function oa(e,t,n={}){return e.find(r=>r.type===t&&Co(r.attrs,n))}function td(e,t,n={}){return!!oa(e,t,n)}function sa(e,t,n={}){if(!e||!t)return;const r=e.parent.childAfter(e.parentOffset);if(!r.node)return;const i=oa(r.node.marks,t,n);if(!i)return;let o=e.index(),s=e.start()+r.offset,c=o+1,l=s+r.node.nodeSize;for(oa(r.node.marks,t,n);o>0&&i.isInSet(e.parent.child(o-1).marks);)o-=1,s-=e.parent.child(o).nodeSize;for(;c<e.parent.childCount&&td(e.parent.child(c).marks,t,n);)l+=e.parent.child(c).nodeSize,c+=1;return{from:s,to:l}}var ed=Object.freeze({__proto__:null,extendMarkRange:(e,t={})=>({tr:n,state:r,dispatch:i})=>{const o=Bn(e,r.schema),{doc:s,selection:c}=n,{$from:l,from:u,to:p}=c;if(i){const f=sa(l,o,t);if(f&&f.from<=u&&f.to>=p){const d=at.create(s,f.from,f.to);n.setSelection(d)}}return!0}}),nd=Object.freeze({__proto__:null,first:e=>t=>{const n="function"==typeof e?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1}});function bl(e){return e&&"object"==typeof e&&!Array.isArray(e)&&!function rd(e){var t;return"class"===(null===(t=e.constructor)||void 0===t?void 0:t.toString().substring(0,5))}(e)}function _l(e){return bl(e)&&e instanceof at}function To(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function mn(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function xl(e,t=null){if(!t)return null;const n=tt.atStart(e),r=tt.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;const i=n.from,o=r.to;return"all"===t?at.create(e,mn(0,i,o),mn(e.content.size,i,o)):at.create(e,mn(t,i,o),mn(t,i,o))}var id=Object.freeze({__proto__:null,focus:(e=null,t)=>({editor:n,view:r,tr:i,dispatch:o})=>{t=Z({scrollIntoView:!0},t);const s=()=>{To()&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(o&&null===e&&!_l(n.state.selection))return s(),!0;const c=xl(n.state.doc,e)||n.state.selection,l=n.state.selection.eq(c);return o&&(l||i.setSelection(c),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0}}),od=Object.freeze({__proto__:null,forEach:(e,t)=>n=>e.every((r,i)=>t(r,Xt(Z({},n),{index:i})))}),sd=Object.freeze({__proto__:null,insertContent:(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t)});function aa(e){const t=`<body>${e}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function ko(e,t,n){if(n=Z({slice:!0,parseOptions:{}},n),"object"==typeof e&&null!==e)try{return Array.isArray(e)?R.fromArray(e.map(r=>t.nodeFromJSON(r))):t.nodeFromJSON(e)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),ko("",t,n)}if("string"==typeof e){const r=Yt.fromSchema(t);return n.slice?r.parseSlice(aa(e),n.parseOptions).content:r.parse(aa(e),n.parseOptions)}return ko("",t,n)}var ld=Object.freeze({__proto__:null,insertContentAt:(e,t,n)=>({tr:r,dispatch:i,editor:o})=>{if(i){n=Z({parseOptions:{},updateSelection:!0},n);const s=ko(t,o.schema,{parseOptions:Z({preserveWhitespace:"full"},n.parseOptions)});if("<>"===s.toString())return!0;let{from:c,to:l}="number"==typeof e?{from:e,to:e}:e,u=!0,p=!0;if(((e=>e.toString().startsWith("<"))(s)?s:[s]).forEach(d=>{d.check(),u=!!u&&d.isText&&0===d.marks.length,p=!!p&&d.isBlock}),c===l&&p){const{parent:d}=r.doc.resolve(c);d.isTextblock&&!d.type.spec.code&&!d.childCount&&(c-=1,l+=1)}u?r.insertText(t,c,l):r.replaceWith(c,l,s),n.updateSelection&&function ad(e,t,n){const r=e.steps.length-1;if(r<t)return;const i=e.steps[r];if(!(i instanceof ut||i instanceof $))return;let s=0;e.mapping.maps[r].forEach((c,l,u,p)=>{0===s&&(s=p)}),e.setSelection(tt.near(e.doc.resolve(s),n))}(r,r.steps.length-1,-1)}return!0}}),ud=Object.freeze({__proto__:null,joinBackward:()=>({state:e,dispatch:t})=>Ja(e,t)}),pd=Object.freeze({__proto__:null,joinForward:()=>({state:e,dispatch:t})=>Wa(e,t)});function wl(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}var dd=Object.freeze({__proto__:null,keyboardShortcut:e=>({editor:t,view:n,tr:r,dispatch:i})=>{const o=function fd(e){const t=e.split(/-(?!$)/);let r,i,o,s,n=t[t.length-1];"Space"===n&&(n=" ");for(let c=0;c<t.length-1;c+=1){const l=t[c];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else{if(!/^mod$/i.test(l))throw new Error(`Unrecognized modifier name: ${l}`);To()||wl()?s=!0:i=!0}}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),s&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}(e).split(/-(?!$)/),s=o.find(u=>!["Alt","Ctrl","Meta","Shift"].includes(u)),c=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",u=>u(n,c))});return null==l||l.steps.forEach(u=>{const p=u.map(r.mapping);p&&i&&r.maybeStep(p)}),!0}});function Si(e,t,n={}){const{from:r,to:i,empty:o}=e.selection,s=t?Lt(t,e.schema):null,c=[];e.doc.nodesBetween(r,i,(f,d)=>{if(f.isText)return;const g=Math.max(r,d),y=Math.min(i,d+f.nodeSize);c.push({node:f,from:g,to:y})});const l=i-r,u=c.filter(f=>!s||s.name===f.node.type.name).filter(f=>Co(f.node.attrs,n,{strict:!1}));return o?!!u.length:u.reduce((f,d)=>f+d.to-d.from,0)>=l}var hd=Object.freeze({__proto__:null,lift:(e,t={})=>({state:n,dispatch:r})=>!!Si(n,Lt(e,n.schema),t)&&function Gu(e,t){var n=e.selection,o=n.$from.blockRange(n.$to),s=o&&bt(o);return null!=s&&(t&&t(e.tr.lift(o,s).scrollIntoView()),!0)}(n,r)}),md=Object.freeze({__proto__:null,liftEmptyBlock:()=>({state:e,dispatch:t})=>$a(e,t)}),gd=Object.freeze({__proto__:null,liftListItem:e=>({state:t,dispatch:n})=>function hp(e){return function(t,n){var r=t.selection,i=r.$from,s=i.blockRange(r.$to,function(c){return c.childCount&&c.firstChild.type==e});return!!s&&(!n||(i.node(s.depth-1).type==e?function mp(e,t,n,r){var i=e.tr,o=r.end,s=r.$to.end(r.depth);return o<s&&(i.step(new $(o-1,s,o,s,new V(R.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new ve(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth)),t(i.lift(r,bt(r)).scrollIntoView()),!0}(t,n,e,s):function gp(e,t,n){for(var r=e.tr,i=n.parent,o=n.end,s=n.endIndex-1,c=n.startIndex;s>c;s--)o-=i.child(s).nodeSize,r.delete(o-1,o+1);var l=r.doc.resolve(n.start),u=l.nodeAfter;if(r.mapping.map(n.end)!=n.start+l.nodeAfter.nodeSize)return!1;var p=0==n.startIndex,f=n.endIndex==i.childCount,d=l.node(-1),g=l.index(-1);if(!d.canReplace(g+(p?0:1),g+1,u.content.append(f?R.empty:R.from(i))))return!1;var y=l.pos,_=y+u.nodeSize;return r.step(new $(y-(p?1:0),_+(f?1:0),y+1,_-1,new V((p?R.empty:R.from(i.copy(R.empty))).append(f?R.empty:R.from(i.copy(R.empty))),p?0:1,f?0:1),p?0:1)),t(r.scrollIntoView()),!0}(t,n,s)))}}(Lt(e,t.schema))(t,n)}),vd=Object.freeze({__proto__:null,newlineInCode:()=>({state:e,dispatch:t})=>Qa(e,t)});function So(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Cl(e,t){const n="string"==typeof t?[t]:t;return Object.keys(e).reduce((r,i)=>(n.includes(i)||(r[i]=e[i]),r),{})}var yd=Object.freeze({__proto__:null,resetAttributes:(e,t)=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const c=So("string"==typeof e?e:e.name,r.schema);return!!c&&("node"===c&&(o=Lt(e,r.schema)),"mark"===c&&(s=Bn(e,r.schema)),i&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(u,p)=>{o&&o===u.type&&n.setNodeMarkup(p,void 0,Cl(u.attrs,t)),s&&u.marks.length&&u.marks.forEach(f=>{s===f.type&&n.addMark(p,p+u.nodeSize,s.create(Cl(f.attrs,t)))})})}),!0)}}),bd=Object.freeze({__proto__:null,scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0)}),_d=Object.freeze({__proto__:null,selectAll:()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size})}),xd=Object.freeze({__proto__:null,selectNodeBackward:()=>({state:e,dispatch:t})=>Ua(e,t)}),wd=Object.freeze({__proto__:null,selectNodeForward:()=>({state:e,dispatch:t})=>Ya(e,t)}),Cd=Object.freeze({__proto__:null,selectParentNode:()=>({state:e,dispatch:t})=>function $u(e,t){var o,n=e.selection,r=n.$from,s=r.sharedDepth(n.to);return 0!=s&&(o=r.before(s),t&&t(e.tr.setSelection(et.create(e.doc,o))),!0)}(e,t)}),Td=Object.freeze({__proto__:null,selectTextblockEnd:()=>({state:e,dispatch:t})=>ic(e,t)}),kd=Object.freeze({__proto__:null,selectTextblockStart:()=>({state:e,dispatch:t})=>rc(e,t)});function Tl(e,t,n={}){return ko(e,t,{slice:!1,parseOptions:n})}var Sd=Object.freeze({__proto__:null,setContent:(e,t=!1,n={})=>({tr:r,editor:i,dispatch:o})=>{const{doc:s}=r,c=Tl(e,i.schema,n),l=at.create(s,0,s.content.size);return o&&r.setSelection(l).replaceSelectionWith(c,!1).setMeta("preventUpdate",!t),!0}});function kl(e,t){const n=Bn(t,e.schema),{from:r,to:i,empty:o}=e.selection,s=[];o?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const c=s.find(l=>l.type.name===n.name);return c?Z({},c.attrs):{}}var Md=Object.freeze({__proto__:null,setMark:(e,t={})=>({tr:n,state:r,dispatch:i})=>{const{selection:o}=n,{empty:s,ranges:c}=o,l=Bn(e,r.schema);if(i)if(s){const u=kl(r,l);n.addStoredMark(l.create(Z(Z({},u),t)))}else c.forEach(u=>{const p=u.$from.pos,f=u.$to.pos;r.doc.nodesBetween(p,f,(d,g)=>{const y=Math.max(g,p),_=Math.min(g+d.nodeSize,f);d.marks.find(k=>k.type===l)?d.marks.forEach(k=>{l===k.type&&n.addMark(y,_,l.create(Z(Z({},k.attrs),t)))}):n.addMark(y,_,l.create(t))})});return!0}}),Od=Object.freeze({__proto__:null,setMeta:(e,t)=>({tr:n})=>(n.setMeta(e,t),!0)}),Ad=Object.freeze({__proto__:null,setNode:(e,t={})=>({state:n,dispatch:r,chain:i})=>{const o=Lt(e,n.schema);return o.isTextblock?i().command(({commands:s})=>!!oc(o,t)(n)||s.clearNodes()).command(({state:s})=>oc(o,t)(s,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}}),Ed=Object.freeze({__proto__:null,setNodeSelection:e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,i=tt.atStart(r).from,o=tt.atEnd(r).to,s=mn(e,i,o),c=et.create(r,s);t.setSelection(c)}return!0}}),Nd=Object.freeze({__proto__:null,setTextSelection:e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,{from:i,to:o}="number"==typeof e?{from:e,to:e}:e,s=at.atStart(r).from,c=at.atEnd(r).to,l=mn(i,s,c),u=mn(o,s,c),p=at.create(r,l,u);t.setSelection(p)}return!0}}),Dd=Object.freeze({__proto__:null,sinkListItem:e=>({state:t,dispatch:n})=>function vp(e){return function(t,n){var r=t.selection,s=r.$from.blockRange(r.$to,function(_){return _.childCount&&_.firstChild.type==e});if(!s)return!1;var c=s.startIndex;if(0==c)return!1;var l=s.parent,u=l.child(c-1);if(u.type!=e)return!1;if(n){var p=u.lastChild&&u.lastChild.type==l.type,f=R.from(p?e.create():null),d=new V(R.from(e.create(null,R.from(l.type.create(null,f)))),p?3:1,0),g=s.start,y=s.end;n(t.tr.step(new $(g-(p?3:1),y,g,y,d,1,!0)).scrollIntoView())}return!0}}(Lt(e,t.schema))(t,n)});function Mo(e,t,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=e.find(o=>o.type===t&&o.name===r);return!!i&&i.attribute.keepOnSplit}))}function Sl(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(i=>null==t?void 0:t.includes(i.type.name));e.tr.ensureMarks(r)}}var Pd=Object.freeze({__proto__:null,splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:i})=>{const{selection:o,doc:s}=t,{$from:c,$to:l}=o,p=Mo(i.extensionManager.attributes,c.node().type.name,c.node().attrs);if(o instanceof et&&o.node.isBlock)return!(!c.parentOffset||!Mt(s,c.pos)||(r&&(e&&Sl(n,i.extensionManager.splittableMarks),t.split(c.pos).scrollIntoView()),0));if(!c.parent.isBlock)return!1;if(r){const f=l.parentOffset===l.parent.content.size;o instanceof at&&t.deleteSelection();const d=0===c.depth?void 0:function Id(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(c.node(-1).contentMatchAt(c.indexAfter(-1)));let g=f&&d?[{type:d,attrs:p}]:void 0,y=Mt(t.doc,t.mapping.map(c.pos),1,g);if(!g&&!y&&Mt(t.doc,t.mapping.map(c.pos),1,d?[{type:d}]:void 0)&&(y=!0,g=d?[{type:d,attrs:p}]:void 0),y&&(t.split(t.mapping.map(c.pos),1,g),d&&!f&&!c.parentOffset&&c.parent.type!==d)){const _=t.mapping.map(c.before()),C=t.doc.resolve(_);c.node(-1).canReplaceWith(C.index(),C.index()+1,d)&&t.setNodeMarkup(t.mapping.map(c.before()),d)}e&&Sl(n,i.extensionManager.splittableMarks),t.scrollIntoView()}return!0}}),Rd=Object.freeze({__proto__:null,splitListItem:e=>({tr:t,state:n,dispatch:r,editor:i})=>{var o;const s=Lt(e,n.schema),{$from:c,$to:l}=n.selection,u=n.selection.node;if(u&&u.isBlock||c.depth<2||!c.sameParent(l))return!1;const p=c.node(-1);if(p.type!==s)return!1;const f=i.extensionManager.attributes;if(0===c.parent.content.size&&c.node(-1).childCount===c.indexAfter(-1)){if(2===c.depth||c.node(-3).type!==s||c.index(-2)!==c.node(-2).childCount-1)return!1;if(r){let C=R.empty;const k=c.index(-1)?1:c.index(-2)?2:3;for(let J=c.depth-k;J>=c.depth-3;J-=1)C=R.from(c.node(J).copy(C));const M=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,B=Mo(f,c.node().type.name,c.node().attrs),b=(null===(o=s.contentMatch.defaultType)||void 0===o?void 0:o.createAndFill(B))||void 0;C=C.append(R.from(s.createAndFill(null,b)||void 0));const P=c.before(c.depth-(k-1));t.replace(P,c.after(-M),new V(C,4-k,0));let D=-1;t.doc.nodesBetween(P,t.doc.content.size,(J,j)=>{if(D>-1)return!1;J.isTextblock&&0===J.content.size&&(D=j+1)}),D>-1&&t.setSelection(at.near(t.doc.resolve(D))),t.scrollIntoView()}return!0}const d=l.pos===c.end()?p.contentMatchAt(0).defaultType:null,g=Mo(f,p.type.name,p.attrs),y=Mo(f,c.node().type.name,c.node().attrs);t.delete(c.pos,l.pos);const _=d?[{type:s,attrs:g},{type:d,attrs:y}]:[{type:s,attrs:g}];return!!Mt(t.doc,c.pos,2)&&(r&&t.split(c.pos,2,_).scrollIntoView(),!0)}});function ca(e){return t=>function Zd(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}(t.$from,e)}function Oo(e){return{baseExtensions:e.filter(i=>"extension"===i.type),nodeExtensions:e.filter(i=>"node"===i.type),markExtensions:e.filter(i=>"mark"===i.type)}}function Ml(e,t){const{nodeExtensions:n}=Oo(t),r=n.find(s=>s.name===e);if(!r)return!1;const o=ot(U(r,"group",{name:r.name,options:r.options,storage:r.storage}));return"string"==typeof o&&o.split(" ").includes("list")}const Ol=(e,t)=>{const n=ca(s=>s.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const i=e.doc.nodeAt(r);return n.node.type===(null==i?void 0:i.type)&&ne(e.doc,n.pos)&&e.join(n.pos),!0},Al=(e,t)=>{const n=ca(s=>s.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const i=e.doc.nodeAt(r);return n.node.type===(null==i?void 0:i.type)&&ne(e.doc,r)&&e.join(r),!0};var qd=Object.freeze({__proto__:null,toggleList:(e,t)=>({editor:n,tr:r,state:i,dispatch:o,chain:s,commands:c,can:l})=>{const{extensions:u}=n.extensionManager,p=Lt(e,i.schema),f=Lt(t,i.schema),{selection:d}=i,{$from:g,$to:y}=d,_=g.blockRange(y);if(!_)return!1;const C=ca(k=>Ml(k.type.name,u))(d);if(_.depth>=1&&C&&_.depth-C.depth<=1){if(C.node.type===p)return c.liftListItem(f);if(Ml(C.node.type.name,u)&&p.validContent(C.node.content)&&o)return s().command(()=>(r.setNodeMarkup(C.pos,p),!0)).command(()=>Ol(r,p)).command(()=>Al(r,p)).run()}return s().command(()=>!!l().wrapInList(p)||c.clearNodes()).wrapInList(p).command(()=>Ol(r,p)).command(()=>Al(r,p)).run()}});function la(e,t,n={}){const{empty:r,ranges:i}=e.selection,o=t?Bn(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(f=>!o||o.name===f.type.name).find(f=>Co(f.attrs,n,{strict:!1}));let s=0;const c=[];if(i.forEach(({$from:f,$to:d})=>{const g=f.pos,y=d.pos;e.doc.nodesBetween(g,y,(_,C)=>{if(!_.isText&&!_.marks.length)return;const k=Math.max(g,C),M=Math.min(y,C+_.nodeSize);s+=M-k,c.push(..._.marks.map(b=>({mark:b,from:k,to:M})))})}),0===s)return!1;const l=c.filter(f=>!o||o.name===f.mark.type.name).filter(f=>Co(f.mark.attrs,n,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),u=c.filter(f=>!o||f.mark.type!==o&&f.mark.type.excludes(o)).reduce((f,d)=>f+d.to-d.from,0);return(l>0?l+u:l)>=s}var Bd=Object.freeze({__proto__:null,toggleMark:(e,t={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=n,s=Bn(e,r.schema);return la(r,s,t)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,t)}}),Fd=Object.freeze({__proto__:null,toggleNode:(e,t,n={})=>({state:r,commands:i})=>{const o=Lt(e,r.schema),s=Lt(t,r.schema);return Si(r,o,n)?i.setNode(s):i.setNode(o,n)}}),Ld=Object.freeze({__proto__:null,toggleWrap:(e,t={})=>({state:n,commands:r})=>{const i=Lt(e,n.schema);return Si(n,i,t)?r.lift(i):r.wrapIn(i,t)}}),zd=Object.freeze({__proto__:null,undoInputRule:()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let o;if(i.spec.isInputRules&&(o=i.getState(e))){if(t){const s=e.tr,c=o.transform;for(let l=c.steps.length-1;l>=0;l-=1)s.step(c.steps[l].invert(c.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,e.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1}}),Vd=Object.freeze({__proto__:null,unsetAllMarks:()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:i}=n;return r||t&&i.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0}}),Hd=Object.freeze({__proto__:null,unsetMark:(e,t={})=>({tr:n,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=t,{selection:c}=n,l=Bn(e,r.schema),{$from:u,empty:p,ranges:f}=c;if(!i)return!0;if(p&&s){let{from:d,to:g}=c;const y=null===(o=u.marks().find(C=>C.type===l))||void 0===o?void 0:o.attrs,_=sa(u,l,y);_&&(d=_.from,g=_.to),n.removeMark(d,g,l)}else f.forEach(d=>{n.removeMark(d.$from.pos,d.$to.pos,l)});return n.removeStoredMark(l),!0}}),Jd=Object.freeze({__proto__:null,updateAttributes:(e,t={})=>({tr:n,state:r,dispatch:i})=>{let o=null,s=null;const c=So("string"==typeof e?e:e.name,r.schema);return!!c&&("node"===c&&(o=Lt(e,r.schema)),"mark"===c&&(s=Bn(e,r.schema)),i&&n.selection.ranges.forEach(l=>{const u=l.$from.pos,p=l.$to.pos;r.doc.nodesBetween(u,p,(f,d)=>{o&&o===f.type&&n.setNodeMarkup(d,void 0,Z(Z({},f.attrs),t)),s&&f.marks.length&&f.marks.forEach(g=>{if(s===g.type){const y=Math.max(d,u),_=Math.min(d+f.nodeSize,p);n.addMark(y,_,s.create(Z(Z({},g.attrs),t)))}})})}),!0)}}),Ud=Object.freeze({__proto__:null,wrapIn:(e,t={})=>({state:n,dispatch:r})=>function np(e,t){return function(n,r){var i=n.selection,c=i.$from.blockRange(i.$to),l=c&&_e(c,e,t);return!!l&&(r&&r(n.tr.wrap(c,l).scrollIntoView()),!0)}}(Lt(e,n.schema),t)(n,r)}),jd=Object.freeze({__proto__:null,wrapInList:(e,t={})=>({state:n,dispatch:r})=>function fp(e,t){return function(n,r){var i=n.selection,o=i.$from,s=i.$to,c=o.blockRange(s),l=!1,u=c;if(!c)return!1;if(c.depth>=2&&o.node(c.depth-1).type.compatibleContent(e)&&0==c.startIndex){if(0==o.index(c.depth-1))return!1;var p=n.doc.resolve(c.start-2);u=new ve(p,p,c.depth),c.endIndex<c.parent.childCount&&(c=new ve(o,n.doc.resolve(s.end(c.depth)),c.depth)),l=!0}var f=_e(u,e,t,c);return!!f&&(r&&r(function dp(e,t,n,r,i){for(var o=R.empty,s=n.length-1;s>=0;s--)o=R.from(n[s].type.create(n[s].attrs,o));e.step(new $(t.start-(r?2:0),t.end,t.start,t.end,new V(o,0,0),n.length,!0));for(var c=0,l=0;l<n.length;l++)n[l].type==i&&(c=l+1);for(var u=n.length-c,p=t.start+n.length-(r?2:0),f=t.parent,d=t.startIndex,g=t.endIndex,y=!0;d<g;d++,y=!1)!y&&Mt(e.doc,p,u)&&(e.split(p,u),p+=2*u),p+=f.child(d).nodeSize;return e}(n.tr,c,f,l,e).scrollIntoView()),!0)}}(Lt(e,n.schema),t)(n,r)});const Wd=se.create({name:"commands",addCommands:()=>Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z(Z({},Jf),Uf),jf),Wf),Yf),Kf),Qf),Xf),Gf),$f),ed),nd),id),od),sd),ld),ud),pd),dd),hd),md),gd),vd),yd),bd),_d),xd),wd),Cd),Td),kd),Sd),Md),Od),Ad),Ed),Nd),Dd),Pd),Rd),qd),Bd),Fd),Ld),zd),Vd),Hd),Jd),Ud),jd)}),Yd=se.create({name:"editable",addProseMirrorPlugins(){return[new ie({key:new Te("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Kd=se.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new ie({key:new Te("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}});function Ao(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:i}=n,{storedMarks:o}=n;return Xt(Z({},t),{schema:t.schema,plugins:t.plugins,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,o=n.storedMarks,n}})}class Eo{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:r}=this,{view:i}=n,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([c,l])=>[c,(...p)=>{const f=l(...p)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,c=[],l=!!t,u=t||o.tr,f=Xt(Z({},Object.fromEntries(Object.entries(r).map(([d,g])=>[d,(..._)=>{const C=this.buildProps(u,n),k=g(..._)(C);return c.push(k),f}]))),{run:()=>(!l&&n&&!u.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(u),c.every(d=>!0===d))});return f}createCan(t){const{rawCommands:n,state:r}=this,i=void 0,o=t||r.tr,s=this.buildProps(o,i),c=Object.fromEntries(Object.entries(n).map(([l,u])=>[l,(...p)=>u(...p)(Xt(Z({},s),{dispatch:i}))]));return Xt(Z({},c),{chain:()=>this.createChain(o,i)})}buildProps(t,n=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i;o.storedMarks&&t.setStoredMarks(o.storedMarks);const c={tr:t,editor:i,view:s,state:Ao({state:o,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([l,u])=>[l,(...p)=>u(...p)(c)]))}};return c}}const Qd=se.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:c})=>{const{selection:l,doc:u}=c,{empty:p,$anchor:f}=l,{pos:d,parent:g}=f,y=tt.atStart(u).from===d;return!(!(p&&y&&g.type.isTextblock)||g.textContent.length)&&s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},i=Xt(Z({},r),{Home:()=>this.editor.commands.selectTextblockStart(),End:()=>this.editor.commands.selectTextblockEnd()}),o=Xt(Z({},r),{"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return To()||wl()?o:i},addProseMirrorPlugins(){return[new ie({key:new Te("clearDocument"),appendTransaction:(e,t,n)=>{if(!e.some(y=>y.docChanged)||t.doc.eq(n.doc))return;const{empty:i,from:o,to:s}=t.selection,c=tt.atStart(t.doc).from,l=tt.atEnd(t.doc).to,u=o===c&&s===l,p=0===n.doc.textBetween(0,n.doc.content.size," "," ").length;if(i||!u||!p)return;const f=n.tr,d=Ao({state:n,transaction:f}),{commands:g}=new Eo({editor:this.editor,state:d});return g.clearNodes(),f.steps.length?f:void 0}})]}}),Xd=se.create({name:"tabindex",addProseMirrorPlugins(){return[new ie({key:new Te("tabindex"),props:{attributes:()=>{if(this.editor.isEditable)return{tabindex:"0"}}}})]}});var Gd=Object.freeze({__proto__:null,ClipboardTextSerializer:Hf,Commands:Wd,Editable:Yd,FocusEvents:Kd,Keymap:Qd,Tabindex:Xd});class Mi{constructor(t){this.find=t.find,this.handler=t.handler}}function ua(e){var t;const{editor:n,from:r,to:i,text:o,rules:s,plugin:c}=e,{view:l}=n;if(l.composing)return!1;const u=l.state.doc.resolve(r);if(u.parent.type.spec.code||(null===(t=u.nodeBefore||u.nodeAfter)||void 0===t?void 0:t.marks.find(g=>g.type.spec.code)))return!1;let p=!1;const d=u.parent.textBetween(Math.max(0,u.parentOffset-500),u.parentOffset,void 0," ")+o;return s.forEach(g=>{if(p)return;const y=((e,t)=>{if(ia(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[];return r.push(n.text),r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r})(d,g.find);if(!y)return;const _=l.state.tr,C=Ao({state:l.state,transaction:_}),k={from:r-(y[0].length-o.length),to:i},{commands:M,chain:B,can:b}=new Eo({editor:n,state:C});null===g.handler({state:C,range:k,match:y,commands:M,chain:B,can:b})||!_.steps.length||(_.setMeta(c,{transform:_,from:r,to:i,text:o}),l.dispatch(_),p=!0)}),p}function oh(e){const{editor:t,rules:n}=e,r=new ie({state:{init:()=>null,apply(i,o){return i.getMeta(this)||(i.selectionSet||i.docChanged?null:o)}},props:{handleTextInput:(i,o,s,c)=>ua({editor:t,from:o,to:s,text:c,rules:n,plugin:r}),handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&ua({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,o){if("Enter"!==o.key)return!1;const{$cursor:s}=i.state.selection;return!!s&&ua({editor:t,from:s.pos,to:s.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}class Dl{constructor(t){this.find=t.find,this.handler=t.handler}}function lh(e){const{editor:t,rules:n}=e;let r=null,i=!1,o=!1;return n.map(c=>new ie({view(l){const u=p=>{var f;r=(null===(f=l.dom.parentElement)||void 0===f?void 0:f.contains(p.target))?l.dom.parentElement:null};return window.addEventListener("dragstart",u),{destroy(){window.removeEventListener("dragstart",u)}}},props:{handleDOMEvents:{drop:l=>(o=r===l.dom.parentElement,!1),paste:(l,u)=>{var p;const f=null===(p=u.clipboardData)||void 0===p?void 0:p.getData("text/html");return i=!!(null==f?void 0:f.includes("data-pm-slice")),!1}}},appendTransaction:(l,u,p)=>{const f=l[0],d="paste"===f.getMeta("uiEvent")&&!i,g="drop"===f.getMeta("uiEvent")&&!o;if(!d&&!g)return;const y=u.doc.content.findDiffStart(p.doc.content),_=u.doc.content.findDiffEnd(p.doc.content);if(!function sh(e){return"number"==typeof e}(y)||!_||y===_.b)return;const C=p.tr,k=Ao({state:p,transaction:C});return function ch(e){const{editor:t,state:n,from:r,to:i,rule:o}=e,{commands:s,chain:c,can:l}=new Eo({editor:t,state:n}),u=[];return n.doc.nodesBetween(r,i,(f,d)=>{if(!f.isTextblock||f.type.spec.code)return;const g=Math.max(r,d),y=Math.min(i,d+f.content.size);((e,t)=>{if(ia(t))return[...e.matchAll(t)];const n=t(e);return n?n.map(r=>{const i=[];return i.push(r.text),i.index=r.index,i.input=e,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]})(f.textBetween(g-d,y-d,void 0,"\ufffc"),o.find).forEach(k=>{if(void 0===k.index)return;const M=g+k.index+1,B=M+k[0].length,b={from:n.tr.mapping.map(M),to:n.tr.mapping.map(B)},P=o.handler({state:n,range:b,match:k,commands:s,chain:c,can:l});u.push(P)})}),u.every(f=>null!==f)}({editor:t,state:k,from:Math.max(y-1,0),to:_.b,rule:c})&&C.steps.length?C:void 0}}))}function Il(e){const t=[],{nodeExtensions:n,markExtensions:r}=Oo(e),i=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return e.forEach(s=>{const l=U(s,"addGlobalAttributes",{name:s.name,options:s.options,storage:s.storage});l&&l().forEach(p=>{p.types.forEach(f=>{Object.entries(p.attributes).forEach(([d,g])=>{t.push({type:f,name:d,attribute:Z(Z({},o),g)})})})})}),i.forEach(s=>{const l=U(s,"addAttributes",{name:s.name,options:s.options,storage:s.storage});if(!l)return;const u=l();Object.entries(u).forEach(([p,f])=>{t.push({type:s.name,name:p,attribute:Z(Z({},o),f)})})}),t}function ae(...e){return e.filter(t=>!!t).reduce((t,n)=>{const r=Z({},t);return Object.entries(n).forEach(([i,o])=>{r[i]=r[i]?"class"===i?[r[i],o].join(" "):"style"===i?[r[i],o].join("; "):o:o}),r},{})}function pa(e,t){return t.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,r)=>ae(n,r),{})}function Pl(e,t){return e.style?e:Xt(Z({},e),{getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;const i=t.reduce((o,s)=>{const c=s.attribute.parseHTML?s.attribute.parseHTML(n):function ph(e){return"string"!=typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(s.name));return null==c?o:Xt(Z({},o),{[s.name]:c})},{});return Z(Z({},r),i)}})}function Rl(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>("attrs"!==t||!function uh(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(n))&&null!=n))}function fa(e,t){return t.nodes[e]||t.marks[e]||null}function ql(e,t){return Array.isArray(t)?t.some(n=>("string"==typeof n?n:n.name)===e.name):t}class ar{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=ar.resolve(t),this.schema=function Zl(e){var t;const n=Il(e),{nodeExtensions:r,markExtensions:i}=Oo(e),o=null===(t=r.find(l=>U(l,"topNode")))||void 0===t?void 0:t.name,s=Object.fromEntries(r.map(l=>{const u=n.filter(C=>C.type===l.name),p={name:l.name,options:l.options,storage:l.storage},f=e.reduce((C,k)=>{const M=U(k,"extendNodeSchema",p);return Z(Z({},C),M?M(l):{})},{}),d=Rl(Xt(Z({},f),{content:ot(U(l,"content",p)),marks:ot(U(l,"marks",p)),group:ot(U(l,"group",p)),inline:ot(U(l,"inline",p)),atom:ot(U(l,"atom",p)),selectable:ot(U(l,"selectable",p)),draggable:ot(U(l,"draggable",p)),code:ot(U(l,"code",p)),defining:ot(U(l,"defining",p)),isolating:ot(U(l,"isolating",p)),attrs:Object.fromEntries(u.map(C=>{var k;return[C.name,{default:null===(k=null==C?void 0:C.attribute)||void 0===k?void 0:k.default}]}))})),g=ot(U(l,"parseHTML",p));g&&(d.parseDOM=g.map(C=>Pl(C,u)));const y=U(l,"renderHTML",p);y&&(d.toDOM=C=>y({node:C,HTMLAttributes:pa(C,u)}));const _=U(l,"renderText",p);return _&&(d.toText=_),[l.name,d]})),c=Object.fromEntries(i.map(l=>{const u=n.filter(_=>_.type===l.name),p={name:l.name,options:l.options,storage:l.storage},f=e.reduce((_,C)=>{const k=U(C,"extendMarkSchema",p);return Z(Z({},_),k?k(l):{})},{}),d=Rl(Xt(Z({},f),{inclusive:ot(U(l,"inclusive",p)),excludes:ot(U(l,"excludes",p)),group:ot(U(l,"group",p)),spanning:ot(U(l,"spanning",p)),code:ot(U(l,"code",p)),attrs:Object.fromEntries(u.map(_=>{var C;return[_.name,{default:null===(C=null==_?void 0:_.attribute)||void 0===C?void 0:C.default}]}))})),g=ot(U(l,"parseHTML",p));g&&(d.parseDOM=g.map(_=>Pl(_,u)));const y=U(l,"renderHTML",p);return y&&(d.toDOM=_=>y({mark:_,HTMLAttributes:pa(_,u)})),[l.name,d]}));return new be({topNode:o,nodes:s,marks:c})}(this.extensions),this.extensions.forEach(r=>{var i;this.editor.extensionStorage[r.name]=r.storage;const o={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:fa(r.name,this.schema)};"mark"===r.type&&(null===(i=ot(U(r,"keepOnSplit",o)))||void 0===i||i)&&this.splittableMarks.push(r.name);const s=U(r,"onBeforeCreate",o);s&&this.editor.on("beforeCreate",s);const c=U(r,"onCreate",o);c&&this.editor.on("create",c);const l=U(r,"onUpdate",o);l&&this.editor.on("update",l);const u=U(r,"onSelectionUpdate",o);u&&this.editor.on("selectionUpdate",u);const p=U(r,"onTransaction",o);p&&this.editor.on("transaction",p);const f=U(r,"onFocus",o);f&&this.editor.on("focus",f);const d=U(r,"onBlur",o);d&&this.editor.on("blur",d);const g=U(r,"onDestroy",o);g&&this.editor.on("destroy",g)})}static resolve(t){const n=ar.sort(ar.flatten(t)),r=function fh(e){const t=e.filter((n,r)=>e.indexOf(n)!==r);return[...new Set(t)]}(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const i=U(n,"addExtensions",{name:n.name,options:n.options,storage:n.storage});return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(t){return t.sort((r,i)=>{const o=U(r,"priority")||100,s=U(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const i=U(n,"addCommands",{name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:fa(n.name,this.schema)});return i?Z(Z({},t),i()):t},{})}get plugins(){const{editor:t}=this,n=ar.sort([...this.extensions].reverse()),r=[],i=[],o=n.map(s=>{const c={name:s.name,options:s.options,storage:s.storage,editor:t,type:fa(s.name,this.schema)},l=[],u=U(s,"addKeyboardShortcuts",c);if(u){const y=function zf(e){return new ie({props:{handleKeyDown:gl(e)}})}(Object.fromEntries(Object.entries(u()).map(([_,C])=>[_,()=>C({editor:t})])));l.push(y)}const p=U(s,"addInputRules",c);ql(s,t.options.enableInputRules)&&p&&r.push(...p());const f=U(s,"addPasteRules",c);ql(s,t.options.enablePasteRules)&&f&&i.push(...f());const d=U(s,"addProseMirrorPlugins",c);if(d){const g=d();l.push(...g)}return l}).flat();return[oh({editor:t,rules:r}),...lh({editor:t,rules:i}),...o]}get attributes(){return Il(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=Oo(this.extensions);return Object.fromEntries(n.filter(r=>!!U(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:t,type:Lt(r.name,this.schema)},s=U(r,"addNodeView",o);return s?[r.name,(l,u,p,f)=>{const d=pa(l,i);return s()({editor:t,node:l,getPos:p,decorations:f,HTMLAttributes:d,extension:r})}]:[]}))}}class mh extends class dh{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const r=this.callbacks[t];return r&&r.forEach(i=>i.apply(this,n)),this}off(t,n){const r=this.callbacks[t];return r&&(n?this.callbacks[t]=r.filter(i=>i!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function rh(e){const t=document.querySelector("style[data-tiptap-style]");if(null!==t)return t;const n=document.createElement("style");return n.setAttribute("data-tiptap-style",""),n.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(n),n}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}'))}setOptions(t={}){this.options=Z(Z({},this.options),t),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const r=vl(n)?n(t,this.state.plugins):[...this.state.plugins,t],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(t){if(this.isDestroyed)return;const n="string"==typeof t?`${t}$`:t.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(n))});this.view.updateState(r)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(Gd):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(null==r?void 0:r.type));this.extensionManager=new ar(n,this)}createCommandManager(){this.commandManager=new Eo({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=Tl(this.options.content,this.schema,this.options.parseOptions),n=xl(t,this.options.autofocus);this.view=new It(this.options.element,Xt(Z({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:Qt.create({doc:t,selection:n})}));const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(s=>{var c;return null===(c=this.capturedTransaction)||void 0===c?void 0:c.step(s)}):void(this.capturedTransaction=t);const n=this.state.apply(t),r=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const i=t.getMeta("focus"),o=t.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:t}),o&&this.emit("blur",{editor:this,event:o.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return function th(e,t){const n=So("string"==typeof t?t:t.name,e.schema);return"node"===n?function $d(e,t){const n=Lt(t,e.schema),{from:r,to:i}=e.selection,o=[];e.doc.nodesBetween(r,i,c=>{o.push(c)});const s=o.reverse().find(c=>c.type.name===n.name);return s?Z({},s.attrs):{}}(e,t):"mark"===n?kl(e,t):{}}(this.state,t)}isActive(t,n){return function eh(e,t,n={}){if(!t)return Si(e,null,n)||la(e,null,n);const r=So(t,e.schema);return"node"===r?Si(e,t,n):"mark"===r&&la(e,t,n)}(this.state,"string"==typeof t?t:null,"string"==typeof t?n:t)}getJSON(){return this.state.doc.toJSON()}getHTML(){return function El(e,t){const n=Rt.fromSchema(t).serializeFragment(e),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n="\n\n",textSerializers:r={}}=t||{};return function Nl(e,t){return yl(e,{from:0,to:e.content.size},t)}(this.state.doc,{blockSeparator:n,textSerializers:Z(Z({},r),ra(this.schema))})}get isEmpty(){return function nh(e){var t;const n=null===(t=e.type.createAndFill())||void 0===t?void 0:t.toJSON(),r=e.toJSON();return JSON.stringify(n)===JSON.stringify(r)}(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}class fe{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Z(Z({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ot(U(this,"addOptions",{name:this.name}))),this.storage=ot(U(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new fe(t)}configure(t={}){const n=this.extend();return n.options=wo(this.options,t),n.storage=ot(U(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new fe(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ot(U(n,"addOptions",{name:n.name})),n.storage=ot(U(n,"addStorage",{name:n.name,options:n.options})),n}}class cr{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=Z(Z({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ot(U(this,"addOptions",{name:this.name}))),this.storage=ot(U(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new cr(t)}configure(t={}){const n=this.extend();return n.options=wo(this.options,t),n.storage=ot(U(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new cr(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=ot(U(n,"addOptions",{name:n.name})),n.storage=ot(U(n,"addStorage",{name:n.name,options:n.options})),n}}function Bl(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(i=>{const s=sa(n.resolve(e-1),i.type);!s||r.push(Z({mark:i},s))}):n.nodesBetween(e,t,(i,o)=>{r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function Zr(e){return new Mi({find:e.find,handler:({state:t,range:n,match:r})=>{const i=ot(e.getAttributes,void 0,r);if(!1===i||null===i)return null;const{tr:o}=t,s=r[r.length-1],c=r[0];let l=n.to;if(s){const u=c.search(/\S/),p=n.from+c.indexOf(s),f=p+s.length;if(Bl(n.from,n.to,t.doc).filter(g=>g.mark.type.excluded.find(_=>_===e.type&&_!==g.mark.type)).filter(g=>g.to>p).length)return null;f<n.to&&o.delete(f,n.to),p>n.from&&o.delete(n.from+u,p),l=n.from+u+s.length,o.addMark(n.from+u,l,e.type.create(i||{})),o.removeStoredMark(e.type)}}})}function da(e){return new Mi({find:e.find,handler:({state:t,range:n,match:r})=>{const i=t.doc.resolve(n.from),o=ot(e.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function ha(e){return new Mi({find:e.find,handler:({state:t,range:n,match:r})=>{const i=ot(e.getAttributes,void 0,r)||{},o=t.tr.delete(n.from,n.to),c=o.doc.resolve(n.from).blockRange(),l=c&&_e(c,e.type,i);if(!l)return null;o.wrap(c,l);const u=o.doc.resolve(n.from-1).nodeBefore;u&&u.type===e.type&&ne(o.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,u))&&o.join(n.from-1)}})}function qr(e){return new Dl({find:e.find,handler:({state:t,range:n,match:r})=>{const i=ot(e.getAttributes,void 0,r);if(!1===i||null===i)return null;const{tr:o}=t,s=r[r.length-1],c=r[0];let l=n.to;if(s){const u=c.search(/\S/),p=n.from+c.indexOf(s),f=p+s.length;if(Bl(n.from,n.to,t.doc).filter(g=>g.mark.type.excluded.find(_=>_===e.type&&_!==g.mark.type)).filter(g=>g.to>p).length)return null;f<n.to&&o.delete(f,n.to),p>n.from&&o.delete(n.from+u,p),l=n.from+u+s.length,o.addMark(n.from+u,l,e.type.create(i||{})),o.removeStoredMark(e.type)}}})}function Fl(e,t,n){const i=e.state.doc.content.size,o=mn(t,0,i),s=mn(n,0,i),c=e.coordsAtPos(o),l=e.coordsAtPos(s,-1),u=Math.min(c.top,l.top),p=Math.max(c.bottom,l.bottom),f=Math.min(c.left,l.left),d=Math.max(c.right,l.right),k={top:u,bottom:p,left:f,right:d,width:d-f,height:p-u,x:f,y:u};return Xt(Z({},k),{toJSON:()=>k})}const xh=/^\s*>\s$/,wh=fe.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",ae(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[ha({find:xh,type:this.type})]}}),Ch=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,Th=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,kh=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Sh=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Mh=cr.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],renderHTML({HTMLAttributes:e}){return["strong",ae(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Zr({find:Ch,type:this.type}),Zr({find:kh,type:this.type})]},addPasteRules(){return[qr({find:Th,type:this.type}),qr({find:Sh,type:this.type})]}}),Oh=/^\s*([-+*])\s$/,Ah=fe.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",ae(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[ha({find:Oh,type:this.type})]}}),Eh=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Nh=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Dh=cr.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",ae(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Zr({find:Eh,type:this.type})]},addPasteRules(){return[qr({find:Nh,type:this.type})]}}),Ih=/^```([a-z]+)?[\s\n]$/,Ph=/^~~~([a-z]+)?[\s\n]$/,Rh=fe.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options;return[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter(s=>s.startsWith(n)).map(s=>s.replace(n,""))[0]||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({node:e,HTMLAttributes:t}){return["pre",ae(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection;return!(!e||t.parent.type.name!==this.name)&&!(1!==t.pos&&t.parent.textContent.length)&&this.editor.commands.clearNodes()},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith("\n\n");return!(!o||!s)&&e.chain().command(({tr:c})=>(c.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:i,empty:o}=n;if(!o||i.parent.type!==this.type||i.parentOffset!==i.parent.nodeSize-2)return!1;const c=i.after();return void 0!==c&&!r.nodeAt(c)&&e.commands.exitCode()}}},addInputRules(){return[da({find:Ih,type:this.type,getAttributes:e=>({language:e[1]})}),da({find:Ph,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new ie({key:new Te("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=null==i?void 0:i.mode;if(!n||!o)return!1;const{tr:s}=e.state;return s.replaceSelectionWith(this.type.create({language:o})),s.setSelection(at.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.insertText(n.replace(/\r\n?/g,"\n")),s.setMeta("paste",!0),e.dispatch(s),!0}}})]}}),Zh=fe.create({name:"doc",topNode:!0,content:"block+"});var Xe=function(t,n){var r=this;this.editorView=t,this.width=n.width||1,this.color=n.color||"black",this.class=n.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map(function(i){var o=function(s){return r[i](s)};return t.dom.addEventListener(i,o),{name:i,handler:o}})};Xe.prototype.destroy=function(){var t=this;this.handlers.forEach(function(n){return t.editorView.dom.removeEventListener(n.name,n.handler)})},Xe.prototype.update=function(t,n){null!=this.cursorPos&&n.doc!=t.state.doc&&(this.cursorPos>t.state.doc.content.size?this.setCursor(null):this.updateOverlay())},Xe.prototype.setCursor=function(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},Xe.prototype.updateOverlay=function(){var n,t=this.editorView.state.doc.resolve(this.cursorPos);if(!t.parent.inlineContent){var r=t.nodeBefore,i=t.nodeAfter;if(r||i){var o=this.editorView.nodeDOM(this.cursorPos-(r?r.nodeSize:0)).getBoundingClientRect(),s=r?o.bottom:o.top;r&&i&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),n={left:o.left,right:o.right,top:s-this.width/2,bottom:s+this.width/2}}}if(!n){var c=this.editorView.coordsAtPos(this.cursorPos);n={left:c.left-this.width/2,right:c.left+this.width/2,top:c.top,bottom:c.bottom}}var u,p,l=this.editorView.dom.offsetParent;if(this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!l||l==document.body&&"static"==getComputedStyle(l).position)u=-pageXOffset,p=-pageYOffset;else{var f=l.getBoundingClientRect();u=f.left-l.scrollLeft,p=f.top-l.scrollTop}this.element.style.left=n.left-u+"px",this.element.style.top=n.top-p+"px",this.element.style.width=n.right-n.left+"px",this.element.style.height=n.bottom-n.top+"px"},Xe.prototype.scheduleRemoval=function(t){var n=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){return n.setCursor(null)},t)},Xe.prototype.dragover=function(t){if(this.editorView.editable){var n=this.editorView.posAtCoords({left:t.clientX,top:t.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,o="function"==typeof i?i(this.editorView,n):i;if(n&&!o){var s=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&null==(s=xe(this.editorView.state.doc,s,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(s),this.scheduleRemoval(5e3)}}},Xe.prototype.dragend=function(){this.scheduleRemoval(20)},Xe.prototype.drop=function(){this.scheduleRemoval(20)},Xe.prototype.dragleave=function(t){(t.target==this.editorView.dom||!this.editorView.dom.contains(t.relatedTarget))&&this.setCursor(null)};const Bh=se.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:null}),addProseMirrorPlugins(){return[(e=this.options,void 0===e&&(e={}),new ie({view:function(n){return new Xe(n,e)}}))];var e}});var Me=function(e){function t(n){e.call(this,n,n)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.map=function(r,i){var o=r.resolve(i.map(this.head));return t.valid(o)?new t(o):e.near(o)},t.prototype.content=function(){return V.empty},t.prototype.eq=function(r){return r instanceof t&&r.head==this.head},t.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},t.fromJSON=function(r,i){if("number"!=typeof i.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(r.resolve(i.pos))},t.prototype.getBookmark=function(){return new No(this.anchor)},t.valid=function(r){var i=r.parent;if(i.isTextblock||!function Fh(e){for(var t=e.depth;t>=0;t--){var n=e.index(t),r=e.node(t);if(0!=n)for(var i=r.child(n-1);;i=i.lastChild){if(0==i.childCount&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(r)||!function Lh(e){for(var t=e.depth;t>=0;t--){var n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(var i=r.child(n);;i=i.firstChild){if(0==i.childCount&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(r))return!1;var o=i.type.spec.allowGapCursor;if(null!=o)return o;var s=i.contentMatchAt(r.index()).defaultType;return s&&s.isTextblock},t.findFrom=function(r,i,o){t:for(;;){if(!o&&t.valid(r))return r;for(var s=r.pos,c=null,l=r.depth;;l--){var u=r.node(l);if(i>0?r.indexAfter(l)<u.childCount:r.index(l)>0){c=u.child(i>0?r.indexAfter(l):r.index(l)-1);break}if(0==l)return null;var p=r.doc.resolve(s+=i);if(t.valid(p))return p}for(;;){var f=i>0?c.firstChild:c.lastChild;if(!f){if(c.isAtom&&!c.isText&&!et.isSelectable(c)){r=r.doc.resolve(s+c.nodeSize*i),o=!1;continue t}break}c=f;var d=r.doc.resolve(s+=i);if(t.valid(d))return d}return null}},t}(tt);Me.prototype.visible=!1,tt.jsonID("gapcursor",Me);var No=function(t){this.pos=t};No.prototype.map=function(t){return new No(t.map(this.pos))},No.prototype.resolve=function(t){var n=t.resolve(this.pos);return Me.valid(n)?new Me(n):tt.near(n)};var Vh=gl({ArrowLeft:Do("horiz",-1),ArrowRight:Do("horiz",1),ArrowUp:Do("vert",-1),ArrowDown:Do("vert",1)});function Do(e,t){var n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(r,i,o){var s=r.selection,c=t>0?s.$to:s.$from,l=s.empty;if(s instanceof at){if(!o.endOfTextblock(n)||0==c.depth)return!1;l=!1,c=r.doc.resolve(t>0?c.after():c.before())}var u=Me.findFrom(c,t,l);return!!u&&(i&&i(r.tr.setSelection(new Me(u))),!0)}}function Hh(e,t,n){if(!e.editable)return!1;var r=e.state.doc.resolve(t);if(!Me.valid(r))return!1;var o=e.posAtCoords({left:n.clientX,top:n.clientY}).inside;return!(o>-1&&et.isSelectable(e.state.doc.nodeAt(o))||(e.dispatch(e.state.tr.setSelection(new Me(r))),0))}function Jh(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof Me))return!1;var r=e.state.selection.$from,i=r.parent.contentMatchAt(r.index()).findWrapping(e.state.schema.nodes.text);if(!i)return!1;for(var o=R.empty,s=i.length-1;s>=0;s--)o=R.from(i[s].createAndFill(null,o));var c=e.state.tr.replace(r.pos,r.pos,new V(o,0,0));return c.setSelection(at.near(c.doc.resolve(r.pos+1))),e.dispatch(c),!1}function Uh(e){if(!(e.selection instanceof Me))return null;var t=document.createElement("div");return t.className="ProseMirror-gapcursor",yt.create(e.doc,[Ft.widget(e.selection.head,t,{key:"gapcursor"})])}const jh=se.create({name:"gapCursor",addProseMirrorPlugins:()=>[new ie({props:{decorations:Uh,createSelectionBetween:function(t,n,r){if(n.pos==r.pos&&Me.valid(r))return new Me(r)},handleClick:Hh,handleKeyDown:Vh,handleDOMEvents:{beforeinput:Jh}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!==(t=ot(U(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))&&void 0!==t?t:null}}}),Wh=fe.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",ae(this.options.HTMLAttributes,e)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:i,storedMarks:o}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:c}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return t().insertContent({type:this.name}).command(({tr:u,dispatch:p})=>{if(p&&l&&s){const f=l.filter(d=>c.includes(d.type.name));u.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Yh=fe.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,ae(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode(this.name,e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>Xt(Z({},e),{[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>da({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var Ht=function(){};Ht.prototype.append=function(t){return t.length?(t=Ht.from(t),!this.length&&t||t.length<200&&this.leafAppend(t)||this.length<200&&t.leafPrepend(this)||this.appendInner(t)):this},Ht.prototype.prepend=function(t){return t.length?Ht.from(t).append(this):this},Ht.prototype.appendInner=function(t){return new Kh(this,t)},Ht.prototype.slice=function(t,n){return void 0===t&&(t=0),void 0===n&&(n=this.length),t>=n?Ht.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,n))},Ht.prototype.get=function(t){if(!(t<0||t>=this.length))return this.getInner(t)},Ht.prototype.forEach=function(t,n,r){void 0===n&&(n=0),void 0===r&&(r=this.length),n<=r?this.forEachInner(t,n,r,0):this.forEachInvertedInner(t,n,r,0)},Ht.prototype.map=function(t,n,r){void 0===n&&(n=0),void 0===r&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(t(o,s))},n,r),i},Ht.from=function(t){return t instanceof Ht?t:t&&t.length?new Ll(t):Ht.empty};var Ll=function(e){function t(r){e.call(this),this.values=r}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(i,o){return 0==i&&o==this.length?this:new t(this.values.slice(i,o))},t.prototype.getInner=function(i){return this.values[i]},t.prototype.forEachInner=function(i,o,s,c){for(var l=o;l<s;l++)if(!1===i(this.values[l],c+l))return!1},t.prototype.forEachInvertedInner=function(i,o,s,c){for(var l=o-1;l>=s;l--)if(!1===i(this.values[l],c+l))return!1},t.prototype.leafAppend=function(i){if(this.length+i.length<=200)return new t(this.values.concat(i.flatten()))},t.prototype.leafPrepend=function(i){if(this.length+i.length<=200)return new t(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(Ht);Ht.empty=new Ll([]);var Kh=function(e){function t(n,r){e.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},t.prototype.forEachInner=function(r,i,o,s){var c=this.left.length;if(i<c&&!1===this.left.forEachInner(r,i,Math.min(o,c),s)||o>c&&!1===this.right.forEachInner(r,Math.max(i-c,0),Math.min(this.length,o)-c,s+c))return!1},t.prototype.forEachInvertedInner=function(r,i,o,s){var c=this.left.length;if(i>c&&!1===this.right.forEachInvertedInner(r,i-c,Math.max(o,c)-c,s+c)||o<c&&!1===this.left.forEachInvertedInner(r,Math.min(i,c),o,s))return!1},t.prototype.sliceInner=function(r,i){if(0==r&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},t.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new t(this.left,i)},t.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new t(i,this.right)},t.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new t(this.left,new t(this.right,r)):new t(this,r)},t}(Ht);const zl=Ht;var Jt=function(t,n){this.items=t,this.eventCount=n};Jt.prototype.popEvent=function(t,n){var s,c,r=this;if(0==this.eventCount)return null;for(var i=this.items.length;;i--)if(this.items.get(i-1).selection){--i;break}n&&(s=this.remapping(i,this.items.length),c=s.maps.length);var u,p,l=t.tr,f=[],d=[];return this.items.forEach(function(g,y){if(!g.step)return s||(s=r.remapping(i,y+1),c=s.maps.length),c--,void d.push(g);if(s){d.push(new Ge(g.map));var C,_=g.step.map(s.slice(c));_&&l.maybeStep(_).doc&&f.push(new Ge(C=l.mapping.maps[l.mapping.maps.length-1],null,null,f.length+d.length)),c--,C&&s.appendMap(C,c)}else l.maybeStep(g.step);return g.selection?(u=s?g.selection.map(s.slice(c)):g.selection,p=new Jt(r.items.slice(0,i).append(d.reverse().concat(f)),r.eventCount-1),!1):void 0},this.items.length,0),{remaining:p,transform:l,selection:u}},Jt.prototype.addTransform=function(t,n,r,i){for(var o=[],s=this.eventCount,c=this.items,l=!i&&c.length?c.get(c.length-1):null,u=0;u<t.steps.length;u++){var d,p=t.steps[u].invert(t.docs[u]),f=new Ge(t.mapping.maps[u],p,n);(d=l&&l.merge(f))&&(f=d,u?o.pop():c=c.slice(0,c.length-1)),o.push(f),n&&(s++,n=null),i||(l=f)}var g=s-r.depth;return g>$h&&(c=function Gh(e,t){var n;return e.forEach(function(r,i){if(r.selection&&0==t--)return n=i,!1}),e.slice(n)}(c,g),s-=g),new Jt(c.append(o),s)},Jt.prototype.remapping=function(t,n){var r=new O;return this.items.forEach(function(i,o){r.appendMap(i.map,null!=i.mirrorOffset&&o-i.mirrorOffset>=t?r.maps.length-i.mirrorOffset:null)},t,n),r},Jt.prototype.addMaps=function(t){return 0==this.eventCount?this:new Jt(this.items.append(t.map(function(n){return new Ge(n)})),this.eventCount)},Jt.prototype.rebased=function(t,n){if(!this.eventCount)return this;var r=[],i=Math.max(0,this.items.length-n),o=t.mapping,s=t.steps.length,c=this.eventCount;this.items.forEach(function(g){g.selection&&c--},i);var l=n;this.items.forEach(function(g){var y=o.getMirror(--l);if(null!=y){s=Math.min(s,y);var _=o.maps[y];if(g.step){var C=t.steps[y].invert(t.docs[y]),k=g.selection&&g.selection.map(o.slice(l+1,y));k&&c++,r.push(new Ge(_,C,k))}else r.push(new Ge(_))}},i);for(var u=[],p=n;p<s;p++)u.push(new Ge(o.maps[p]));var f=this.items.slice(0,i).append(u).append(r),d=new Jt(f,c);return d.emptyItemCount()>500&&(d=d.compress(this.items.length-r.length)),d},Jt.prototype.emptyItemCount=function(){var t=0;return this.items.forEach(function(n){n.step||t++}),t},Jt.prototype.compress=function(t){void 0===t&&(t=this.items.length);var n=this.remapping(0,t),r=n.maps.length,i=[],o=0;return this.items.forEach(function(s,c){if(c>=t)i.push(s),s.selection&&o++;else if(s.step){var l=s.step.map(n.slice(r)),u=l&&l.getMap();if(r--,u&&n.appendMap(u,r),l){var p=s.selection&&s.selection.map(n.slice(r));p&&o++;var d,f=new Ge(u.invert(),l,p),g=i.length-1;(d=i.length&&i[g].merge(f))?i[g]=d:i.push(f)}}else s.map&&r--},this.items.length,0),new Jt(zl.from(i.reverse()),o)},Jt.empty=new Jt(zl.empty,0);var Ge=function(t,n,r,i){this.map=t,this.step=n,this.selection=r,this.mirrorOffset=i};Ge.prototype.merge=function(t){if(this.step&&t.step&&!t.selection){var n=t.step.merge(this.step);if(n)return new Ge(n.getMap().invert(),n,this.selection)}};var Fn=function(t,n,r,i){this.done=t,this.undone=n,this.prevRanges=r,this.prevTime=i},$h=20;function Vl(e){var t=[];return e.forEach(function(n,r,i,o){return t.push(i,o)}),t}function ga(e,t){if(!e)return null;for(var n=[],r=0;r<e.length;r+=2){var i=t.map(e[r],1),o=t.map(e[r+1],-1);i<=o&&n.push(i,o)}return n}function Hl(e,t,n,r){var i=Po(t),o=$e.get(t).spec.config,s=(r?e.undone:e.done).popEvent(t,i);if(s){var c=s.selection.resolve(s.transform.doc),l=(r?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),o,i),u=new Fn(r?l:s.remaining,r?s.remaining:l,null,0);n(s.transform.setSelection(c).setMeta($e,{redo:r,historyState:u}).scrollIntoView())}}var va=!1,Jl=null;function Po(e){var t=e.plugins;if(Jl!=t){va=!1,Jl=t;for(var n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){va=!0;break}}return va}var $e=new Te("history"),Ul=new Te("closeHistory");function jl(e,t){var n=$e.getState(e);return!(!n||0==n.done.eventCount||(t&&Hl(n,e,t,!1),0))}function Wl(e,t){var n=$e.getState(e);return!(!n||0==n.undone.eventCount||(t&&Hl(n,e,t,!0),0))}const rm=se.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>jl(e,t),redo:()=>({state:e,dispatch:t})=>Wl(e,t)}),addProseMirrorPlugins(){return[(e=this.options,new ie({key:$e,state:{init:function(){return new Fn(Jt.empty,Jt.empty,null,0)},apply:function(n,r,i){return function tm(e,t,n,r){var o,i=n.getMeta($e);if(i)return i.historyState;n.getMeta(Ul)&&(e=new Fn(e.done,e.undone,null,0));var s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta($e))return s.getMeta($e).redo?new Fn(e.done.addTransform(n,null,r,Po(t)),e.undone,Vl(n.mapping.maps[n.steps.length-1]),e.prevTime):new Fn(e.done,e.undone.addTransform(n,null,r,Po(t)),null,e.prevTime);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new Fn(e.done.rebased(n,o),e.undone.rebased(n,o),ga(e.prevRanges,n.mapping),e.prevTime):new Fn(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),ga(e.prevRanges,n.mapping),e.prevTime);var c=0==e.prevTime||!s&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function em(e,t){if(!t)return!1;if(!e.docChanged)return!0;var n=!1;return e.mapping.maps[0].forEach(function(r,i){for(var o=0;o<t.length;o+=2)r<=t[o+1]&&i>=t[o]&&(n=!0)}),n}(n,e.prevRanges)),l=s?ga(e.prevRanges,n.mapping):Vl(n.mapping.maps[n.steps.length-1]);return new Fn(e.done.addTransform(n,c?t.selection.getBookmark():null,r,Po(t)),Jt.empty,l,n.time)}(r,i,n,e)}},config:e={depth:e&&e.depth||100,newGroupDelay:e&&e.newGroupDelay||500},props:{handleDOMEvents:{beforeinput:function(n,r){var i="historyUndo"==r.inputType?jl(n.state,n.dispatch):"historyRedo"==r.inputType&&Wl(n.state,n.dispatch);return i&&r.preventDefault(),i}}}}))];var e},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),im=fe.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",ae(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e})=>e().insertContent({type:this.name}).command(({tr:t,dispatch:n})=>{var r;if(n){const{$to:i}=t.selection,o=i.end();if(i.nodeAfter)t.setSelection(at.create(t.doc,i.pos));else{const s=null===(r=i.parent.type.contentMatch.defaultType)||void 0===r?void 0:r.create();s&&(t.insert(o,s),t.setSelection(at.create(t.doc,o)))}t.scrollIntoView()}return!0}).run()}},addInputRules(){return[(e={find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type},new Mi({find:e.find,handler:({state:t,range:n,match:r})=>{const i=ot(e.getAttributes,void 0,r)||{},{tr:o}=t,s=n.from;let c=n.to;if(r[1]){let u=s+r[0].lastIndexOf(r[1]);u>c?u=c:c=u+r[1].length,o.insertText(r[0][r[0].length-1],s+r[0].length-1),o.replaceWith(u,c,e.type.create(i))}else r[0]&&o.replaceWith(s,c,e.type.create(i))}}))];var e}}),om=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,sm=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,am=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,cm=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,lm=cr.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:e}){return["em",ae(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Zr({find:om,type:this.type}),Zr({find:am,type:this.type})]},addPasteRules(){return[qr({find:sm,type:this.type}),qr({find:cm,type:this.type})]}}),um=fe.create({name:"listItem",addOptions:()=>({HTMLAttributes:{}}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",ae(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),pm=/^(\d+)\.\s$/,fm=fe.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{}}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){const r=e,{start:t}=r,n=ju(r,["start"]);return 1===t?["ol",ae(this.options.HTMLAttributes,n),0]:["ol",ae(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[ha({find:pm,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]})]}}),dm=fe.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",ae(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),hm=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,mm=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,gm=cr.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",ae(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Zr({find:hm,type:this.type})]},addPasteRules(){return[qr({find:mm,type:this.type})]}}),vm=fe.create({name:"text",group:"inline"}),ym=se.create({name:"starterKit",addExtensions(){var e,t,n,r,i,o,s,c,l,u,p,f,d,g,y,_,C,k;const M=[];return!1!==this.options.blockquote&&M.push(wh.configure(null===(e=this.options)||void 0===e?void 0:e.blockquote)),!1!==this.options.bold&&M.push(Mh.configure(null===(t=this.options)||void 0===t?void 0:t.bold)),!1!==this.options.bulletList&&M.push(Ah.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&M.push(Dh.configure(null===(r=this.options)||void 0===r?void 0:r.code)),!1!==this.options.codeBlock&&M.push(Rh.configure(null===(i=this.options)||void 0===i?void 0:i.codeBlock)),!1!==this.options.document&&M.push(Zh.configure(null===(o=this.options)||void 0===o?void 0:o.document)),!1!==this.options.dropcursor&&M.push(Bh.configure(null===(s=this.options)||void 0===s?void 0:s.dropcursor)),!1!==this.options.gapcursor&&M.push(jh.configure(null===(c=this.options)||void 0===c?void 0:c.gapcursor)),!1!==this.options.hardBreak&&M.push(Wh.configure(null===(l=this.options)||void 0===l?void 0:l.hardBreak)),!1!==this.options.heading&&M.push(Yh.configure(null===(u=this.options)||void 0===u?void 0:u.heading)),!1!==this.options.history&&M.push(rm.configure(null===(p=this.options)||void 0===p?void 0:p.history)),!1!==this.options.horizontalRule&&M.push(im.configure(null===(f=this.options)||void 0===f?void 0:f.horizontalRule)),!1!==this.options.italic&&M.push(lm.configure(null===(d=this.options)||void 0===d?void 0:d.italic)),!1!==this.options.listItem&&M.push(um.configure(null===(g=this.options)||void 0===g?void 0:g.listItem)),!1!==this.options.orderedList&&M.push(fm.configure(null===(y=this.options)||void 0===y?void 0:y.orderedList)),!1!==this.options.paragraph&&M.push(dm.configure(null===(_=this.options)||void 0===_?void 0:_.paragraph)),!1!==this.options.strike&&M.push(gm.configure(null===(C=this.options)||void 0===C?void 0:C.strike)),!1!==this.options.text&&M.push(vm.configure(null===(k=this.options)||void 0===k?void 0:k.text)),M}});function Le(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Br(e){return e instanceof Le(e).Element||e instanceof Element}function Oe(e){return e instanceof Le(e).HTMLElement||e instanceof HTMLElement}function Yl(e){return"undefined"!=typeof ShadowRoot&&(e instanceof Le(e).ShadowRoot||e instanceof ShadowRoot)}var lr=Math.max,Ro=Math.min,Fr=Math.round;function Lr(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),r=1,i=1;if(Oe(e)&&t){var o=e.offsetHeight,s=e.offsetWidth;s>0&&(r=Fr(n.width)/s||1),o>0&&(i=Fr(n.height)/o||1)}return{width:n.width/r,height:n.height/i,top:n.top/i,right:n.right/r,bottom:n.bottom/i,left:n.left/r,x:n.left/r,y:n.top/i}}function ya(e){var t=Le(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function tn(e){return e?(e.nodeName||"").toLowerCase():null}function Ln(e){return((Br(e)?e.ownerDocument:e.document)||window.document).documentElement}function ba(e){return Lr(Ln(e)).left+ya(e).scrollLeft}function gn(e){return Le(e).getComputedStyle(e)}function _a(e){var t=gn(e);return/auto|scroll|overlay|hidden/.test(t.overflow+t.overflowY+t.overflowX)}function wm(e,t,n){void 0===n&&(n=!1);var r=Oe(t),i=Oe(t)&&function xm(e){var t=e.getBoundingClientRect(),n=Fr(t.width)/e.offsetWidth||1,r=Fr(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),o=Ln(t),s=Lr(e,i),c={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==tn(t)||_a(o))&&(c=function _m(e){return e!==Le(e)&&Oe(e)?function bm(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}(e):ya(e)}(t)),Oe(t)?((l=Lr(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):o&&(l.x=ba(o))),{x:s.left+c.scrollLeft-l.x,y:s.top+c.scrollTop-l.y,width:s.width,height:s.height}}function xa(e){var t=Lr(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Zo(e){return"html"===tn(e)?e:e.assignedSlot||e.parentNode||(Yl(e)?e.host:null)||Ln(e)}function Kl(e){return["html","body","#document"].indexOf(tn(e))>=0?e.ownerDocument.body:Oe(e)&&_a(e)?e:Kl(Zo(e))}function Oi(e,t){var n;void 0===t&&(t=[]);var r=Kl(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=Le(r),s=i?[o].concat(o.visualViewport||[],_a(r)?r:[]):r,c=t.concat(s);return i?c:c.concat(Oi(Zo(s)))}function Cm(e){return["table","td","th"].indexOf(tn(e))>=0}function Ql(e){return Oe(e)&&"fixed"!==gn(e).position?e.offsetParent:null}function Ai(e){for(var t=Le(e),n=Ql(e);n&&Cm(n)&&"static"===gn(n).position;)n=Ql(n);return n&&("html"===tn(n)||"body"===tn(n)&&"static"===gn(n).position)?t:n||function Tm(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&Oe(e)&&"fixed"===gn(e).position)return null;for(var i=Zo(e);Oe(i)&&["html","body"].indexOf(tn(i))<0;){var o=gn(i);if("none"!==o.transform||"none"!==o.perspective||"paint"===o.contain||-1!==["transform","perspective"].indexOf(o.willChange)||t&&"filter"===o.willChange||t&&o.filter&&"none"!==o.filter)return i;i=i.parentNode}return null}(e)||t}var de="top",Ae="bottom",Ee="right",he="left",wa="auto",Ei=[de,Ae,Ee,he],zr="start",Ni="end",Xl="viewport",Di="popper",Gl=Ei.reduce(function(e,t){return e.concat([t+"-"+zr,t+"-"+Ni])},[]),$l=[].concat(Ei,[wa]).reduce(function(e,t){return e.concat([t,t+"-"+zr,t+"-"+Ni])},[]),Zm=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function qm(e){var t=new Map,n=new Set,r=[];function i(o){n.add(o.name),[].concat(o.requires||[],o.requiresIfExists||[]).forEach(function(c){if(!n.has(c)){var l=t.get(c);l&&i(l)}}),r.push(o)}return e.forEach(function(o){t.set(o.name,o)}),e.forEach(function(o){n.has(o.name)||i(o)}),r}function Fm(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}var tu={placement:"bottom",modifiers:[],strategy:"absolute"};function eu(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(r){return!(r&&"function"==typeof r.getBoundingClientRect)})}function zm(e){void 0===e&&(e={});var n=e.defaultModifiers,r=void 0===n?[]:n,i=e.defaultOptions,o=void 0===i?tu:i;return function(c,l,u){void 0===u&&(u=o);var p={placement:"bottom",orderedModifiers:[],options:Object.assign({},tu,o),modifiersData:{},elements:{reference:c,popper:l},attributes:{},styles:{}},f=[],d=!1,g={state:p,setOptions:function(k){var M="function"==typeof k?k(p.options):k;_(),p.options=Object.assign({},o,p.options,M),p.scrollParents={reference:Br(c)?Oi(c):c.contextElement?Oi(c.contextElement):[],popper:Oi(l)};var B=function Bm(e){var t=qm(e);return Zm.reduce(function(n,r){return n.concat(t.filter(function(i){return i.phase===r}))},[])}(function Lm(e){var t=e.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(t).map(function(n){return t[n]})}([].concat(r,p.options.modifiers)));return p.orderedModifiers=B.filter(function(ct){return ct.enabled}),function y(){p.orderedModifiers.forEach(function(C){var M=C.options,b=C.effect;if("function"==typeof b){var P=b({state:p,name:C.name,instance:g,options:void 0===M?{}:M});f.push(P||function(){})}})}(),g.update()},forceUpdate:function(){if(!d){var k=p.elements,M=k.reference,B=k.popper;if(eu(M,B)){p.rects={reference:wm(M,Ai(B),"fixed"===p.options.strategy),popper:xa(B)},p.reset=!1,p.placement=p.options.placement,p.orderedModifiers.forEach(function(ct){return p.modifiersData[ct.name]=Object.assign({},ct.data)});for(var P=0;P<p.orderedModifiers.length;P++)if(!0!==p.reset){var D=p.orderedModifiers[P],J=D.fn,j=D.options;"function"==typeof J&&(p=J({state:p,options:void 0===j?{}:j,name:D.name,instance:g})||p)}else p.reset=!1,P=-1}}},update:Fm(function(){return new Promise(function(C){g.forceUpdate(),C(p)})}),destroy:function(){_(),d=!0}};if(!eu(c,l))return g;function _(){f.forEach(function(C){return C()}),f=[]}return g.setOptions(u).then(function(C){!d&&u.onFirstUpdate&&u.onFirstUpdate(C)}),g}}var qo={passive:!0};function en(e){return e.split("-")[0]}function Vr(e){return e.split("-")[1]}function Ca(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function nu(e){var l,t=e.reference,n=e.element,r=e.placement,i=r?en(r):null,o=r?Vr(r):null,s=t.x+t.width/2-n.width/2,c=t.y+t.height/2-n.height/2;switch(i){case de:l={x:s,y:t.y-n.height};break;case Ae:l={x:s,y:t.y+t.height};break;case Ee:l={x:t.x+t.width,y:c};break;case he:l={x:t.x-n.width,y:c};break;default:l={x:t.x,y:t.y}}var u=i?Ca(i):null;if(null!=u){var p="y"===u?"height":"width";switch(o){case zr:l[u]=l[u]-(t[p]/2-n[p]/2);break;case Ni:l[u]=l[u]+(t[p]/2-n[p]/2)}}return l}var jm={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ru(e){var t,n=e.popper,r=e.popperRect,i=e.placement,o=e.variation,s=e.offsets,c=e.position,l=e.gpuAcceleration,u=e.adaptive,p=e.roundOffsets,f=e.isFixed,d=s.x,g=void 0===d?0:d,y=s.y,_=void 0===y?0:y,C="function"==typeof p?p({x:g,y:_}):{x:g,y:_};g=C.x,_=C.y;var k=s.hasOwnProperty("x"),M=s.hasOwnProperty("y"),B=he,b=de,P=window;if(u){var D=Ai(n),J="clientHeight",j="clientWidth";D===Le(n)&&"static"!==gn(D=Ln(n)).position&&"absolute"===c&&(J="scrollHeight",j="scrollWidth"),D=D,(i===de||(i===he||i===Ee)&&o===Ni)&&(b=Ae,_-=(f&&P.visualViewport?P.visualViewport.height:D[J])-r.height,_*=l?1:-1),i!==he&&(i!==de&&i!==Ae||o!==Ni)||(B=Ee,g-=(f&&P.visualViewport?P.visualViewport.width:D[j])-r.width,g*=l?1:-1)}var mt,ct=Object.assign({position:c},u&&jm),ft=!0===p?function Wm(e){var n=e.y,i=window.devicePixelRatio||1;return{x:Fr(e.x*i)/i||0,y:Fr(n*i)/i||0}}({x:g,y:_}):{x:g,y:_};return g=ft.x,_=ft.y,Object.assign({},ct,l?((mt={})[b]=M?"0":"",mt[B]=k?"0":"",mt.transform=(P.devicePixelRatio||1)<=1?"translate("+g+"px, "+_+"px)":"translate3d("+g+"px, "+_+"px, 0)",mt):((t={})[b]=M?_+"px":"",t[B]=k?g+"px":"",t.transform="",t))}const iu={name:"applyStyles",enabled:!0,phase:"write",fn:function Qm(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var r=t.styles[n]||{},i=t.attributes[n]||{},o=t.elements[n];!Oe(o)||!tn(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var c=i[s];!1===c?o.removeAttribute(s):o.setAttribute(s,!0===c?"":c)}))})},effect:function Xm(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(r){var i=t.elements[r],o=t.attributes[r]||{},c=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:n[r]).reduce(function(l,u){return l[u]="",l},{});!Oe(i)||!tn(i)||(Object.assign(i.style,c),Object.keys(o).forEach(function(l){i.removeAttribute(l)}))})}},requires:["computeStyles"]};var eg={left:"right",right:"left",bottom:"top",top:"bottom"};function Bo(e){return e.replace(/left|right|bottom|top/g,function(t){return eg[t]})}var ng={start:"end",end:"start"};function ou(e){return e.replace(/start|end/g,function(t){return ng[t]})}function su(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&Yl(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Ta(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function au(e,t){return t===Xl?Ta(function rg(e){var t=Le(e),n=Ln(e),r=t.visualViewport,i=n.clientWidth,o=n.clientHeight,s=0,c=0;return r&&(i=r.width,o=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=r.offsetLeft,c=r.offsetTop)),{width:i,height:o,x:s+ba(e),y:c}}(e)):Br(t)?function og(e){var t=Lr(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):Ta(function ig(e){var t,n=Ln(e),r=ya(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=lr(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=lr(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),c=-r.scrollLeft+ba(e),l=-r.scrollTop;return"rtl"===gn(i||n).direction&&(c+=lr(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:c,y:l}}(Ln(e)))}function lu(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function uu(e,t){return t.reduce(function(n,r){return n[r]=e,n},{})}function Ii(e,t){void 0===t&&(t={});var r=t.placement,i=void 0===r?e.placement:r,o=t.boundary,s=void 0===o?"clippingParents":o,c=t.rootBoundary,l=void 0===c?Xl:c,u=t.elementContext,p=void 0===u?Di:u,f=t.altBoundary,d=void 0!==f&&f,g=t.padding,y=void 0===g?0:g,_=lu("number"!=typeof y?y:uu(y,Ei)),k=e.rects.popper,M=e.elements[d?p===Di?"reference":Di:p],B=function ag(e,t,n){var r="clippingParents"===t?function sg(e){var t=Oi(Zo(e)),r=["absolute","fixed"].indexOf(gn(e).position)>=0&&Oe(e)?Ai(e):e;return Br(r)?t.filter(function(i){return Br(i)&&su(i,r)&&"body"!==tn(i)}):[]}(e):[].concat(t),i=[].concat(r,[n]),s=i.reduce(function(c,l){var u=au(e,l);return c.top=lr(u.top,c.top),c.right=Ro(u.right,c.right),c.bottom=Ro(u.bottom,c.bottom),c.left=lr(u.left,c.left),c},au(e,i[0]));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}(Br(M)?M:M.contextElement||Ln(e.elements.popper),s,l),b=Lr(e.elements.reference),P=nu({reference:b,element:k,strategy:"absolute",placement:i}),D=Ta(Object.assign({},k,P)),J=p===Di?D:b,j={top:B.top-J.top+_.top,bottom:J.bottom-B.bottom+_.bottom,left:B.left-J.left+_.left,right:J.right-B.right+_.right},X=e.modifiersData.offset;if(p===Di&&X){var nt=X[i];Object.keys(j).forEach(function(ct){var ft=[Ee,Ae].indexOf(ct)>=0?1:-1,mt=[de,Ae].indexOf(ct)>=0?"y":"x";j[ct]+=nt[mt]*ft})}return j}function Pi(e,t,n){return lr(e,Ro(t,n))}function pu(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function fu(e){return[de,Ee,Ae,he].some(function(t){return e[t]>=0})}var wg=zm({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function Vm(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,o=void 0===i||i,s=r.resize,c=void 0===s||s,l=Le(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&u.forEach(function(p){p.addEventListener("scroll",n.update,qo)}),c&&l.addEventListener("resize",n.update,qo),function(){o&&u.forEach(function(p){p.removeEventListener("scroll",n.update,qo)}),c&&l.removeEventListener("resize",n.update,qo)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function Jm(e){var t=e.state;t.modifiersData[e.name]=nu({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function Ym(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,o=n.adaptive,s=void 0===o||o,c=n.roundOffsets,l=void 0===c||c,p={placement:en(t.placement),variation:Vr(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ru(Object.assign({},p,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ru(Object.assign({},p,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},iu,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function $m(e){var t=e.state,r=e.name,i=e.options.offset,o=void 0===i?[0,0]:i,s=$l.reduce(function(p,f){return p[f]=function Gm(e,t,n){var r=en(e),i=[he,de].indexOf(r)>=0?-1:1,o="function"==typeof n?n(Object.assign({},t,{placement:e})):n,s=o[0],c=o[1];return s=s||0,c=(c||0)*i,[he,Ee].indexOf(r)>=0?{x:c,y:s}:{x:s,y:c}}(f,t.rects,o),p},{}),c=s[t.placement],u=c.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c.x,t.modifiersData.popperOffsets.y+=u),t.modifiersData[r]=s}},{name:"flip",enabled:!0,phase:"main",fn:function ug(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,o=void 0===i||i,s=n.altAxis,c=void 0===s||s,l=n.fallbackPlacements,u=n.padding,p=n.boundary,f=n.rootBoundary,d=n.altBoundary,g=n.flipVariations,y=void 0===g||g,_=n.allowedAutoPlacements,C=t.options.placement,k=en(C),B=l||(k!==C&&y?function lg(e){if(en(e)===wa)return[];var t=Bo(e);return[ou(e),t,ou(t)]}(C):[Bo(C)]),b=[C].concat(B).reduce(function(vn,ze){return vn.concat(en(ze)===wa?function cg(e,t){void 0===t&&(t={});var i=t.boundary,o=t.rootBoundary,s=t.padding,c=t.flipVariations,l=t.allowedAutoPlacements,u=void 0===l?$l:l,p=Vr(t.placement),f=p?c?Gl:Gl.filter(function(y){return Vr(y)===p}):Ei,d=f.filter(function(y){return u.indexOf(y)>=0});0===d.length&&(d=f);var g=d.reduce(function(y,_){return y[_]=Ii(e,{placement:_,boundary:i,rootBoundary:o,padding:s})[en(_)],y},{});return Object.keys(g).sort(function(y,_){return g[y]-g[_]})}(t,{placement:ze,boundary:p,rootBoundary:f,padding:u,flipVariations:y,allowedAutoPlacements:_}):ze)},[]),P=t.rects.reference,D=t.rects.popper,J=new Map,j=!0,X=b[0],nt=0;nt<b.length;nt++){var ct=b[nt],ft=en(ct),mt=Vr(ct)===zr,Zt=[de,Ae].indexOf(ft)>=0,xt=Zt?"width":"height",lt=Ii(t,{placement:ct,boundary:p,rootBoundary:f,altBoundary:d,padding:u}),Pt=Zt?mt?Ee:he:mt?Ae:de;P[xt]>D[xt]&&(Pt=Bo(Pt));var Ut=Bo(Pt),rn=[];if(o&&rn.push(lt[ft]<=0),c&&rn.push(lt[Pt]<=0,lt[Ut]<=0),rn.every(function(vn){return vn})){X=ct,j=!1;break}J.set(ct,rn)}if(j)for(var pr=function(ze){var yn=b.find(function(Jr){var bn=J.get(Jr);if(bn)return bn.slice(0,ze).every(function(Ur){return Ur})});if(yn)return X=yn,"break"},sn=y?3:1;sn>0&&"break"!==pr(sn);sn--);t.placement!==X&&(t.modifiersData[r]._skip=!0,t.placement=X,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function hg(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,o=void 0===i||i,s=n.altAxis,c=void 0!==s&&s,d=n.tether,g=void 0===d||d,y=n.tetherOffset,_=void 0===y?0:y,C=Ii(t,{boundary:n.boundary,rootBoundary:n.rootBoundary,padding:n.padding,altBoundary:n.altBoundary}),k=en(t.placement),M=Vr(t.placement),B=!M,b=Ca(k),P=function fg(e){return"x"===e?"y":"x"}(b),D=t.modifiersData.popperOffsets,J=t.rects.reference,j=t.rects.popper,X="function"==typeof _?_(Object.assign({},t.rects,{placement:t.placement})):_,nt="number"==typeof X?{mainAxis:X,altAxis:X}:Object.assign({mainAxis:0,altAxis:0},X),ct=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,ft={x:0,y:0};if(D){if(o){var mt,Zt="y"===b?de:he,xt="y"===b?Ae:Ee,lt="y"===b?"height":"width",Pt=D[b],Ut=Pt+C[Zt],rn=Pt-C[xt],on=g?-j[lt]/2:0,pr=M===zr?J[lt]:j[lt],sn=M===zr?-j[lt]:-J[lt],fr=t.elements.arrow,vn=g&&fr?xa(fr):{width:0,height:0},ze=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},yn=ze[Zt],Jr=ze[xt],bn=Pi(0,J[lt],vn[lt]),Ur=B?J[lt]/2-on-bn-yn-nt.mainAxis:pr-bn-yn-nt.mainAxis,Jn=B?-J[lt]/2+on+bn+Jr+nt.mainAxis:sn+bn+Jr+nt.mainAxis,jr=t.elements.arrow&&Ai(t.elements.arrow),qi=null!=(mt=null==ct?void 0:ct[b])?mt:0,Wo=Pt+Jn-qi,Bi=Pi(g?Ro(Ut,Pt+Ur-qi-(jr?"y"===b?jr.clientTop||0:jr.clientLeft||0:0)):Ut,Pt,g?lr(rn,Wo):rn);D[b]=Bi,ft[b]=Bi-Pt}if(c){var Fi,_n=D[P],Un="y"===P?"height":"width",Li=_n+C["x"===b?de:he],dr=_n-C["x"===b?Ae:Ee],zi=-1!==[de,he].indexOf(k),Qo=null!=(Fi=null==ct?void 0:ct[P])?Fi:0,Xo=zi?Li:_n-J[Un]-j[Un]-Qo+nt.altAxis,Go=zi?_n+J[Un]+j[Un]-Qo-nt.altAxis:dr,$o=g&&zi?function dg(e,t,n){var r=Pi(e,t,n);return r>n?n:r}(Xo,_n,Go):Pi(g?Xo:Li,_n,g?Go:dr);D[P]=$o,ft[P]=$o-_n}t.modifiersData[r]=ft}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function vg(e){var t,n=e.state,r=e.name,i=e.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,c=en(n.placement),l=Ca(c),p=[he,Ee].indexOf(c)>=0?"height":"width";if(o&&s){var f=function(t,n){return lu("number"!=typeof(t="function"==typeof t?t(Object.assign({},n.rects,{placement:n.placement})):t)?t:uu(t,Ei))}(i.padding,n),d=xa(o),g="y"===l?de:he,y="y"===l?Ae:Ee,_=n.rects.reference[p]+n.rects.reference[l]-s[l]-n.rects.popper[p],C=s[l]-n.rects.reference[l],k=Ai(o),M=k?"y"===l?k.clientHeight||0:k.clientWidth||0:0,D=M/2-d[p]/2+(_/2-C/2),J=Pi(f[g],D,M-d[p]-f[y]);n.modifiersData[r]=((t={})[l]=J,t.centerOffset=J-D,t)}},effect:function yg(e){var t=e.state,r=e.options.element,i=void 0===r?"[data-popper-arrow]":r;null!=i&&("string"==typeof i&&!(i=t.elements.popper.querySelector(i))||!su(t.elements.popper,i)||(t.elements.arrow=i))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function _g(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,o=t.modifiersData.preventOverflow,s=Ii(t,{elementContext:"reference"}),c=Ii(t,{altBoundary:!0}),l=pu(s,r),u=pu(c,i,o),p=fu(l),f=fu(u);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:p,hasPopperEscaped:f},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":p,"data-popper-escaped":f})}}]}),du="tippy-content",mu="tippy-arrow",gu="tippy-svg-arrow",zn={passive:!0,capture:!0},vu=function(){return document.body};function ka(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?Array.isArray(n)?n[t]:n:r}return e}function Sa(e,t){var n={}.toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function yu(e,t){return"function"==typeof e?e.apply(void 0,t):e}function bu(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)};var n}function Vn(e){return[].concat(e)}function _u(e,t){-1===e.indexOf(t)&&e.push(t)}function Hr(e){return[].slice.call(e)}function wu(e){return Object.keys(e).reduce(function(t,n){return void 0!==e[n]&&(t[n]=e[n]),t},{})}function ur(){return document.createElement("div")}function Fo(e){return["Element","Fragment"].some(function(t){return Sa(e,t)})}function Aa(e,t){e.forEach(function(n){n&&(n.style.transitionDuration=t+"ms")})}function Ri(e,t){e.forEach(function(n){n&&n.setAttribute("data-state",t)})}function Ea(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){e[r](i,n)})}function ku(e,t){for(var n=t;n;){var r;if(e.contains(n))return!0;n=null==n.getRootNode||null==(r=n.getRootNode())?void 0:r.host}return!1}var nn={isTouch:!1},Su=0;function Eg(){nn.isTouch||(nn.isTouch=!0,window.performance&&document.addEventListener("mousemove",Mu))}function Mu(){var e=performance.now();e-Su<20&&(nn.isTouch=!1,document.removeEventListener("mousemove",Mu)),Su=e}function Ng(){var e=document.activeElement;(function Cu(e){return!(!e||!e._tippy||e._tippy.reference!==e)})(e)&&e.blur&&!e._tippy.state.isVisible&&e.blur()}var Pg=!("undefined"==typeof window||"undefined"==typeof document||!window.msCrypto),me=Object.assign({appendTo:vu,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),Bg=Object.keys(me);function Du(e){var n=(e.plugins||[]).reduce(function(r,i){var c,o=i.name;return o&&(r[o]=void 0!==e[o]?e[o]:null!=(c=me[o])?c:i.defaultValue),r},{});return Object.assign({},e,n)}function Iu(e,t){var n=Object.assign({},t,{content:yu(t.content,[e])},t.ignoreAttributes?{}:function Lg(e,t){return(t?Object.keys(Du(Object.assign({},me,{plugins:t}))):Bg).reduce(function(i,o){var s=(e.getAttribute("data-tippy-"+o)||"").trim();if(!s)return i;if("content"===o)i[o]=s;else try{i[o]=JSON.parse(s)}catch(c){i[o]=s}return i},{})}(e,t.plugins));return n.aria=Object.assign({},me.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}function Na(e,t){e.innerHTML=t}function Pu(e){var t=ur();return!0===e?t.className=mu:(t.className=gu,Fo(e)?t.appendChild(e):Na(t,e)),t}function Ru(e,t){Fo(t.content)?(Na(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?Na(e,t.content):e.textContent=t.content)}function Lo(e){var t=e.firstElementChild,n=Hr(t.children);return{box:t,content:n.find(function(r){return r.classList.contains(du)}),arrow:n.find(function(r){return r.classList.contains(mu)||r.classList.contains(gu)}),backdrop:n.find(function(r){return r.classList.contains("tippy-backdrop")})}}function Zu(e){var t=ur(),n=ur();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=ur();function i(o,s){var c=Lo(t),l=c.box,u=c.content,p=c.arrow;s.theme?l.setAttribute("data-theme",s.theme):l.removeAttribute("data-theme"),"string"==typeof s.animation?l.setAttribute("data-animation",s.animation):l.removeAttribute("data-animation"),s.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth="number"==typeof s.maxWidth?s.maxWidth+"px":s.maxWidth,s.role?l.setAttribute("role",s.role):l.removeAttribute("role"),(o.content!==s.content||o.allowHTML!==s.allowHTML)&&Ru(u,e.props),s.arrow?p?o.arrow!==s.arrow&&(l.removeChild(p),l.appendChild(Pu(s.arrow))):l.appendChild(Pu(s.arrow)):p&&l.removeChild(p)}return r.className=du,r.setAttribute("data-state","hidden"),Ru(r,e.props),t.appendChild(n),n.appendChild(r),i(e.props,e.props),{popper:t,onUpdate:i}}Zu.$$tippy=!0;var Vg=1,zo=[],Vo=[];function Hg(e,t){var r,i,o,p,f,d,_,n=Iu(e,Object.assign({},me,Du(wu(t)))),s=!1,c=!1,l=!1,u=!1,g=[],y=bu(jo,n.interactiveDebounce),C=Vg++,M=function Sg(e){return e.filter(function(t,n){return e.indexOf(t)===n})}(n.plugins),b={id:C,reference:e,popper:ur(),popperInstance:null,props:n,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:M,clearDelayTimeouts:function Xo(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(o)},setProps:function Go(I){if(!b.state.isDestroyed){Ut("onBeforeUpdate",[b,I]),Uo();var W=b.props,G=Iu(e,Object.assign({},W,wu(I),{ignoreAttributes:!0}));b.props=G,jr(),W.interactiveDebounce!==G.interactiveDebounce&&(pr(),y=bu(jo,G.interactiveDebounce)),W.triggerTarget&&!G.triggerTarget?Vn(W.triggerTarget).forEach(function(gt){gt.removeAttribute("aria-expanded")}):G.triggerTarget&&e.removeAttribute("aria-expanded"),on(),Pt(),J&&J(W,G),b.popperInstance&&(Yo(),Un().forEach(function(gt){requestAnimationFrame(gt._tippy.popperInstance.forceUpdate)})),Ut("onAfterUpdate",[b,I])}},setContent:function $o(I){b.setProps({content:I})},show:function Jv(){var I=b.state.isVisible,W=b.state.isDestroyed,G=!b.state.isEnabled,gt=nn.isTouch&&!b.props.touch,dt=ka(b.props.duration,0,me.duration);if(!(I||W||G||gt||mt().hasAttribute("disabled")||(Ut("onShow",[b],!1),!1===b.props.onShow(b)))){if(b.state.isVisible=!0,ft()&&(D.style.visibility="visible"),Pt(),ze(),b.state.isMounted||(D.style.transition="none"),ft()){var ce=xt();Aa([ce.box,ce.content],0)}d=function(){var hr;if(b.state.isVisible&&!u){if(u=!0,D.style.transition=b.props.moveTransition,ft()&&b.props.animation){var Pa=xt(),ts=Pa.box,Yr=Pa.content;Aa([ts,Yr],dt),Ri([ts,Yr],"visible")}rn(),on(),_u(Vo,b),null==(hr=b.popperInstance)||hr.forceUpdate(),Ut("onMount",[b]),b.props.animation&&ft()&&function bn(I,W){Ur(I,W)}(dt,function(){b.state.isShown=!0,Ut("onShown",[b])})}},function _n(){var W,I=b.props.appendTo,G=mt();(W=b.props.interactive&&I===vu||"parent"===I?G.parentNode:yu(I,[G])).contains(D)||W.appendChild(D),b.state.isMounted=!0,Yo()}()}},hide:function Uv(){var I=!b.state.isVisible,W=b.state.isDestroyed,G=!b.state.isEnabled,gt=ka(b.props.duration,1,me.duration);if(!(I||W||G)&&(Ut("onHide",[b],!1),!1!==b.props.onHide(b))){if(b.state.isVisible=!1,b.state.isShown=!1,u=!1,s=!1,ft()&&(D.style.visibility="hidden"),pr(),yn(),Pt(!0),ft()){var dt=xt(),ce=dt.box,Ne=dt.content;b.props.animation&&(Aa([ce,Ne],gt),Ri([ce,Ne],"hidden"))}rn(),on(),b.props.animation?ft()&&function Jr(I,W){Ur(I,function(){!b.state.isVisible&&D.parentNode&&D.parentNode.contains(D)&&W()})}(gt,b.unmount):b.unmount()}},hideWithInteractivity:function jv(I){Zt().addEventListener("mousemove",y),_u(zo,y),y(I)},enable:function zi(){b.state.isEnabled=!0},disable:function Qo(){b.hide(),b.state.isEnabled=!1},unmount:function Wv(){b.state.isVisible&&b.hide(),b.state.isMounted&&(Ko(),Un().forEach(function(I){I._tippy.unmount()}),D.parentNode&&D.parentNode.removeChild(D),Vo=Vo.filter(function(I){return I!==b}),b.state.isMounted=!1,Ut("onHidden",[b]))},destroy:function Yv(){b.state.isDestroyed||(b.clearDelayTimeouts(),b.unmount(),Uo(),delete e._tippy,b.state.isDestroyed=!0,Ut("onDestroy",[b]))}};if(!n.render)return b;var P=n.render(b),D=P.popper,J=P.onUpdate;D.setAttribute("data-tippy-root",""),D.id="tippy-"+b.id,b.popper=D,e._tippy=b,D._tippy=b;var j=M.map(function(I){return I.fn(b)}),X=e.hasAttribute("aria-expanded");return jr(),on(),Pt(),Ut("onCreate",[b]),n.showOnCreate&&Li(),D.addEventListener("mouseenter",function(){b.props.interactive&&b.state.isVisible&&b.clearDelayTimeouts()}),D.addEventListener("mouseleave",function(){b.props.interactive&&b.props.trigger.indexOf("mouseenter")>=0&&Zt().addEventListener("mousemove",y)}),b;function nt(){var I=b.props.touch;return Array.isArray(I)?I:[I,0]}function ct(){return"hold"===nt()[0]}function ft(){var I;return!(null==(I=b.props.render)||!I.$$tippy)}function mt(){return _||e}function Zt(){var I=mt().parentNode;return I?function Tu(e){var t,r=Vn(e)[0];return null!=r&&null!=(t=r.ownerDocument)&&t.body?r.ownerDocument:document}(I):document}function xt(){return Lo(D)}function lt(I){return b.state.isMounted&&!b.state.isVisible||nn.isTouch||p&&"focus"===p.type?0:ka(b.props.delay,I?0:1,me.delay)}function Pt(I){void 0===I&&(I=!1),D.style.pointerEvents=b.props.interactive&&!I?"":"none",D.style.zIndex=""+b.props.zIndex}function Ut(I,W,G){var gt;void 0===G&&(G=!0),j.forEach(function(dt){dt[I]&&dt[I].apply(dt,W)}),G&&(gt=b.props)[I].apply(gt,W)}function rn(){var I=b.props.aria;if(I.content){var W="aria-"+I.content,G=D.id;Vn(b.props.triggerTarget||e).forEach(function(dt){var ce=dt.getAttribute(W);if(b.state.isVisible)dt.setAttribute(W,ce?ce+" "+G:G);else{var Ne=ce&&ce.replace(G,"").trim();Ne?dt.setAttribute(W,Ne):dt.removeAttribute(W)}})}}function on(){!X&&b.props.aria.expanded&&Vn(b.props.triggerTarget||e).forEach(function(W){b.props.interactive?W.setAttribute("aria-expanded",b.state.isVisible&&W===mt()?"true":"false"):W.removeAttribute("aria-expanded")})}function pr(){Zt().removeEventListener("mousemove",y),zo=zo.filter(function(I){return I!==y})}function sn(I){if(!nn.isTouch||!l&&"mousedown"!==I.type){var W=I.composedPath&&I.composedPath()[0]||I.target;if(!b.props.interactive||!ku(D,W)){if(Vn(b.props.triggerTarget||e).some(function(G){return ku(G,W)})){if(nn.isTouch||b.state.isVisible&&b.props.trigger.indexOf("click")>=0)return}else Ut("onClickOutside",[b,I]);!0===b.props.hideOnClick&&(b.clearDelayTimeouts(),b.hide(),c=!0,setTimeout(function(){c=!1}),b.state.isMounted||yn())}}}function fr(){l=!0}function vn(){l=!1}function ze(){var I=Zt();I.addEventListener("mousedown",sn,!0),I.addEventListener("touchend",sn,zn),I.addEventListener("touchstart",vn,zn),I.addEventListener("touchmove",fr,zn)}function yn(){var I=Zt();I.removeEventListener("mousedown",sn,!0),I.removeEventListener("touchend",sn,zn),I.removeEventListener("touchstart",vn,zn),I.removeEventListener("touchmove",fr,zn)}function Ur(I,W){var G=xt().box;function gt(dt){dt.target===G&&(Ea(G,"remove",gt),W())}if(0===I)return W();Ea(G,"remove",f),Ea(G,"add",gt),f=gt}function Jn(I,W,G){void 0===G&&(G=!1),Vn(b.props.triggerTarget||e).forEach(function(dt){dt.addEventListener(I,W,G),g.push({node:dt,eventType:I,handler:W,options:G})})}function jr(){ct()&&(Jn("touchstart",qi,{passive:!0}),Jn("touchend",Wo,{passive:!0})),function kg(e){return e.split(/\s+/).filter(Boolean)}(b.props.trigger).forEach(function(I){if("manual"!==I)switch(Jn(I,qi),I){case"mouseenter":Jn("mouseleave",Wo);break;case"focus":Jn(Pg?"focusout":"blur",Bi);break;case"focusin":Jn("focusout",Bi)}})}function Uo(){g.forEach(function(I){I.node.removeEventListener(I.eventType,I.handler,I.options)}),g=[]}function qi(I){var W,G=!1;if(b.state.isEnabled&&!Fi(I)&&!c){var gt="focus"===(null==(W=p)?void 0:W.type);p=I,_=I.currentTarget,on(),!b.state.isVisible&&function Oa(e){return Sa(e,"MouseEvent")}(I)&&zo.forEach(function(dt){return dt(I)}),"click"===I.type&&(b.props.trigger.indexOf("mouseenter")<0||s)&&!1!==b.props.hideOnClick&&b.state.isVisible?G=!0:Li(I),"click"===I.type&&(s=!G),G&&!gt&&dr(I)}}function jo(I){var W=I.target,G=mt().contains(W)||D.contains(W);"mousemove"===I.type&&G||function Ag(e,t){var n=t.clientX,r=t.clientY;return e.every(function(i){var o=i.popperRect,s=i.popperState,l=i.props.interactiveBorder,u=function xu(e){return e.split("-")[0]}(s.placement),p=s.modifiersData.offset;return!p||o.top-r+("bottom"===u?p.top.y:0)>l||r-o.bottom-("top"===u?p.bottom.y:0)>l||o.left-n+("right"===u?p.left.x:0)>l||n-o.right-("left"===u?p.right.x:0)>l})}(Un().concat(D).map(function(dt){var ce,Wr=null==(ce=dt._tippy.popperInstance)?void 0:ce.state;return Wr?{popperRect:dt.getBoundingClientRect(),popperState:Wr,props:n}:null}).filter(Boolean),I)&&(pr(),dr(I))}function Wo(I){if(!(Fi(I)||b.props.trigger.indexOf("click")>=0&&s)){if(b.props.interactive)return void b.hideWithInteractivity(I);dr(I)}}function Bi(I){b.props.trigger.indexOf("focusin")<0&&I.target!==mt()||b.props.interactive&&I.relatedTarget&&D.contains(I.relatedTarget)||dr(I)}function Fi(I){return!!nn.isTouch&&ct()!==I.type.indexOf("touch")>=0}function Yo(){Ko();var I=b.props,W=I.popperOptions,G=I.placement,gt=I.offset,dt=I.getReferenceClientRect,ce=I.moveTransition,Ne=ft()?Lo(D).arrow:null,Wr=dt?{getBoundingClientRect:dt,contextElement:dt.contextElement||mt()}:e,hr=[{name:"offset",options:{offset:gt}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!ce}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(ts){var Yr=ts.state;if(ft()){var Ra=xt().box;["placement","reference-hidden","escaped"].forEach(function(es){"placement"===es?Ra.setAttribute("data-placement",Yr.placement):Yr.attributes.popper["data-popper-"+es]?Ra.setAttribute("data-"+es,""):Ra.removeAttribute("data-"+es)}),Yr.attributes.popper={}}}}];ft()&&Ne&&hr.push({name:"arrow",options:{element:Ne,padding:3}}),hr.push.apply(hr,(null==W?void 0:W.modifiers)||[]),b.popperInstance=wg(Wr,D,Object.assign({},W,{placement:G,onFirstUpdate:d,modifiers:hr}))}function Ko(){b.popperInstance&&(b.popperInstance.destroy(),b.popperInstance=null)}function Un(){return Hr(D.querySelectorAll("[data-tippy-root]"))}function Li(I){b.clearDelayTimeouts(),I&&Ut("onTrigger",[b,I]),ze();var W=lt(!0),G=nt(),dt=G[1];nn.isTouch&&"hold"===G[0]&&dt&&(W=dt),W?r=setTimeout(function(){b.show()},W):b.show()}function dr(I){if(b.clearDelayTimeouts(),Ut("onUntrigger",[b,I]),b.state.isVisible){if(!(b.props.trigger.indexOf("mouseenter")>=0&&b.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(I.type)>=0&&s)){var W=lt(!1);W?i=setTimeout(function(){b.state.isVisible&&b.hide()},W):o=requestAnimationFrame(function(){b.hide()})}}else yn()}}function Hn(e,t){void 0===t&&(t={});var n=me.plugins.concat(t.plugins||[]);!function Dg(){document.addEventListener("touchstart",Eg,zn),window.addEventListener("blur",Ng)}();var r=Object.assign({},t,{plugins:n}),c=function Og(e){return Fo(e)?[e]:function Mg(e){return Sa(e,"NodeList")}(e)?Hr(e):Array.isArray(e)?e:Hr(document.querySelectorAll(e))}(e).reduce(function(l,u){var p=u&&Hg(u,r);return p&&l.push(p),l},[]);return Fo(e)?c[0]:c}Hn.defaultProps=me,Hn.setDefaultProps=function(t){Object.keys(t).forEach(function(r){me[r]=t[r]})},Hn.currentInput=nn,Object.assign({},iu,{effect:function(t){var n=t.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}}),Hn.setDefaultProps({render:Zu});const Fu=Hn;class Xg{constructor({editor:t,element:n,view:r,tippyOptions:i={},shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:s,state:c})=>{const{selection:l}=c,{$anchor:u,empty:p}=l,f=1===u.depth,d=u.parent.isTextblock&&!u.parent.type.spec.code&&!u.parent.textContent;return!!(s.hasFocus()&&p&&f&&d)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:s})=>{var c;this.preventHide?this.preventHide=!1:(null==s?void 0:s.relatedTarget)&&(null===(c=this.element.parentNode)||void 0===c?void 0:c.contains(s.relatedTarget))||this.hide()},this.editor=t,this.element=n,this.view=r,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options;this.tippy||!t.parentElement||(this.tippy=Fu(t,Z({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle"},this.tippyOptions)),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",r=>{this.blurHandler({event:r})}))}update(t,n){var r,i;const{state:o}=t,{doc:s,selection:c}=o,{from:l,to:u}=c;n&&n.doc.eq(s)&&n.selection.eq(c)||(this.createTooltip(),(null===(r=this.shouldShow)||void 0===r?void 0:r.call(this,{editor:this.editor,view:t,state:o,oldState:n}))?(null===(i=this.tippy)||void 0===i||i.setProps({getReferenceClientRect:()=>Fl(t,l,u)}),this.show()):this.hide())}show(){var t;null===(t=this.tippy)||void 0===t||t.show()}hide(){var t;null===(t=this.tippy)||void 0===t||t.hide()}destroy(){var t;null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}se.create({name:"floatingMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[(e={pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow},new ie({key:"string"==typeof e.pluginKey?new Te(e.pluginKey):e.pluginKey,view:t=>new Xg(Z({view:t},e))}))]:[];var e}});class $g{constructor({editor:t,element:n,view:r,tippyOptions:i={},shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:s,state:c,from:l,to:u})=>{const{doc:p,selection:f}=c,{empty:d}=f,g=!p.textBetween(l,u).length&&_l(c.selection);return!(!s.hasFocus()||d||g)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:s})=>{var c;this.preventHide?this.preventHide=!1:(null==s?void 0:s.relatedTarget)&&(null===(c=this.element.parentNode)||void 0===c?void 0:c.contains(s.relatedTarget))||this.hide()},this.editor=t,this.element=n,this.view=r,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options;this.tippy||!t.parentElement||(this.tippy=Fu(t,Z({duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle"},this.tippyOptions)),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",r=>{this.blurHandler({event:r})}))}update(t,n){var r,i;const{state:o,composing:s}=t,{doc:c,selection:l}=o,u=n&&n.doc.eq(c)&&n.selection.eq(l);if(s||u)return;this.createTooltip();const{ranges:p}=l,f=Math.min(...p.map(y=>y.$from.pos)),d=Math.max(...p.map(y=>y.$to.pos));(null===(r=this.shouldShow)||void 0===r?void 0:r.call(this,{editor:this.editor,view:t,state:o,oldState:n,from:f,to:d}))?(null===(i=this.tippy)||void 0===i||i.setProps({getReferenceClientRect:()=>{if(function _h(e){return bl(e)&&e instanceof et}(o.selection)){const y=t.nodeDOM(f);if(y)return y.getBoundingClientRect()}return Fl(t,f,d)}}),this.show()):this.hide()}show(){var t;null===(t=this.tippy)||void 0===t||t.show()}hide(){var t;null===(t=this.tippy)||void 0===t||t.hide()}destroy(){var t;null===(t=this.tippy)||void 0===t||t.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}se.create({name:"bubbleMenu",addOptions:()=>({element:null,tippyOptions:{},pluginKey:"bubbleMenu",shouldShow:null}),addProseMirrorPlugins(){return this.options.element?[(e={pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow},new ie({key:"string"==typeof e.pluginKey?new Te(e.pluginKey):e.pluginKey,view:t=>new $g(Z({view:t},e))}))]:[];var e}});let ev=(()=>{class e{constructor(n,r){this.el=n,this._renderer=r,this.outputFormat="html",this.onChange=()=>{},this.onTouched=()=>{},this.handleChange=({transaction:i})=>{if(i.docChanged){if("html"===this.outputFormat)return void this.onChange(this.editor.getHTML());this.onChange(this.editor.getJSON())}}}writeValue(n){!this.outputFormat&&"string"==typeof n&&(this.outputFormat="html"),this.editor.chain().setContent(n,!1).run()}registerOnChange(n){this.onChange=n}registerOnTouched(n){this.onTouched=n}setDisabledState(n){this.editor.setEditable(!n),this._renderer.setProperty(this.el.nativeElement,"disabled",n)}ngOnInit(){if(!this.editor)throw new Error("Required: Input `editor`");const n=this.el.nativeElement.innerHTML;this.el.nativeElement.innerHTML="",this.el.nativeElement.append(...Array.from(this.editor.options.element.childNodes)),this.editor.setOptions({element:this.el.nativeElement}),n&&this.editor.chain().setContent(n,!1).run(),this.editor.on("blur",()=>{this.onTouched()}),this.editor.on("transaction",this.handleChange)}ngOnDestroy(){this.editor.destroy()}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(a.SBq),a.Y36(a.Qsj))},e.\u0275dir=a.lG2({type:e,selectors:[["tiptap","editor",""],["","tiptap","","editor",""],["tiptap-editor","editor",""],["","tiptapEditor","","editor",""]],inputs:{editor:"editor",outputFormat:"outputFormat"},features:[a._Bn([{provide:H.JU,useExisting:(0,a.Gpc)(()=>e),multi:!0}])]}),e})(),nv=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({}),e})();const Ia=function(e){return{"is-active":e}},ov=function(){return{standalone:!0}};function sv(e,t){if(1&e){const n=a.EpF();a.ynx(0),a.TgZ(1,"div",7),a.TgZ(2,"div",8),a.TgZ(3,"ul",9),a.TgZ(4,"li",5),a.NdJ("click",function(){return a.CHM(n),a.oxw().editor.chain().focus().toggleBold().run()}),a._UZ(5,"i",10),a.qZA(),a.TgZ(6,"li",5),a.NdJ("click",function(){return a.CHM(n),a.oxw().editor.chain().focus().toggleItalic().run()}),a._UZ(7,"i",11),a.qZA(),a.TgZ(8,"li",5),a.NdJ("click",function(){return a.CHM(n),a.oxw().editor.chain().focus().toggleStrike().run()}),a._UZ(9,"i",12),a.qZA(),a.qZA(),a.qZA(),a.TgZ(10,"tiptap-editor",13),a.NdJ("ngModelChange",function(i){return a.CHM(n),a.oxw().value=i}),a.qZA(),a.qZA(),a.BQk()}if(2&e){const n=a.oxw();a.xp6(4),a.Q6J("ngClass",a.VKq(6,Ia,n.editor.isActive("bold"))),a.xp6(2),a.Q6J("ngClass",a.VKq(8,Ia,n.editor.isActive("italic"))),a.xp6(2),a.Q6J("ngClass",a.VKq(10,Ia,n.editor.isActive("strike"))),a.xp6(2),a.Q6J("editor",n.editor)("ngModel",n.value)("ngModelOptions",a.DdM(12,ov))}}function av(e,t){if(1&e&&(a.TgZ(0,"option",31),a._uU(1),a.qZA()),2&e){const n=t.$implicit;a.Q6J("value",n),a.xp6(1),a.Oqu(n)}}function cv(e,t){if(1&e&&(a.TgZ(0,"option",31),a._uU(1),a.qZA()),2&e){const n=t.$implicit;a.Q6J("value",n),a.xp6(1),a.Oqu(n)}}function lv(e,t){if(1&e&&(a.TgZ(0,"option",31),a._uU(1),a.qZA()),2&e){const n=t.$implicit;a.Q6J("value",n),a.xp6(1),a.Oqu(n)}}function uv(e,t){if(1&e&&(a.TgZ(0,"option",31),a._uU(1),a.qZA()),2&e){const n=t.$implicit;a.Q6J("value",n),a.xp6(1),a.Oqu(n)}}function pv(e,t){if(1&e&&(a.TgZ(0,"option",31),a._uU(1),a.qZA()),2&e){const n=t.$implicit;a.Q6J("value",n),a.xp6(1),a.Oqu(n)}}function fv(e,t){1&e&&(a.TgZ(0,"li"),a._uU(1," r\xe9paration \xe0 pr\xe9voir "),a.qZA())}function dv(e,t){1&e&&(a.TgZ(0,"li"),a._uU(1," possibilit\xe9 d\u2019\xe9change "),a.qZA())}function hv(e,t){1&e&&(a.TgZ(0,"li"),a._uU(1," v\xe9hicule endommag\xe9 "),a.qZA())}function mv(e,t){1&e&&(a.TgZ(0,"li"),a._uU(1," prix n\xe9gociable "),a.qZA())}function gv(e,t){1&e&&(a.TgZ(0,"li"),a._uU(1," v\xe9hicule non fumeur "),a.qZA())}const vv=function(){return["Noir","Gris argent","gris anthracite","Gris shark","Blanc","Rouge","Blue","Beige","Jaune","Orange","Vert","Aubergine","Marron"]},yv=function(){return["1\xe8re main","2\xe9me main","autre"]},bv=function(){return["Excellent","bon","correct"]},_v=function(){return["Parfaite, sans aucune rayure","Propre, avec l\xe9g\xe8res rayures","Moyen, avec painture \xe9caill\xe9e et rayures"]},xv=function(){return["Intacte, sans traces d'usure","Propre, avec l\xe9g\xe8res traces d'usure","Correct, avec traces d'usure importante"]};function wv(e,t){if(1&e){const n=a.EpF();a.ynx(0),a.TgZ(1,"div",14),a.TgZ(2,"div",15),a._uU(3," A vendre Isuzu DMAX 4P, couleur "),a.TgZ(4,"select",16),a.NdJ("ngModelChange",function(i){return a.CHM(n),a.oxw().description_assisted[0]=i})("change",function(){return a.CHM(n),a.oxw().emitChanges(0)}),a.TgZ(5,"option",17),a._uU(6,"\u2014\u2014\u2014\u2014\u2014\u2014"),a.qZA(),a.YNc(7,av,2,2,"option",18),a.qZA(),a._uU(8,", "),a.TgZ(9,"select",19),a.NdJ("ngModelChange",function(i){return a.CHM(n),a.oxw().description_assisted[1]=i})("change",function(){return a.CHM(n),a.oxw().emitChanges(1)}),a.TgZ(10,"option",17),a._uU(11,"\u2014\u2014\u2014\u2014\u2014\u2014"),a.qZA(),a.YNc(12,cv,2,2,"option",18),a.qZA(),a._uU(13,", \xe9tat g\xe9n\xe9ral "),a.TgZ(14,"select",20),a.NdJ("ngModelChange",function(i){return a.CHM(n),a.oxw().description_assisted[2]=i})("change",function(){return a.CHM(n),a.oxw().emitChanges(2)}),a.TgZ(15,"option",17),a._uU(16,"\u2014\u2014\u2014\u2014\u2014\u2014"),a.qZA(),a.YNc(17,lv,2,2,"option",18),a.qZA(),a._uU(18,", carrosserie "),a.TgZ(19,"select",21),a.NdJ("ngModelChange",function(i){return a.CHM(n),a.oxw().description_assisted[3]=i})("change",function(){return a.CHM(n),a.oxw().emitChanges(3)}),a.TgZ(20,"option",17),a._uU(21,"\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014"),a.qZA(),a.YNc(22,uv,2,2,"option",18),a.qZA(),a._uU(23,", int\xe9rieur "),a.TgZ(24,"select",22),a.NdJ("ngModelChange",function(i){return a.CHM(n),a.oxw().description_assisted[4]=i})("change",function(){return a.CHM(n),a.oxw().emitChanges(4)}),a.TgZ(25,"option",17),a._uU(26,"\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014"),a.qZA(),a.YNc(27,pv,2,2,"option",18),a.qZA(),a._uU(28,". "),a.TgZ(29,"ul"),a.YNc(30,fv,2,0,"li",6),a.YNc(31,dv,2,0,"li",6),a.YNc(32,hv,2,0,"li",6),a.YNc(33,mv,2,0,"li",6),a.YNc(34,gv,2,0,"li",6),a.qZA(),a.qZA(),a.TgZ(35,"div",23),a.TgZ(36,"ul"),a.TgZ(37,"li"),a.TgZ(38,"label",24),a.TgZ(39,"input",25),a.NdJ("change",function(i){return a.CHM(n),a.oxw().addDescription(i,0)}),a.qZA(),a._UZ(40,"span",26),a.TgZ(41,"span",27),a._uU(42,"Pas de d\xe9pense \xe0 pr\xe9voir"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(43,"li"),a.TgZ(44,"label",24),a.TgZ(45,"input",28),a.NdJ("change",function(i){return a.CHM(n),a.oxw().addDescription(i,0)}),a.qZA(),a._UZ(46,"span",26),a.TgZ(47,"span",27),a._uU(48,"R\xe9paration \xe0 pr\xe9voir"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(49,"li"),a.TgZ(50,"label",24),a.TgZ(51,"input",29),a.NdJ("change",function(i){return a.CHM(n),a.oxw().addDescription(i,1)}),a.qZA(),a._UZ(52,"span",26),a.TgZ(53,"span",27),a._uU(54,"Possibilit\xe9 d'\xe9change"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(55,"li"),a.TgZ(56,"label",24),a.TgZ(57,"input",30),a.NdJ("change",function(i){return a.CHM(n),a.oxw().addDescription(i,2)}),a.qZA(),a._UZ(58,"span",26),a.TgZ(59,"span",27),a._uU(60,"V\xe9hicule endommag\xe9"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(61,"li"),a.TgZ(62,"label",24),a.TgZ(63,"input",30),a.NdJ("change",function(i){return a.CHM(n),a.oxw().addDescription(i,3)}),a.qZA(),a._UZ(64,"span",26),a.TgZ(65,"span",27),a._uU(66,"Prix n\xe9gociable"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(67,"li"),a.TgZ(68,"label",24),a.TgZ(69,"input",30),a.NdJ("change",function(i){return a.CHM(n),a.oxw().addDescription(i,4)}),a.qZA(),a._UZ(70,"span",26),a.TgZ(71,"span",27),a._uU(72,"V\xe9hicule non fumeur"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.BQk()}if(2&e){const n=a.oxw();a.xp6(4),a.Q6J("ngModel",n.description_assisted[0]),a.xp6(3),a.Q6J("ngForOf",a.DdM(15,vv)),a.xp6(2),a.Q6J("ngModel",n.description_assisted[1]),a.xp6(3),a.Q6J("ngForOf",a.DdM(16,yv)),a.xp6(2),a.Q6J("ngModel",n.description_assisted[2]),a.xp6(3),a.Q6J("ngForOf",a.DdM(17,bv)),a.xp6(2),a.Q6J("ngModel",n.description_assisted[3]),a.xp6(3),a.Q6J("ngForOf",a.DdM(18,_v)),a.xp6(2),a.Q6J("ngModel",n.description_assisted[4]),a.xp6(3),a.Q6J("ngForOf",a.DdM(19,xv)),a.xp6(3),a.Q6J("ngIf",n.description[0]),a.xp6(1),a.Q6J("ngIf",n.description[1]),a.xp6(1),a.Q6J("ngIf",n.description[2]),a.xp6(1),a.Q6J("ngIf",n.description[3]),a.xp6(1),a.Q6J("ngIf",n.description[4])}}const Lu=function(e){return{active:e}};let Cv=(()=>{class e{constructor(n,r){this.router=n,this.postingService=r,this.assisted=!0,this.description=[!1,!1,!1,!1,!1],this.description_assisted=["","","","",""],this.editor=new mh({extensions:[ym]}),this.value=""}ngOnInit(){}emitChanges(n){this.postingService.emitDetails({step_details:3,desc:this.description,desc_assisted:this.description_assisted})}changeAssisted(n){setTimeout(()=>{this.assisted=n},3e3)}addDescription(n,r){this.description[r]="cost"==n.target.name?0!=n.target.value:!!n.target.checked,this.postingService.emitDetails({step_details:3,desc:this.description,desc_assisted:this.description_assisted})}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(le.F0),a.Y36(Ve))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-description"]],decls:12,vars:8,consts:[[1,"global-container"],[1,"form-container","description"],[1,"description"],[1,"choose-assisted"],[1,"buttons","_displayFlex"],[3,"ngClass","click"],[4,"ngIf"],[1,"editor"],[1,"toolbar"],[1,"_displayFlex"],[1,"fa-solid","fa-bold"],[1,"fa-solid","fa-italic"],[1,"fa-solid","fa-strikethrough"],[3,"editor","ngModel","ngModelOptions","ngModelChange"],[1,"description-main","_displayFlex"],[1,"desc-left"],["name","color",3,"ngModel","ngModelChange","change"],["value","","selected","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["name","used",3,"ngModel","ngModelChange","change"],["name","condition",3,"ngModel","ngModelChange","change"],["name","body",3,"ngModel","ngModelChange","change"],["name","int",3,"ngModel","ngModelChange","change"],[1,"desc-right"],[1,"checkbox-label"],["type","radio","value","0","name","cost",3,"change"],[1,"checkbox-custom"],[1,"text-custom"],["type","radio","value","1","name","cost",3,"change"],["type","checkbox","value","1","name","exchange",3,"change"],["type","checkbox",3,"change"],[3,"value"]],template:function(n,r){1&n&&(a.TgZ(0,"div",0),a.TgZ(1,"form",1),a.TgZ(2,"div",2),a.TgZ(3,"div",3),a._uU(4," Je veux \xeatre assist\xe9(e) pour la description de l\u2019annonce "),a.TgZ(5,"div",4),a.TgZ(6,"button",5),a.NdJ("click",function(){return r.changeAssisted(!0)}),a._uU(7,"Oui"),a.qZA(),a.TgZ(8,"button",5),a.NdJ("click",function(){return r.changeAssisted(!1)}),a._uU(9,"Non"),a.qZA(),a.qZA(),a.qZA(),a.YNc(10,sv,11,13,"ng-container",6),a.YNc(11,wv,73,20,"ng-container",6),a.qZA(),a.qZA(),a.qZA()),2&n&&(a.xp6(6),a.Q6J("ngClass",a.VKq(4,Lu,r.assisted)),a.xp6(2),a.Q6J("ngClass",a.VKq(6,Lu,!r.assisted)),a.xp6(2),a.Q6J("ngIf",!r.assisted),a.xp6(1),a.Q6J("ngIf",r.assisted))},directives:[H._Y,H.JL,H.F,Gt.mk,Gt.O5,ev,H.JJ,H.On,H.EJ,H.YN,H.Kr,Gt.sg],encapsulation:2}),e})();function Tv(e,t){1&e&&a._UZ(0,"app-previews")}function kv(e,t){1&e&&a._UZ(0,"app-price")}function Sv(e,t){1&e&&a._UZ(0,"app-description")}function Ov(e,t){1&e&&a._UZ(0,"i",13)}function Av(e,t){1&e&&a._UZ(0,"i",14)}function Ev(e,t){1&e&&a._UZ(0,"i",13)}function Nv(e,t){1&e&&a._UZ(0,"i",14)}function Dv(e,t){1&e&&a._UZ(0,"i",13)}function Iv(e,t){1&e&&a._UZ(0,"i",14)}function Pv(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"li"),a.TgZ(1,"label",18),a.TgZ(2,"input",19),a.NdJ("change",function(i){return a.CHM(n),a.oxw(2).checkInput(i)}),a.qZA(),a._UZ(3,"span",20),a.TgZ(4,"span",21),a._uU(5),a.qZA(),a.qZA(),a.qZA()}if(2&e){const n=t.$implicit,r=t.index;a.xp6(2),a.Q6J("formControlName","ext"+r),a.xp6(3),a.Oqu(n.name)}}function Rv(e,t){if(1&e){const n=a.EpF();a.ynx(0),a.TgZ(1,"ul",15),a.YNc(2,Pv,6,2,"li",16),a.TgZ(3,"button",17),a.NdJ("click",function(){return a.CHM(n),a.oxw().selectAll()}),a._uU(4),a.qZA(),a.qZA(),a.BQk()}if(2&e){const n=a.oxw();a.xp6(2),a.Q6J("ngForOf",n.inputsExt),a.xp6(2),a.Oqu(n.checked==n.inputsExt.length?"D\xe9selectionner tout":"S\xe9lectionner tout")}}function Zv(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"li"),a.TgZ(1,"label",18),a.TgZ(2,"input",19),a.NdJ("change",function(i){return a.CHM(n),a.oxw(2).checkInput(i)}),a.qZA(),a._UZ(3,"span",20),a.TgZ(4,"span",21),a._uU(5),a.qZA(),a.qZA(),a.qZA()}if(2&e){const n=t.$implicit,r=t.index;a.xp6(2),a.Q6J("formControlName","int"+r),a.xp6(3),a.Oqu(n.name)}}function qv(e,t){if(1&e){const n=a.EpF();a.ynx(0),a.TgZ(1,"ul",15),a.YNc(2,Zv,6,2,"li",16),a.TgZ(3,"button",17),a.NdJ("click",function(){return a.CHM(n),a.oxw().selectAll()}),a._uU(4),a.qZA(),a.qZA(),a.BQk()}if(2&e){const n=a.oxw();a.xp6(2),a.Q6J("ngForOf",n.inputsInt),a.xp6(2),a.Oqu(n.checked==n.inputsExt.length?"D\xe9selectionner tout":"S\xe9lectionner tout")}}function Bv(e,t){if(1&e){const n=a.EpF();a.TgZ(0,"li"),a.TgZ(1,"label",18),a.TgZ(2,"input",19),a.NdJ("change",function(i){return a.CHM(n),a.oxw(2).checkInput(i)}),a.qZA(),a._UZ(3,"span",20),a.TgZ(4,"span",21),a._uU(5),a.qZA(),a.qZA(),a.qZA()}if(2&e){const n=t.$implicit,r=t.index;a.xp6(2),a.Q6J("formControlName","confSec"+r),a.xp6(3),a.Oqu(n.name)}}function Fv(e,t){if(1&e){const n=a.EpF();a.ynx(0),a.TgZ(1,"ul",15),a.YNc(2,Bv,6,2,"li",16),a.TgZ(3,"button",17),a.NdJ("click",function(){return a.CHM(n),a.oxw().selectAll()}),a._uU(4),a.qZA(),a.qZA(),a.BQk()}if(2&e){const n=a.oxw();a.xp6(2),a.Q6J("ngForOf",n.inputsConfSec),a.xp6(2),a.Oqu(n.checked==n.inputsExt.length?"D\xe9selectionner tout":"S\xe9lectionner tout")}}const zu=function(e){return{active:e}},Jo=function(e,t){return{"--form":!0,"is-invalid":e,"is-valid":t}},zv=[{path:"",component:Qr,children:[{path:"car",component:cn},{path:"details",component:(()=>{class e{constructor(n,r){this.router=n,this.postingService=r,this.step=1,this.forms=[null,null,null]}ngOnInit(){this.postingService.detailsFormsEmitted.subscribe(n=>{this.forms[n.step_details-1]=n})}prev(){this.step--,0===this.step&&this.postingService.emitSteps("--")}submit(){return this.step++,4===this.step?(this.postingService.emitSteps("++"),this.postingService.emitForm(Object.assign({form:"details"},this.forms)),this.router.navigate(["/posting/contact"])):this.postingService.emitSteps("+")}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(le.F0),a.Y36(Ve))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-details"]],decls:12,vars:3,consts:[[1,"steps-container"],[4,"ngIf"],[1,"bottom","_displayFlex"],["href",""],[1,"group-buttons"],[1,"button",3,"click"]],template:function(n,r){1&n&&(a.TgZ(0,"div",0),a.YNc(1,Tv,1,0,"app-previews",1),a.YNc(2,kv,1,0,"app-price",1),a.YNc(3,Sv,1,0,"app-description",1),a.TgZ(4,"div",2),a.TgZ(5,"a",3),a._uU(6,"Retour"),a.qZA(),a.TgZ(7,"div",4),a.TgZ(8,"button",5),a.NdJ("click",function(){return r.prev()}),a._uU(9,"Pr\xe9cedant"),a.qZA(),a.TgZ(10,"button",5),a.NdJ("click",function(){return r.submit()}),a._uU(11,"Suivant"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&n&&(a.xp6(1),a.Q6J("ngIf",1==r.step),a.xp6(1),a.Q6J("ngIf",2==r.step),a.xp6(1),a.Q6J("ngIf",3==r.step))},directives:[Gt.O5,Qn,vr,Cv],encapsulation:2}),e})()},{path:"equipements",component:(()=>{class e{constructor(n,r,i){this.router=n,this.formBuilder=r,this.postingService=i,this.step=0,this.inputs={},this.checked=0,this.inputsExt=[{name:"Antibrouillards"},{name:"Feux \xe0 LED"},{name:"Toit ouvrant"},{name:"Toit panoramique"},{name:"Vitres teint\xe9es"},{name:"Jantes en aluminium"},{name:"Peinture m\xe9tallis\xe9e"},{name:"Phares au x\xe9non"},{name:"R\xe9troviseurs ext\xe9rieurs \xc9lectriques/rabattables"},{name:"Baguettes ext\xe9rieures d'encadrement des vitres en chrome"}],this.inputsInt=[{name:"Ecran Tactile"},{name:"Ordinateur de bord"},{name:"Connectivit\xe9 USB/Bluetooth"},{name:"Volant multifonctions"},{name:"Volant r\xe9glable en hauteur et en profondeur"},{name:"Sellerie en cuir"},{name:"Si\xe8ges \xe9lectriques"},{name:"Appuis t\xe8tes arri\xe8res"},{name:"Lumi\xe8res d'ambiance"},{name:"Accoudoir"}],this.inputsConfSec=[{name:"Direction assist\xe9e"},{name:"Vitres \xe9lectriques"},{name:"Fermeture centralis\xe9e \xe0 distance"},{name:"Climatisation"},{name:"R\xe9gulateur de Vitesses"},{name:"Cam\xe9ra de recule"},{name:"Radar de recule"},{name:"Airbags"},{name:"ABS"},{name:"ESP"}];for(let o=0;o<10;o++)this.inputs["ext"+o]=[!!this.postingService.formValue["ext"+o]&&this.postingService.formValue["ext"+o]];for(let o=0;o<10;o++)this.inputs["int"+o]=[!!this.postingService.formValue["int"+o]&&this.postingService.formValue["int"+o]];for(let o=0;o<10;o++)this.inputs["confSec"+o]=[!!this.postingService.formValue["confSec"+o]&&this.postingService.formValue["confSec"+o]];this.form=this.formBuilder.group(this.inputs)}ngOnInit(){}get getForm(){return this.form.controls}checkInput(n){return this.checked=n.target.checked?this.checked+1:this.checked-1}selectAll(){let n=0===this.step?"ext":1===this.step?"int":"confSec";if(this.checked<this.inputsExt.length){for(let r=0;r<this.inputsExt.length;r++)this.getForm[n+""+r].setValue(!0);return this.checked=this.inputsExt.length}for(let r=0;r<this.inputsExt.length;r++)this.getForm[n+""+r].setValue(!1);return this.checked=0}prev(){this.step--,-1===this.step&&this.postingService.emitSteps("--")}submit(){return this.step++,this.checked=0,3===this.step?(this.postingService.emitForm(Object.assign({form:"equipements"},this.form.value)),this.postingService.emitSteps("++"),this.router.navigate(["/posting/details"])):this.postingService.emitSteps("+")}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(le.F0),a.Y36(H.qu),a.Y36(Ve))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-equipements"]],decls:28,vars:16,consts:[[1,"steps-container"],[1,"global-container","equipements","_displayFlex"],[1,"sub-step"],[1,"active"],["class","fa-solid fa-circle",4,"ngIf"],["class","fa-solid fa-circle-check checked",4,"ngIf"],[3,"ngClass"],[1,"form-container",3,"formGroup"],[4,"ngIf"],[1,"bottom","_displayFlex"],["href",""],[1,"group-buttons"],[1,"button",3,"click"],[1,"fa-solid","fa-circle"],[1,"fa-solid","fa-circle-check","checked"],[1,"form-checkbox"],[4,"ngFor","ngForOf"],[1,"button","selectAll",3,"click"],[1,"checkbox-label"],["type","checkbox",3,"formControlName","change"],[1,"checkbox-custom"],[1,"text-custom"]],template:function(n,r){1&n&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"div",2),a.TgZ(3,"ul"),a.TgZ(4,"li",3),a.YNc(5,Ov,1,0,"i",4),a.YNc(6,Av,1,0,"i",5),a._uU(7," Ext\xe9rieur "),a.qZA(),a.TgZ(8,"li",6),a.YNc(9,Ev,1,0,"i",4),a.YNc(10,Nv,1,0,"i",5),a._uU(11," Int\xe9rieur "),a.qZA(),a.TgZ(12,"li",6),a.YNc(13,Dv,1,0,"i",4),a.YNc(14,Iv,1,0,"i",5),a._uU(15," Confort et s\xe9curit\xe9 "),a.qZA(),a.qZA(),a.qZA(),a.TgZ(16,"form",7),a.YNc(17,Rv,5,2,"ng-container",8),a.YNc(18,qv,5,2,"ng-container",8),a.YNc(19,Fv,5,2,"ng-container",8),a.qZA(),a.qZA(),a.TgZ(20,"div",9),a.TgZ(21,"a",10),a._uU(22,"Retour"),a.qZA(),a.TgZ(23,"div",11),a.TgZ(24,"button",12),a.NdJ("click",function(){return r.prev()}),a._uU(25,"Pr\xe9cedant"),a.qZA(),a.TgZ(26,"button",12),a.NdJ("click",function(){return r.submit()}),a._uU(27,"Suivant"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&n&&(a.xp6(5),a.Q6J("ngIf",0==r.step),a.xp6(1),a.Q6J("ngIf",0!=r.step),a.xp6(2),a.Q6J("ngClass",a.VKq(12,zu,r.step>=1)),a.xp6(1),a.Q6J("ngIf",r.step<=1),a.xp6(1),a.Q6J("ngIf",r.step>=2),a.xp6(2),a.Q6J("ngClass",a.VKq(14,zu,r.step>=2)),a.xp6(1),a.Q6J("ngIf",r.step<3),a.xp6(1),a.Q6J("ngIf",r.step>=3),a.xp6(2),a.Q6J("formGroup",r.form),a.xp6(1),a.Q6J("ngIf",0==r.step),a.xp6(1),a.Q6J("ngIf",1==r.step),a.xp6(1),a.Q6J("ngIf",2==r.step))},directives:[Gt.O5,Gt.mk,H._Y,H.JL,H.sg,Gt.sg,H.Wl,H.JJ,H.u],encapsulation:2}),e})()},{path:"contact",component:(()=>{class e{constructor(n,r,i){this.router=n,this.formBuilder=r,this.postingService=i,this.form_sent=!1,this.form=this.formBuilder.group({gender:[this.postingService.formValue.gender?this.postingService.formValue.gender:0,[H.kI.required]],name:[this.postingService.formValue.name?this.postingService.formValue.name:"",[H.kI.required]],gouvernorat:[this.postingService.formValue.gouvernorat?this.postingService.formValue.gouvernorat:"",[H.kI.required]],delegation:[this.postingService.formValue.delegation?this.postingService.formValue.delegation:"",[H.kI.required]],number:[this.postingService.formValue.number?this.postingService.formValue.number:"",[H.kI.required,H.kI.pattern("^[0-9]*$"),H.kI.minLength(8),H.kI.maxLength(8)]],show_number:[this.postingService.formValue.show_number?this.postingService.formValue.show_number:0,[H.kI.required,H.kI.pattern("^[0-9]*$"),H.kI.minLength(4),H.kI.maxLength(6)]],type:[this.postingService.formValue.type?this.postingService.formValue.type:0,H.kI.required]})}ngOnInit(){}prev(){this.postingService.emitSteps("--")}moveStep(n){return this.postingService.emitSteps(this.getForm[n].errors?"-":"+")}get getForm(){return this.form.controls}submit(){this.form_sent=!0,!this.form.invalid&&(this.postingService.emitForm(Object.assign({form:"contact"},this.form.value)),this.postingService.emitSteps("++"))}}return e.\u0275fac=function(n){return new(n||e)(a.Y36(le.F0),a.Y36(H.qu),a.Y36(Ve))},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-news-contact"]],decls:75,vars:23,consts:[[1,"steps-container"],[1,"global-container","contact","_displayFlex"],[1,"form-container","contact",3,"formGroup","submit"],[1,"contact-main","_displayFlex"],[1,"form-group"],[1,"checkbox-label"],["type","radio","formControlName","gender",3,"value"],[1,"checkbox-custom"],[1,"text-custom"],["type","text","formControlName","name",3,"ngClass","change"],["formControlName","gouvernorat",3,"ngClass","change"],["value","","disabled","","selected",""],["formControlName","delegation",3,"ngClass","change"],["type","text","formControlName","number",3,"ngClass","change"],["type","radio","formControlName","show_number",3,"value"],[1,"form-group","radio"],[1,"radio-container"],["type","radio","formControlName","type",3,"value"],[1,"tips"],[1,"_displayFlex"],["src","./assets/images/lightbulb.png"],[1,"bottom","_displayFlex"],["href",""],[1,"group-buttons"],[1,"button",3,"click"]],template:function(n,r){1&n&&(a.TgZ(0,"div",0),a.TgZ(1,"div",1),a.TgZ(2,"form",2),a.NdJ("submit",function(){return r.submit()}),a.TgZ(3,"div",3),a.TgZ(4,"div",4),a.TgZ(5,"label"),a._uU(6,"Titre"),a.qZA(),a.TgZ(7,"label",5),a._UZ(8,"input",6),a._UZ(9,"span",7),a.TgZ(10,"span",8),a._uU(11,"M"),a.qZA(),a.qZA(),a.TgZ(12,"label",5),a._UZ(13,"input",6),a._UZ(14,"span",7),a.TgZ(15,"span",8),a._uU(16,"Mme"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(17,"div",4),a.TgZ(18,"label"),a._uU(19,"* Nom & Pr\xe9nom"),a.qZA(),a.TgZ(20,"input",9),a.NdJ("change",function(){return r.moveStep("name")}),a.qZA(),a.qZA(),a.TgZ(21,"div",4),a.TgZ(22,"label"),a._uU(23,"* Gouvernorat"),a.qZA(),a.TgZ(24,"select",10),a.NdJ("change",function(){return r.moveStep("gouvernorat")}),a.TgZ(25,"option",11),a._uU(26,"Veuillez s\xe9lectionner"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(27,"div",4),a.TgZ(28,"label"),a._uU(29,"* D\xe9l\xe9gation"),a.qZA(),a.TgZ(30,"select",12),a.NdJ("change",function(){return r.moveStep("delegation")}),a.TgZ(31,"option",11),a._uU(32,"Veuillez s\xe9lectionner"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(33,"div",4),a.TgZ(34,"label"),a._uU(35,"* N\xb0 de t\xe9l\xe9phone/ Portable"),a.qZA(),a.TgZ(36,"input",13),a.NdJ("change",function(){return r.moveStep("number")}),a.qZA(),a.qZA(),a.TgZ(37,"div",4),a.TgZ(38,"label"),a._uU(39,"* Afficher le n\xb0 sur l\u2019annonce"),a.qZA(),a.TgZ(40,"label",5),a._UZ(41,"input",14),a._UZ(42,"span",7),a.TgZ(43,"span",8),a._uU(44,"Oui"),a.qZA(),a.qZA(),a.TgZ(45,"label",5),a._UZ(46,"input",14),a._UZ(47,"span",7),a.TgZ(48,"span",8),a._uU(49,"Non"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(50,"div",15),a.TgZ(51,"label"),a._uU(52,"* Type"),a.qZA(),a.TgZ(53,"label",16),a._UZ(54,"input",17),a.TgZ(55,"span",8),a._uU(56,"Particulier"),a.qZA(),a.qZA(),a.TgZ(57,"label",16),a._UZ(58,"input",17),a.TgZ(59,"span",8),a._uU(60,"Vendeur pro"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(61,"p"),a._uU(62," Les modifications de vos informations de contact seront mises \xe0 jour dans toutes vos anonces. * Champs obligatoires "),a.qZA(),a.qZA(),a.qZA(),a.TgZ(63,"div",18),a.TgZ(64,"b",19),a._UZ(65,"img",20),a._uU(66,"Ins\xe9rez les informations relatives \xe0 la personne principale qui va prendre en charge la vente du v\xe9hicule."),a.qZA(),a.qZA(),a.qZA(),a.TgZ(67,"div",21),a.TgZ(68,"a",22),a._uU(69,"Retour"),a.qZA(),a.TgZ(70,"div",23),a.TgZ(71,"button",24),a.NdJ("click",function(){return r.prev()}),a._uU(72,"Pr\xe9cedant"),a.qZA(),a.TgZ(73,"button",24),a.NdJ("click",function(){return r.submit()}),a._uU(74,"Suivant"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&n&&(a.xp6(2),a.Q6J("formGroup",r.form),a.xp6(6),a.Q6J("value",0),a.xp6(5),a.Q6J("value",1),a.xp6(7),a.Q6J("ngClass",a.WLB(11,Jo,(r.form.value.name.length>0||r.form_sent)&&r.getForm.name.errors,(r.form.value.name.length>0||r.form_sent)&&!r.getForm.name.errors)),a.xp6(4),a.Q6J("ngClass",a.WLB(14,Jo,(r.form.value.gouvernorat.length>0||r.form_sent)&&r.getForm.gouvernorat.errors,(r.form.value.gouvernorat.length>0||r.form_sent)&&!r.getForm.gouvernorat.errors)),a.xp6(6),a.Q6J("ngClass",a.WLB(17,Jo,(r.form.value.delegation.length>0||r.form_sent)&&r.getForm.delegation.errors,(r.form.value.delegation.length>0||r.form_sent)&&!r.getForm.delegation.errors)),a.xp6(6),a.Q6J("ngClass",a.WLB(20,Jo,(r.form.value.number.length>0||r.form_sent)&&r.getForm.number.errors,(r.form.value.number.length>0||r.form_sent)&&!r.getForm.number.errors)),a.xp6(5),a.Q6J("value",0),a.xp6(5),a.Q6J("value",1),a.xp6(8),a.Q6J("value",0),a.xp6(4),a.Q6J("value",1))},directives:[H._Y,H.JL,H.sg,H._,H.Fj,H.JJ,H.u,Gt.mk,H.EJ,H.YN,H.Kr],encapsulation:2}),e})()}],data:{moduleBreadcrumb:"posting",breadcrumb:"D\xe9poser annonce"}}];let Vv=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[le.Bz.forChild(zv)],le.Bz]}),e})(),Hv=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=a.oAB({type:e}),e.\u0275inj=a.cJS({imports:[[jt.p,Vv,nv]]}),e})()},4763:function(At){At.exports=function(){"use strict";function St(x,h){var v=Object.keys(x);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(x);h&&(m=m.filter(function(S){return Object.getOwnPropertyDescriptor(x,S).enumerable})),v.push.apply(v,m)}return v}function pt(x){for(var h=1;h<arguments.length;h++){var v=null!=arguments[h]?arguments[h]:{};h%2?St(Object(v),!0).forEach(function(m){rs(x,m,v[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(x,Object.getOwnPropertyDescriptors(v)):St(Object(v)).forEach(function(m){Object.defineProperty(x,m,Object.getOwnPropertyDescriptor(v,m))})}return x}function jt(x){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(h){return typeof h}:function(h){return h&&"function"==typeof Symbol&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h})(x)}function le(x,h){if(!(x instanceof h))throw new TypeError("Cannot call a class as a function")}function a(x,h){for(var v=0;v<h.length;v++){var m=h[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(x,m.key,m)}}function rs(x,h,v){return h in x?Object.defineProperty(x,h,{value:v,enumerable:!0,configurable:!0,writable:!0}):x[h]=v,x}function Hi(x){return function Ve(x){if(Array.isArray(x))return Kr(x)}(x)||function Gt(x){if("undefined"!=typeof Symbol&&null!=x[Symbol.iterator]||null!=x["@@iterator"])return Array.from(x)}(x)||function is(x,h){if(x){if("string"==typeof x)return Kr(x,h);var v=Object.prototype.toString.call(x).slice(8,-1);if("Object"===v&&x.constructor&&(v=x.constructor.name),"Map"===v||"Set"===v)return Array.from(x);if("Arguments"===v||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v))return Kr(x,h)}}(x)||function ss(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kr(x,h){(null==h||h>x.length)&&(h=x.length);for(var v=0,m=new Array(h);v<h;v++)m[v]=x[v];return m}var mr="undefined"!=typeof window&&void 0!==window.document,$t=mr?window:{},Qr=!(!mr||!$t.document.documentElement)&&"ontouchstart"in $t.document.documentElement,H=!!mr&&"PointerEvent"in $t,wt="cropper",He="n",jn="ne",Wn="nw",Yn="se",Kn="sw",Gr="".concat(wt,"-crop"),ji="".concat(wt,"-disabled"),Wt="".concat(wt,"-hidden"),Wi="".concat(wt,"-hide"),as="".concat(wt,"-invisible"),gr="".concat(wt,"-modal"),$r="".concat(wt,"-move"),Qn="".concat(wt,"Action"),vr="".concat(wt,"Preview"),Et="crop",yr="crop",br="cropend",R="cropmove",wn="cropstart",_r="dblclick",ge=H?"pointerdown":Qr?"touchstart":"mousedown",V=H?"pointermove":Qr?"touchmove":"mousemove",ei=H?"pointerup pointercancel":Qr?"touchend touchcancel":"mouseup",Cr="zoom",ii="image/jpeg",oi=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,ln=/^data:/,Xn=/^data:image\/jpeg;base64,/,un=/^img|canvas$/i,Qi={viewMode:0,dragMode:Et,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Cn=Number.isNaN||$t.isNaN;function it(x){return"number"==typeof x&&!Cn(x)}var Tr=function(h){return h>0&&h<1/0};function ai(x){return void 0===x}function ve(x){return"object"===jt(x)&&null!==x}var Tn=Object.prototype.hasOwnProperty;function kn(x){if(!ve(x))return!1;try{var h=x.constructor,v=h.prototype;return h&&v&&Tn.call(v,"isPrototypeOf")}catch(m){return!1}}function Q(x){return"function"==typeof x}var te=Array.prototype.slice;function Xi(x){return Array.from?Array.from(x):te.call(x)}function Tt(x,h){return x&&Q(h)&&(Array.isArray(x)||it(x.length)?Xi(x).forEach(function(v,m){h.call(x,v,m,x)}):ve(x)&&Object.keys(x).forEach(function(v){h.call(x,x[v],v,x)})),x}var rt=Object.assign||function(h){for(var v=arguments.length,m=new Array(v>1?v-1:0),S=1;S<v;S++)m[S-1]=arguments[S];return ve(h)&&m.length>0&&m.forEach(function(w){ve(w)&&Object.keys(w).forEach(function(T){h[T]=w[T]})}),h},kr=/\.\d*(?:0|9){12}\d*$/;function Ie(x){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return kr.test(x)?Math.round(x*h)/h:x}var Gi=/^width|height|left|top|marginLeft|marginTop$/;function Pe(x,h){var v=x.style;Tt(h,function(m,S){Gi.test(S)&&it(m)&&(m="".concat(m,"px")),v[S]=m})}function Nt(x,h){if(h){if(it(x.length))return void Tt(x,function(m){Nt(m,h)});if(x.classList)return void x.classList.add(h);var v=x.className.trim();v?v.indexOf(h)<0&&(x.className="".concat(v," ").concat(h)):x.className=h}}function ye(x,h){if(h){if(it(x.length))return void Tt(x,function(v){ye(v,h)});if(x.classList)return void x.classList.remove(h);x.className.indexOf(h)>=0&&(x.className=x.className.replace(h,""))}}function Sn(x,h,v){if(h){if(it(x.length))return void Tt(x,function(m){Sn(m,h,v)});v?Nt(x,h):ye(x,h)}}var ls=/([a-z\d])([A-Z])/g;function ci(x){return x.replace(ls,"$1-$2").toLowerCase()}function li(x,h){return ve(x[h])?x[h]:x.dataset?x.dataset[h]:x.getAttribute("data-".concat(ci(h)))}function Mn(x,h,v){ve(v)?x[h]=v:x.dataset?x.dataset[h]=v:x.setAttribute("data-".concat(ci(h)),v)}var to=/\s\s*/,eo=function(){var x=!1;if(mr){var h=!1,v=function(){},m=Object.defineProperty({},"once",{get:function(){return x=!0,h},set:function(w){h=w}});$t.addEventListener("test",v,m),$t.removeEventListener("test",v,m)}return x}();function ue(x,h,v){var m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},S=v;h.trim().split(to).forEach(function(w){if(!eo){var T=x.listeners;T&&T[w]&&T[w][v]&&(S=T[w][v],delete T[w][v],0===Object.keys(T[w]).length&&delete T[w],0===Object.keys(T).length&&delete x.listeners)}x.removeEventListener(w,S,m)})}function ee(x,h,v){var m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},S=v;h.trim().split(to).forEach(function(w){if(m.once&&!eo){var T=x.listeners,O=void 0===T?{}:T;S=function(){delete O[w][v],x.removeEventListener(w,S,m);for(var A=arguments.length,N=new Array(A),E=0;E<A;E++)N[E]=arguments[E];v.apply(x,N)},O[w]||(O[w]={}),O[w][v]&&x.removeEventListener(w,O[w][v],m),O[w][v]=S,x.listeners=O}x.addEventListener(w,S,m)})}function pn(x,h,v){var m;return Q(Event)&&Q(CustomEvent)?m=new CustomEvent(h,{detail:v,bubbles:!0,cancelable:!0}):(m=document.createEvent("CustomEvent")).initCustomEvent(h,!0,!0,v),x.dispatchEvent(m)}function qt(x){var h=x.getBoundingClientRect();return{left:h.left+(window.pageXOffset-document.documentElement.clientLeft),top:h.top+(window.pageYOffset-document.documentElement.clientTop)}}var Je=$t.location,no=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function ui(x){var h=x.match(no);return null!==h&&(h[1]!==Je.protocol||h[2]!==Je.hostname||h[3]!==Je.port)}function Re(x){var h="timestamp=".concat((new Date).getTime());return x+(-1===x.indexOf("?")?"?":"&")+h}function be(x){var h=x.rotate,v=x.scaleX,m=x.scaleY,S=x.translateX,w=x.translateY,T=[];it(S)&&0!==S&&T.push("translateX(".concat(S,"px)")),it(w)&&0!==w&&T.push("translateY(".concat(w,"px)")),it(h)&&0!==h&&T.push("rotate(".concat(h,"deg)")),it(v)&&1!==v&&T.push("scaleX(".concat(v,")")),it(m)&&1!==m&&T.push("scaleY(".concat(m,")"));var O=T.length?T.join(" "):"none";return{WebkitTransform:O,msTransform:O,transform:O}}function Yt(x,h){var v=x.pageX,m=x.pageY,S={endX:v,endY:m};return h?S:pt({startX:v,startY:m},S)}function Ue(x){var h=x.aspectRatio,v=x.height,m=x.width,S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",w=Tr(m),T=Tr(v);if(w&&T){var O=v*h;"contain"===S&&O>m||"cover"===S&&O<m?v=m/h:m=v*h}else w?v=m/h:T&&(m=v*h);return{width:m,height:v}}function Sr(x,h,v,m){var S=h.aspectRatio,w=h.naturalWidth,T=h.naturalHeight,O=h.rotate,F=void 0===O?0:O,A=h.scaleX,N=void 0===A?1:A,E=h.scaleY,L=void 0===E?1:E,Y=v.aspectRatio,K=v.naturalWidth,ut=v.naturalHeight,$=m.fillColor,kt=void 0===$?"transparent":$,Dt=m.imageSmoothingEnabled,bt=void 0===Dt||Dt,_e=m.imageSmoothingQuality,Kt=void 0===_e?"low":_e,z=m.maxWidth,ht=void 0===z?1/0:z,Ot=m.maxHeight,Mt=void 0===Ot?1/0:Ot,ne=m.minWidth,je=void 0===ne?0:ne,On=m.minHeight,We=void 0===On?0:On,xe=document.createElement("canvas"),Bt=xe.getContext("2d"),qe=Ue({aspectRatio:Y,width:ht,height:Mt}),Ye=Ue({aspectRatio:Y,width:je,height:We},"cover"),er=Math.min(qe.width,Math.max(Ye.width,K)),Or=Math.min(qe.height,Math.max(Ye.height,ut)),re=Ue({aspectRatio:S,width:ht,height:Mt}),di=Ue({aspectRatio:S,width:je,height:We},"cover"),An=Math.min(re.width,Math.max(di.width,w)),En=Math.min(re.height,Math.max(di.height,T)),hi=[-An/2,-En/2,An,En];return xe.width=Ie(er),xe.height=Ie(Or),Bt.fillStyle=kt,Bt.fillRect(0,0,er,Or),Bt.save(),Bt.translate(er/2,Or/2),Bt.rotate(F*Math.PI/180),Bt.scale(N,L),Bt.imageSmoothingEnabled=bt,Bt.imageSmoothingQuality=Kt,Bt.drawImage.apply(Bt,[x].concat(Hi(hi.map(function(co){return Math.floor(Ie(co))})))),Bt.restore(),xe}var $n=String.fromCharCode;var oo=/^data:.*,/;function fi(x){var v,h=new DataView(x);try{var m,S,w;if(255===h.getUint8(0)&&216===h.getUint8(1))for(var T=h.byteLength,O=2;O+1<T;){if(255===h.getUint8(O)&&225===h.getUint8(O+1)){S=O;break}O+=1}if(S){var A=S+10;if("Exif"===function tr(x,h,v){var m="";v+=h;for(var S=h;S<v;S+=1)m+=$n(x.getUint8(S));return m}(h,S+4,4)){var N=h.getUint16(A);if(((m=18761===N)||19789===N)&&42===h.getUint16(A+2,m)){var E=h.getUint32(A+4,m);E>=8&&(w=A+E)}}}if(w){var Y,K,L=h.getUint16(w,m);for(K=0;K<L;K+=1)if(274===h.getUint16(Y=w+12*K+2,m)){v=h.getUint16(Y+=8,m),h.setUint16(Y,1,m);break}}}catch(ut){v=1}return v}var ps={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var h=this.element,v=this.options,m=this.container,S=this.cropper,w=Number(v.minContainerWidth),T=Number(v.minContainerHeight);Nt(S,Wt),ye(h,Wt);var O={width:Math.max(m.offsetWidth,w>=0?w:200),height:Math.max(m.offsetHeight,T>=0?T:100)};this.containerData=O,Pe(S,{width:O.width,height:O.height}),Nt(h,Wt),ye(S,Wt)},initCanvas:function(){var h=this.containerData,v=this.imageData,m=this.options.viewMode,S=Math.abs(v.rotate)%180==90,w=S?v.naturalHeight:v.naturalWidth,T=S?v.naturalWidth:v.naturalHeight,O=w/T,F=h.width,A=h.height;h.height*O>h.width?3===m?F=h.height*O:A=h.width/O:3===m?A=h.width/O:F=h.height*O;var N={aspectRatio:O,naturalWidth:w,naturalHeight:T,width:F,height:A};this.canvasData=N,this.limited=1===m||2===m,this.limitCanvas(!0,!0),N.width=Math.min(Math.max(N.width,N.minWidth),N.maxWidth),N.height=Math.min(Math.max(N.height,N.minHeight),N.maxHeight),N.left=(h.width-N.width)/2,N.top=(h.height-N.height)/2,N.oldLeft=N.left,N.oldTop=N.top,this.initialCanvasData=rt({},N)},limitCanvas:function(h,v){var m=this.options,S=this.containerData,w=this.canvasData,T=this.cropBoxData,O=m.viewMode,F=w.aspectRatio,A=this.cropped&&T;if(h){var N=Number(m.minCanvasWidth)||0,E=Number(m.minCanvasHeight)||0;O>1?(N=Math.max(N,S.width),E=Math.max(E,S.height),3===O&&(E*F>N?N=E*F:E=N/F)):O>0&&(N?N=Math.max(N,A?T.width:0):E?E=Math.max(E,A?T.height:0):A&&((E=T.height)*F>(N=T.width)?N=E*F:E=N/F));var L=Ue({aspectRatio:F,width:N,height:E});E=L.height,w.minWidth=N=L.width,w.minHeight=E,w.maxWidth=1/0,w.maxHeight=1/0}if(v)if(O>(A?0:1)){var Y=S.width-w.width,K=S.height-w.height;w.minLeft=Math.min(0,Y),w.minTop=Math.min(0,K),w.maxLeft=Math.max(0,Y),w.maxTop=Math.max(0,K),A&&this.limited&&(w.minLeft=Math.min(T.left,T.left+(T.width-w.width)),w.minTop=Math.min(T.top,T.top+(T.height-w.height)),w.maxLeft=T.left,w.maxTop=T.top,2===O&&(w.width>=S.width&&(w.minLeft=Math.min(0,Y),w.maxLeft=Math.max(0,Y)),w.height>=S.height&&(w.minTop=Math.min(0,K),w.maxTop=Math.max(0,K))))}else w.minLeft=-w.width,w.minTop=-w.height,w.maxLeft=S.width,w.maxTop=S.height},renderCanvas:function(h,v){var m=this.canvasData,S=this.imageData;if(v){var w=function io(x){var h=x.width,v=x.height,m=x.degree;if(90==(m=Math.abs(m)%180))return{width:v,height:h};var S=m%90*Math.PI/180,w=Math.sin(S),T=Math.cos(S),O=h*T+v*w,F=h*w+v*T;return m>90?{width:F,height:O}:{width:O,height:F}}({width:S.naturalWidth*Math.abs(S.scaleX||1),height:S.naturalHeight*Math.abs(S.scaleY||1),degree:S.rotate||0}),T=w.width,O=w.height,F=m.width*(T/m.naturalWidth),A=m.height*(O/m.naturalHeight);m.left-=(F-m.width)/2,m.top-=(A-m.height)/2,m.width=F,m.height=A,m.aspectRatio=T/O,m.naturalWidth=T,m.naturalHeight=O,this.limitCanvas(!0,!1)}(m.width>m.maxWidth||m.width<m.minWidth)&&(m.left=m.oldLeft),(m.height>m.maxHeight||m.height<m.minHeight)&&(m.top=m.oldTop),m.width=Math.min(Math.max(m.width,m.minWidth),m.maxWidth),m.height=Math.min(Math.max(m.height,m.minHeight),m.maxHeight),this.limitCanvas(!1,!0),m.left=Math.min(Math.max(m.left,m.minLeft),m.maxLeft),m.top=Math.min(Math.max(m.top,m.minTop),m.maxTop),m.oldLeft=m.left,m.oldTop=m.top,Pe(this.canvas,rt({width:m.width,height:m.height},be({translateX:m.left,translateY:m.top}))),this.renderImage(h),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(h){var v=this.canvasData,m=this.imageData,S=m.naturalWidth*(v.width/v.naturalWidth),w=m.naturalHeight*(v.height/v.naturalHeight);rt(m,{width:S,height:w,left:(v.width-S)/2,top:(v.height-w)/2}),Pe(this.image,rt({width:m.width,height:m.height},be(rt({translateX:m.left,translateY:m.top},m)))),h&&this.output()},initCropBox:function(){var h=this.options,v=this.canvasData,m=h.aspectRatio||h.initialAspectRatio,S=Number(h.autoCropArea)||.8,w={width:v.width,height:v.height};m&&(v.height*m>v.width?w.height=w.width/m:w.width=w.height*m),this.cropBoxData=w,this.limitCropBox(!0,!0),w.width=Math.min(Math.max(w.width,w.minWidth),w.maxWidth),w.height=Math.min(Math.max(w.height,w.minHeight),w.maxHeight),w.width=Math.max(w.minWidth,w.width*S),w.height=Math.max(w.minHeight,w.height*S),w.left=v.left+(v.width-w.width)/2,w.top=v.top+(v.height-w.height)/2,w.oldLeft=w.left,w.oldTop=w.top,this.initialCropBoxData=rt({},w)},limitCropBox:function(h,v){var m=this.options,S=this.containerData,w=this.canvasData,T=this.cropBoxData,O=this.limited,F=m.aspectRatio;if(h){var A=Number(m.minCropBoxWidth)||0,N=Number(m.minCropBoxHeight)||0,E=O?Math.min(S.width,w.width,w.width+w.left,S.width-w.left):S.width,L=O?Math.min(S.height,w.height,w.height+w.top,S.height-w.top):S.height;A=Math.min(A,S.width),N=Math.min(N,S.height),F&&(A&&N?N*F>A?N=A/F:A=N*F:A?N=A/F:N&&(A=N*F),L*F>E?L=E/F:E=L*F),T.minWidth=Math.min(A,E),T.minHeight=Math.min(N,L),T.maxWidth=E,T.maxHeight=L}v&&(O?(T.minLeft=Math.max(0,w.left),T.minTop=Math.max(0,w.top),T.maxLeft=Math.min(S.width,w.left+w.width)-T.width,T.maxTop=Math.min(S.height,w.top+w.height)-T.height):(T.minLeft=0,T.minTop=0,T.maxLeft=S.width-T.width,T.maxTop=S.height-T.height))},renderCropBox:function(){var h=this.options,v=this.containerData,m=this.cropBoxData;(m.width>m.maxWidth||m.width<m.minWidth)&&(m.left=m.oldLeft),(m.height>m.maxHeight||m.height<m.minHeight)&&(m.top=m.oldTop),m.width=Math.min(Math.max(m.width,m.minWidth),m.maxWidth),m.height=Math.min(Math.max(m.height,m.minHeight),m.maxHeight),this.limitCropBox(!1,!0),m.left=Math.min(Math.max(m.left,m.minLeft),m.maxLeft),m.top=Math.min(Math.max(m.top,m.minTop),m.maxTop),m.oldLeft=m.left,m.oldTop=m.top,h.movable&&h.cropBoxMovable&&Mn(this.face,Qn,m.width>=v.width&&m.height>=v.height?"move":"all"),Pe(this.cropBox,rt({width:m.width,height:m.height},be({translateX:m.left,translateY:m.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),pn(this.element,yr,this.getData())}},fs={initPreview:function(){var h=this.element,v=this.crossOrigin,m=this.options.preview,S=v?this.crossOriginUrl:this.url,w=h.alt||"The image to preview",T=document.createElement("img");if(v&&(T.crossOrigin=v),T.src=S,T.alt=w,this.viewBox.appendChild(T),this.viewBoxImage=T,m){var O=m;"string"==typeof m?O=h.ownerDocument.querySelectorAll(m):m.querySelector&&(O=[m]),this.previews=O,Tt(O,function(F){var A=document.createElement("img");Mn(F,vr,{width:F.offsetWidth,height:F.offsetHeight,html:F.innerHTML}),v&&(A.crossOrigin=v),A.src=S,A.alt=w,A.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',F.innerHTML="",F.appendChild(A)})}},resetPreview:function(){Tt(this.previews,function(h){var v=li(h,vr);Pe(h,{width:v.width,height:v.height}),h.innerHTML=v.html,function $i(x,h){if(ve(x[h]))try{delete x[h]}catch(v){x[h]=void 0}else if(x.dataset)try{delete x.dataset[h]}catch(v){x.dataset[h]=void 0}else x.removeAttribute("data-".concat(ci(h)))}(h,vr)})},preview:function(){var h=this.imageData,v=this.canvasData,m=this.cropBoxData,S=m.width,w=m.height,T=h.width,O=h.height,F=m.left-v.left-h.left,A=m.top-v.top-h.top;!this.cropped||this.disabled||(Pe(this.viewBoxImage,rt({width:T,height:O},be(rt({translateX:-F,translateY:-A},h)))),Tt(this.previews,function(N){var E=li(N,vr),L=E.width,Y=E.height,K=L,ut=Y,$=1;S&&(ut=w*($=L/S)),w&&ut>Y&&(K=S*($=Y/w),ut=Y),Pe(N,{width:K,height:ut}),Pe(N.getElementsByTagName("img")[0],rt({width:T*$,height:O*$},be(rt({translateX:-F*$,translateY:-A*$},h))))}))}},so={bind:function(){var h=this.element,v=this.options,m=this.cropper;Q(v.cropstart)&&ee(h,wn,v.cropstart),Q(v.cropmove)&&ee(h,R,v.cropmove),Q(v.cropend)&&ee(h,br,v.cropend),Q(v.crop)&&ee(h,yr,v.crop),Q(v.zoom)&&ee(h,Cr,v.zoom),ee(m,ge,this.onCropStart=this.cropStart.bind(this)),v.zoomable&&v.zoomOnWheel&&ee(m,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),v.toggleDragModeOnDblclick&&ee(m,_r,this.onDblclick=this.dblclick.bind(this)),ee(h.ownerDocument,V,this.onCropMove=this.cropMove.bind(this)),ee(h.ownerDocument,ei,this.onCropEnd=this.cropEnd.bind(this)),v.responsive&&ee(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var h=this.element,v=this.options,m=this.cropper;Q(v.cropstart)&&ue(h,wn,v.cropstart),Q(v.cropmove)&&ue(h,R,v.cropmove),Q(v.cropend)&&ue(h,br,v.cropend),Q(v.crop)&&ue(h,yr,v.crop),Q(v.zoom)&&ue(h,Cr,v.zoom),ue(m,ge,this.onCropStart),v.zoomable&&v.zoomOnWheel&&ue(m,"wheel",this.onWheel,{passive:!1,capture:!0}),v.toggleDragModeOnDblclick&&ue(m,_r,this.onDblclick),ue(h.ownerDocument,V,this.onCropMove),ue(h.ownerDocument,ei,this.onCropEnd),v.responsive&&ue(window,"resize",this.onResize)}},ds={resize:function(){if(!this.disabled){var O,F,h=this.options,v=this.container,m=this.containerData,S=v.offsetWidth/m.width,w=v.offsetHeight/m.height,T=Math.abs(S-1)>Math.abs(w-1)?S:w;1!==T&&(h.restore&&(O=this.getCanvasData(),F=this.getCropBoxData()),this.render(),h.restore&&(this.setCanvasData(Tt(O,function(A,N){O[N]=A*T})),this.setCropBoxData(Tt(F,function(A,N){F[N]=A*T}))))}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(function cs(x,h){return x.classList?x.classList.contains(h):x.className.indexOf(h)>-1}(this.dragBox,Gr)?"move":Et)},wheel:function(h){var v=this,m=Number(this.options.wheelZoomRatio)||.1,S=1;this.disabled||(h.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){v.wheeling=!1},50),h.deltaY?S=h.deltaY>0?1:-1:h.wheelDelta?S=-h.wheelDelta/120:h.detail&&(S=h.detail>0?1:-1),this.zoom(-S*m,h)))},cropStart:function(h){var v=h.buttons,m=h.button;if(!(this.disabled||("mousedown"===h.type||"pointerdown"===h.type&&"mouse"===h.pointerType)&&(it(v)&&1!==v||it(m)&&0!==m||h.ctrlKey))){var T,S=this.options,w=this.pointers;h.changedTouches?Tt(h.changedTouches,function(O){w[O.identifier]=Yt(O)}):w[h.pointerId||0]=Yt(h),T=Object.keys(w).length>1&&S.zoomable&&S.zoomOnTouch?"zoom":li(h.target,Qn),oi.test(T)&&!1!==pn(this.element,wn,{originalEvent:h,action:T})&&(h.preventDefault(),this.action=T,this.cropping=!1,"crop"===T&&(this.cropping=!0,Nt(this.dragBox,gr)))}},cropMove:function(h){var v=this.action;if(!this.disabled&&v){var m=this.pointers;h.preventDefault(),!1!==pn(this.element,R,{originalEvent:h,action:v})&&(h.changedTouches?Tt(h.changedTouches,function(S){rt(m[S.identifier]||{},Yt(S,!0))}):rt(m[h.pointerId||0]||{},Yt(h,!0)),this.change(h))}},cropEnd:function(h){if(!this.disabled){var v=this.action,m=this.pointers;h.changedTouches?Tt(h.changedTouches,function(S){delete m[S.identifier]}):delete m[h.pointerId||0],v&&(h.preventDefault(),Object.keys(m).length||(this.action=""),this.cropping&&(this.cropping=!1,Sn(this.dragBox,gr,this.cropped&&this.options.modal)),pn(this.element,br,{originalEvent:h,action:v}))}}},hs={change:function(h){var _e,m=this.canvasData,S=this.containerData,w=this.cropBoxData,T=this.pointers,O=this.action,F=this.options.aspectRatio,A=w.left,N=w.top,E=w.width,L=w.height,Y=A+E,K=N+L,ut=0,$=0,kt=S.width,Dt=S.height,bt=!0;!F&&h.shiftKey&&(F=E&&L?E/L:1),this.limited&&($=w.minTop,kt=(ut=w.minLeft)+Math.min(S.width,m.width,m.left+m.width),Dt=$+Math.min(S.height,m.height,m.top+m.height));var Kt=T[Object.keys(T)[0]],z={x:Kt.endX-Kt.startX,y:Kt.endY-Kt.startY},ht=function(Mt){switch(Mt){case"e":Y+z.x>kt&&(z.x=kt-Y);break;case"w":A+z.x<ut&&(z.x=ut-A);break;case He:N+z.y<$&&(z.y=$-N);break;case"s":K+z.y>Dt&&(z.y=Dt-K)}};switch(O){case"all":A+=z.x,N+=z.y;break;case"e":if(z.x>=0&&(Y>=kt||F&&(N<=$||K>=Dt))){bt=!1;break}ht("e"),(E+=z.x)<0&&(O="w",A-=E=-E),F&&(N+=(w.height-(L=E/F))/2);break;case He:if(z.y<=0&&(N<=$||F&&(A<=ut||Y>=kt))){bt=!1;break}ht(He),N+=z.y,(L-=z.y)<0&&(O="s",N-=L=-L),F&&(A+=(w.width-(E=L*F))/2);break;case"w":if(z.x<=0&&(A<=ut||F&&(N<=$||K>=Dt))){bt=!1;break}ht("w"),A+=z.x,(E-=z.x)<0&&(O="e",A-=E=-E),F&&(N+=(w.height-(L=E/F))/2);break;case"s":if(z.y>=0&&(K>=Dt||F&&(A<=ut||Y>=kt))){bt=!1;break}ht("s"),(L+=z.y)<0&&(O=He,N-=L=-L),F&&(A+=(w.width-(E=L*F))/2);break;case jn:if(F){if(z.y<=0&&(N<=$||Y>=kt)){bt=!1;break}ht(He),N+=z.y,E=(L-=z.y)*F}else ht(He),ht("e"),z.x>=0?Y<kt?E+=z.x:z.y<=0&&N<=$&&(bt=!1):E+=z.x,z.y<=0?N>$&&(L-=z.y,N+=z.y):(L-=z.y,N+=z.y);E<0&&L<0?(O=Kn,N-=L=-L,A-=E=-E):E<0?(O=Wn,A-=E=-E):L<0&&(O=Yn,N-=L=-L);break;case Wn:if(F){if(z.y<=0&&(N<=$||A<=ut)){bt=!1;break}ht(He),N+=z.y,A+=w.width-(E=(L-=z.y)*F)}else ht(He),ht("w"),z.x<=0?A>ut?(E-=z.x,A+=z.x):z.y<=0&&N<=$&&(bt=!1):(E-=z.x,A+=z.x),z.y<=0?N>$&&(L-=z.y,N+=z.y):(L-=z.y,N+=z.y);E<0&&L<0?(O=Yn,N-=L=-L,A-=E=-E):E<0?(O=jn,A-=E=-E):L<0&&(O=Kn,N-=L=-L);break;case Kn:if(F){if(z.x<=0&&(A<=ut||K>=Dt)){bt=!1;break}ht("w"),A+=z.x,L=(E-=z.x)/F}else ht("s"),ht("w"),z.x<=0?A>ut?(E-=z.x,A+=z.x):z.y>=0&&K>=Dt&&(bt=!1):(E-=z.x,A+=z.x),z.y>=0?K<Dt&&(L+=z.y):L+=z.y;E<0&&L<0?(O=jn,N-=L=-L,A-=E=-E):E<0?(O=Yn,A-=E=-E):L<0&&(O=Wn,N-=L=-L);break;case Yn:if(F){if(z.x>=0&&(Y>=kt||K>=Dt)){bt=!1;break}ht("e"),L=(E+=z.x)/F}else ht("s"),ht("e"),z.x>=0?Y<kt?E+=z.x:z.y>=0&&K>=Dt&&(bt=!1):E+=z.x,z.y>=0?K<Dt&&(L+=z.y):L+=z.y;E<0&&L<0?(O=Wn,N-=L=-L,A-=E=-E):E<0?(O=Kn,A-=E=-E):L<0&&(O=jn,N-=L=-L);break;case"move":this.move(z.x,z.y),bt=!1;break;case"zoom":this.zoom(function ro(x){var h=pt({},x),v=0;return Tt(x,function(m,S){delete h[S],Tt(h,function(w){var T=Math.abs(m.startX-w.startX),O=Math.abs(m.startY-w.startY),F=Math.abs(m.endX-w.endX),A=Math.abs(m.endY-w.endY),N=Math.sqrt(T*T+O*O),L=(Math.sqrt(F*F+A*A)-N)/N;Math.abs(L)>Math.abs(v)&&(v=L)})}),v}(T),h),bt=!1;break;case"crop":if(!z.x||!z.y){bt=!1;break}_e=qt(this.cropper),A=Kt.startX-_e.left,N=Kt.startY-_e.top,E=w.minWidth,L=w.minHeight,z.x>0?O=z.y>0?Yn:jn:z.x<0&&(A-=E,O=z.y>0?Kn:Wn),z.y<0&&(N-=L),this.cropped||(ye(this.cropBox,Wt),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}bt&&(w.width=E,w.height=L,w.left=A,w.top=N,this.action=O,this.renderCropBox()),Tt(T,function(Ot){Ot.startX=Ot.endX,Ot.startY=Ot.endY})}},Rt={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Nt(this.dragBox,gr),ye(this.cropBox,Wt),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=rt({},this.initialImageData),this.canvasData=rt({},this.initialCanvasData),this.cropBoxData=rt({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(rt(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),ye(this.dragBox,gr),Nt(this.cropBox,Wt)),this},replace:function(h){var v=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&h&&(this.isImg&&(this.element.src=h),v?(this.url=h,this.image.src=h,this.ready&&(this.viewBoxImage.src=h,Tt(this.previews,function(m){m.getElementsByTagName("img")[0].src=h}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(h))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,ye(this.cropper,ji)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,Nt(this.cropper,ji)),this},destroy:function(){var h=this.element;return h[wt]?(h[wt]=void 0,this.isImg&&this.replaced&&(h.src=this.originalUrl),this.uncreate(),this):this},move:function(h){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,m=this.canvasData,S=m.left,w=m.top;return this.moveTo(ai(h)?h:S+Number(h),ai(v)?v:w+Number(v))},moveTo:function(h){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,m=this.canvasData,S=!1;return h=Number(h),v=Number(v),this.ready&&!this.disabled&&this.options.movable&&(it(h)&&(m.left=h,S=!0),it(v)&&(m.top=v,S=!0),S&&this.renderCanvas(!0)),this},zoom:function(h,v){var m=this.canvasData;return h=Number(h),this.zoomTo(m.width*(h=h<0?1/(1-h):1+h)/m.naturalWidth,null,v)},zoomTo:function(h,v,m){var S=this.options,w=this.canvasData,T=w.width,O=w.height,F=w.naturalWidth,A=w.naturalHeight;if((h=Number(h))>=0&&this.ready&&!this.disabled&&S.zoomable){var N=F*h,E=A*h;if(!1===pn(this.element,Cr,{ratio:h,oldRatio:T/F,originalEvent:m}))return this;if(m){var L=this.pointers,Y=qt(this.cropper),K=L&&Object.keys(L).length?function pi(x){var h=0,v=0,m=0;return Tt(x,function(S){h+=S.startX,v+=S.startY,m+=1}),{pageX:h/=m,pageY:v/=m}}(L):{pageX:m.pageX,pageY:m.pageY};w.left-=(K.pageX-Y.left-w.left)/T*(N-T),w.top-=(K.pageY-Y.top-w.top)/O*(E-O)}else kn(v)&&it(v.x)&&it(v.y)?(w.left-=(v.x-w.left)/T*(N-T),w.top-=(v.y-w.top)/O*(E-O)):(w.left-=(N-T)/2,w.top-=(E-O)/2);w.width=N,w.height=E,this.renderCanvas(!0)}return this},rotate:function(h){return this.rotateTo((this.imageData.rotate||0)+Number(h))},rotateTo:function(h){return it(h=Number(h))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=h%360,this.renderCanvas(!0,!0)),this},scaleX:function(h){var v=this.imageData.scaleY;return this.scale(h,it(v)?v:1)},scaleY:function(h){var v=this.imageData.scaleX;return this.scale(it(v)?v:1,h)},scale:function(h){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,m=this.imageData,S=!1;return h=Number(h),v=Number(v),this.ready&&!this.disabled&&this.options.scalable&&(it(h)&&(m.scaleX=h,S=!0),it(v)&&(m.scaleY=v,S=!0),S&&this.renderCanvas(!0,!0)),this},getData:function(){var T,h=arguments.length>0&&void 0!==arguments[0]&&arguments[0],v=this.options,m=this.imageData,S=this.canvasData,w=this.cropBoxData;if(this.ready&&this.cropped){var O=m.width/m.naturalWidth;if(Tt(T={x:w.left-S.left,y:w.top-S.top,width:w.width,height:w.height},function(N,E){T[E]=N/O}),h){var F=Math.round(T.y+T.height),A=Math.round(T.x+T.width);T.x=Math.round(T.x),T.y=Math.round(T.y),T.width=A-T.x,T.height=F-T.y}}else T={x:0,y:0,width:0,height:0};return v.rotatable&&(T.rotate=m.rotate||0),v.scalable&&(T.scaleX=m.scaleX||1,T.scaleY=m.scaleY||1),T},setData:function(h){var v=this.options,m=this.imageData,S=this.canvasData,w={};if(this.ready&&!this.disabled&&kn(h)){var T=!1;v.rotatable&&it(h.rotate)&&h.rotate!==m.rotate&&(m.rotate=h.rotate,T=!0),v.scalable&&(it(h.scaleX)&&h.scaleX!==m.scaleX&&(m.scaleX=h.scaleX,T=!0),it(h.scaleY)&&h.scaleY!==m.scaleY&&(m.scaleY=h.scaleY,T=!0)),T&&this.renderCanvas(!0,!0);var O=m.width/m.naturalWidth;it(h.x)&&(w.left=h.x*O+S.left),it(h.y)&&(w.top=h.y*O+S.top),it(h.width)&&(w.width=h.width*O),it(h.height)&&(w.height=h.height*O),this.setCropBoxData(w)}return this},getContainerData:function(){return this.ready?rt({},this.containerData):{}},getImageData:function(){return this.sized?rt({},this.imageData):{}},getCanvasData:function(){var h=this.canvasData,v={};return this.ready&&Tt(["left","top","width","height","naturalWidth","naturalHeight"],function(m){v[m]=h[m]}),v},setCanvasData:function(h){var v=this.canvasData,m=v.aspectRatio;return this.ready&&!this.disabled&&kn(h)&&(it(h.left)&&(v.left=h.left),it(h.top)&&(v.top=h.top),it(h.width)?(v.width=h.width,v.height=h.width/m):it(h.height)&&(v.height=h.height,v.width=h.height*m),this.renderCanvas(!0)),this},getCropBoxData:function(){var v,h=this.cropBoxData;return this.ready&&this.cropped&&(v={left:h.left,top:h.top,width:h.width,height:h.height}),v||{}},setCropBoxData:function(h){var S,w,v=this.cropBoxData,m=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&kn(h)&&(it(h.left)&&(v.left=h.left),it(h.top)&&(v.top=h.top),it(h.width)&&h.width!==v.width&&(S=!0,v.width=h.width),it(h.height)&&h.height!==v.height&&(w=!0,v.height=h.height),m&&(S?v.height=v.width/m:w&&(v.width=v.height*m)),this.renderCropBox()),this},getCroppedCanvas:function(){var h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var v=this.canvasData,m=Sr(this.image,this.imageData,v,h);if(!this.cropped)return m;var S=this.getData(),w=S.x,T=S.y,O=S.width,F=S.height,A=m.width/Math.floor(v.naturalWidth);1!==A&&(w*=A,T*=A,O*=A,F*=A);var N=O/F,E=Ue({aspectRatio:N,width:h.maxWidth||1/0,height:h.maxHeight||1/0}),L=Ue({aspectRatio:N,width:h.minWidth||0,height:h.minHeight||0},"cover"),Y=Ue({aspectRatio:N,width:h.width||(1!==A?m.width:O),height:h.height||(1!==A?m.height:F)}),K=Y.width,ut=Y.height;K=Math.min(E.width,Math.max(L.width,K)),ut=Math.min(E.height,Math.max(L.height,ut));var $=document.createElement("canvas"),kt=$.getContext("2d");$.width=Ie(K),$.height=Ie(ut),kt.fillStyle=h.fillColor||"transparent",kt.fillRect(0,0,K,ut);var Dt=h.imageSmoothingEnabled,_e=h.imageSmoothingQuality;kt.imageSmoothingEnabled=void 0===Dt||Dt,_e&&(kt.imageSmoothingQuality=_e);var Mt,ne,je,On,We,xe,Kt=m.width,z=m.height,ht=w,Ot=T;ht<=-O||ht>Kt?(ht=0,Mt=0,je=0,We=0):ht<=0?(je=-ht,ht=0,We=Mt=Math.min(Kt,O+ht)):ht<=Kt&&(je=0,We=Mt=Math.min(O,Kt-ht)),Mt<=0||Ot<=-F||Ot>z?(Ot=0,ne=0,On=0,xe=0):Ot<=0?(On=-Ot,Ot=0,xe=ne=Math.min(z,F+Ot)):Ot<=z&&(On=0,xe=ne=Math.min(F,z-Ot));var Bt=[ht,Ot,Mt,ne];if(We>0&&xe>0){var qe=K/O;Bt.push(je*qe,On*qe,We*qe,xe*qe)}return kt.drawImage.apply(kt,[m].concat(Hi(Bt.map(function(Ye){return Math.floor(Ie(Ye))})))),$},setAspectRatio:function(h){var v=this.options;return!this.disabled&&!ai(h)&&(v.aspectRatio=Math.max(0,h)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(h){var v=this.options,m=this.dragBox,S=this.face;if(this.ready&&!this.disabled){var w=h===Et,T=v.movable&&"move"===h;v.dragMode=h=w||T?h:"none",Mn(m,Qn,h),Sn(m,Gr,w),Sn(m,$r,T),v.cropBoxMovable||(Mn(S,Qn,h),Sn(S,Gr,w),Sn(S,$r,T))}return this}},ao=$t.Cropper,Mr=function(){function x(h){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(le(this,x),!h||!un.test(h.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=h,this.options=rt({},Qi,kn(v)&&v),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return function Vi(x,h,v){return h&&a(x.prototype,h),v&&a(x,v),x}(x,[{key:"init",value:function(){var S,v=this.element,m=v.tagName.toLowerCase();if(!v[wt]){if(v[wt]=this,"img"===m){if(this.isImg=!0,S=v.getAttribute("src")||"",this.originalUrl=S,!S)return;S=v.src}else"canvas"===m&&window.HTMLCanvasElement&&(S=v.toDataURL());this.load(S)}}},{key:"load",value:function(v){var m=this;if(v){this.url=v,this.imageData={};var S=this.element,w=this.options;if(!w.rotatable&&!w.scalable&&(w.checkOrientation=!1),!w.checkOrientation||!window.ArrayBuffer)return void this.clone();if(ln.test(v))return void(Xn.test(v)?this.read(function Ze(x){var h=x.replace(oo,""),v=atob(h),m=new ArrayBuffer(v.length),S=new Uint8Array(m);return Tt(S,function(w,T){S[T]=v.charCodeAt(T)}),m}(v)):this.clone());var T=new XMLHttpRequest,O=this.clone.bind(this);this.reloading=!0,this.xhr=T,T.onabort=O,T.onerror=O,T.ontimeout=O,T.onprogress=function(){T.getResponseHeader("content-type")!==ii&&T.abort()},T.onload=function(){m.read(T.response)},T.onloadend=function(){m.reloading=!1,m.xhr=null},w.checkCrossOrigin&&ui(v)&&S.crossOrigin&&(v=Re(v)),T.open("GET",v,!0),T.responseType="arraybuffer",T.withCredentials="use-credentials"===S.crossOrigin,T.send()}}},{key:"read",value:function(v){var m=this.options,S=this.imageData,w=fi(v),T=0,O=1,F=1;if(w>1){this.url=function vt(x,h){for(var v=[],S=new Uint8Array(x);S.length>0;)v.push($n.apply(null,Xi(S.subarray(0,8192)))),S=S.subarray(8192);return"data:".concat(h,";base64,").concat(btoa(v.join("")))}(v,ii);var A=function us(x){var h=0,v=1,m=1;switch(x){case 2:v=-1;break;case 3:h=-180;break;case 4:m=-1;break;case 5:h=90,m=-1;break;case 6:h=90;break;case 7:h=90,v=-1;break;case 8:h=-90}return{rotate:h,scaleX:v,scaleY:m}}(w);T=A.rotate,O=A.scaleX,F=A.scaleY}m.rotatable&&(S.rotate=T),m.scalable&&(S.scaleX=O,S.scaleY=F),this.clone()}},{key:"clone",value:function(){var v=this.element,m=this.url,S=v.crossOrigin,w=m;this.options.checkCrossOrigin&&ui(m)&&(S||(S="anonymous"),w=Re(m)),this.crossOrigin=S,this.crossOriginUrl=w;var T=document.createElement("img");S&&(T.crossOrigin=S),T.src=w||m,T.alt=v.alt||"The image to crop",this.image=T,T.onload=this.start.bind(this),T.onerror=this.stop.bind(this),Nt(T,Wi),v.parentNode.insertBefore(T,v.nextSibling)}},{key:"start",value:function(){var v=this,m=this.image;m.onload=null,m.onerror=null,this.sizing=!0;var S=$t.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test($t.navigator.userAgent),w=function(A,N){rt(v.imageData,{naturalWidth:A,naturalHeight:N,aspectRatio:A/N}),v.initialImageData=rt({},v.imageData),v.sizing=!1,v.sized=!0,v.build()};if(!m.naturalWidth||S){var T=document.createElement("img"),O=document.body||document.documentElement;this.sizingImage=T,T.onload=function(){w(T.width,T.height),S||O.removeChild(T)},T.src=m.src,S||(T.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",O.appendChild(T))}else w(m.naturalWidth,m.naturalHeight)}},{key:"stop",value:function(){var v=this.image;v.onload=null,v.onerror=null,v.parentNode.removeChild(v),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var v=this.element,m=this.options,S=this.image,w=v.parentNode,T=document.createElement("div");T.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var O=T.querySelector(".".concat(wt,"-container")),F=O.querySelector(".".concat(wt,"-canvas")),A=O.querySelector(".".concat(wt,"-drag-box")),N=O.querySelector(".".concat(wt,"-crop-box")),E=N.querySelector(".".concat(wt,"-face"));this.container=w,this.cropper=O,this.canvas=F,this.dragBox=A,this.cropBox=N,this.viewBox=O.querySelector(".".concat(wt,"-view-box")),this.face=E,F.appendChild(S),Nt(v,Wt),w.insertBefore(O,v.nextSibling),this.isImg||ye(S,Wi),this.initPreview(),this.bind(),m.initialAspectRatio=Math.max(0,m.initialAspectRatio)||NaN,m.aspectRatio=Math.max(0,m.aspectRatio)||NaN,m.viewMode=Math.max(0,Math.min(3,Math.round(m.viewMode)))||0,Nt(N,Wt),m.guides||Nt(N.getElementsByClassName("".concat(wt,"-dashed")),Wt),m.center||Nt(N.getElementsByClassName("".concat(wt,"-center")),Wt),m.background&&Nt(O,"".concat(wt,"-bg")),m.highlight||Nt(E,as),m.cropBoxMovable&&(Nt(E,$r),Mn(E,Qn,"all")),m.cropBoxResizable||(Nt(N.getElementsByClassName("".concat(wt,"-line")),Wt),Nt(N.getElementsByClassName("".concat(wt,"-point")),Wt)),this.render(),this.ready=!0,this.setDragMode(m.dragMode),m.autoCrop&&this.crop(),this.setData(m.data),Q(m.ready)&&ee(v,"ready",m.ready,{once:!0}),pn(v,"ready")}}},{key:"unbuild",value:function(){!this.ready||(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),ye(this.element,Wt))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=ao,x}},{key:"setDefaults",value:function(v){rt(Qi,kn(v)&&v)}}]),x}();return rt(Mr.prototype,ps,fs,so,ds,hs,Rt),Mr}()}}]);